import{dh as ae,aU as Z,G as j,aJ as te,aO as ie,cq as se,di as le,cP as ne,dj as oe,dk as re,dc as ce,aM as ue,aK as de,e as t,dl as ve,f as v,b6 as M,Y as K,aY as me,a$ as U,b7 as q,V as b,bc as H,d7 as fe,dm as he,cv as _e,cw as ye,cx as ge,cz as Ve,dn as be,dp as pe,cA as we,d6 as Ae,cB as ke,cC as Ce,cu as Se,d as ze,a as xe,v as De,H as Pe,I as Be,o as Ie,Z as Re,b as y,g,w as s,A as Te,i as u,t as c,j as e,k as d,dq as Ee,K as Fe,p as T,ar as E,bW as W,B as F,b4 as k,bj as C,br as Y,C as $,dr as $e,ds as G,dt as Oe,bs as je,du as J,dv as Le,s as O,dw as Ne,dx as Me,dy as Ke,dz as Ue,dA as qe,dB as He,E as We}from"./index-CY4kEXQX.js";import{V,_ as Ye}from"./LayoutBase.vue_vue_type_script_setup_true_lang-mBpG7FYr.js";import{V as S}from"./VRow-Dt2mDaW0.js";import{p as Ge}from"./parseInt-DjOfejfT.js";import"./VContainer-DyZfstE_.js";const Je=ae("v-alert-title"),Ze=Z({iconSize:[Number,String],iconSizes:{type:Array,default:()=>[["x-small",10],["small",16],["default",24],["large",28],["x-large",32]]}},"iconSize");function Qe(a,_){return{iconSize:j(()=>{const n=new Map(a.iconSizes),h=a.iconSize??_()??"default";return n.has(h)?n.get(h):h})}}const Xe=["success","info","warning","error"],ea=Z({border:{type:[Boolean,String],validator:a=>typeof a=="boolean"||["top","end","bottom","start"].includes(a)},borderColor:String,closable:Boolean,closeIcon:{type:Se,default:"$close"},closeLabel:{type:String,default:"$vuetify.close"},icon:{type:[Boolean,String,Function,Object],default:null},modelValue:{type:Boolean,default:!0},prominent:Boolean,title:String,text:String,type:{type:String,validator:a=>Xe.includes(a)},...Ce(),...ke(),...Ae(),...we(),...Ze(),...pe(),...be(),...Ve(),...ge(),...ye(),..._e({variant:"flat"})},"VAlert"),aa=te()({name:"VAlert",props:ea(),emits:{"click:close":a=>!0,"update:modelValue":a=>!0},setup(a,_){let{emit:i,slots:n}=_;const h=ie(a,"modelValue"),p=H(()=>{if(a.icon!==!1)return a.type?a.icon??`$${a.type}`:a.icon}),{iconSize:m}=Qe(a,()=>a.prominent?44:void 0),{themeClasses:w}=se(a),{colorClasses:o,colorStyles:l,variantClasses:z}=le(()=>({color:a.color??a.type,variant:a.variant})),{densityClasses:A}=ne(a),{dimensionStyles:x}=fe(a),{elevationClasses:D}=he(a),{locationStyles:P}=oe(a),{positionClasses:B}=re(a),{roundedClasses:I}=ce(a),{textColorClasses:r,textColorStyles:f}=ue(()=>a.borderColor),{t:Q}=de(),L=H(()=>({"aria-label":Q(a.closeLabel),onClick(R){h.value=!1,i("click:close",R)}}));return()=>{const R=!!(n.prepend||p.value),X=!!(n.title||a.title),ee=!!(n.close||a.closable),N={density:a.density,icon:p.value,size:a.iconSize||a.prominent?m.value:void 0};return h.value&&t(a.tag,{class:K(["v-alert",a.border&&{"v-alert--border":!!a.border,[`v-alert--border-${a.border===!0?"start":a.border}`]:!0},{"v-alert--prominent":a.prominent},w.value,o.value,A.value,D.value,B.value,I.value,z.value,a.class]),style:M([l.value,x.value,P.value,a.style]),role:"alert"},{default:()=>[ve(!1,"v-alert"),a.border&&v("div",{key:"border",class:K(["v-alert__border",r.value]),style:M(f.value)},null),R&&v("div",{key:"prepend",class:"v-alert__prepend"},[n.prepend?t(q,{key:"prepend-defaults",disabled:!p.value,defaults:{VIcon:{...N}}},n.prepend):t(me,U({key:"prepend-icon"},N),null)]),v("div",{class:"v-alert__content"},[X&&t(Je,{key:"title"},{default:()=>[n.title?.()??a.title]}),n.text?.()??a.text,n.default?.()]),n.append&&v("div",{key:"append",class:"v-alert__append"},[n.append()]),ee&&v("div",{key:"close",class:"v-alert__close"},[n.close?t(q,{key:"close-defaults",defaults:{VBtn:{icon:a.closeIcon,size:"x-small",variant:"text"}}},{default:()=>[n.close?.({props:L.value})]}):t(b,U({key:"close-btn",icon:a.closeIcon,size:"x-small",variant:"text"},L.value),null)])]})}}}),ta={class:"mb-4"},ia={class:"mb-4"},sa={class:"mb-4"},la={class:"mb-4"},da=ze({__name:"ArchiverView",props:{eventId:{}},setup(a){const _=a,{t:i}=xe(),n=De(),h=Pe(Be),{getEventById:p}=We(),m=j(()=>Ge(_.eventId,10)),w=O(!1),o=O(null),l=O(null),z=j(()=>[{title:p(m.value)?.name??"...",to:{name:"dashboard",params:{eventId:_.eventId}}},{title:i("ArchiverView.title"),disabled:!0}]);async function A(){w.value=!0;try{const r=await Ne({path:{event_pk:m.value}});l.value=r.data}catch(r){n.error(i("ArchiverView.loadFailure")),console.error(r)}finally{w.value=!1}}async function x(){o.value="show";try{const r=await Me({path:{event_pk:m.value}});l.value=r.data,n.success(i("ArchiverView.visibility.showSuccess"))}catch(r){n.error(i("ArchiverView.visibility.showFailure")),console.error(r)}finally{o.value=null}}async function D(){o.value="hide";try{const r=await Ke({path:{event_pk:m.value}});l.value=r.data,n.success(i("ArchiverView.visibility.hideSuccess"))}catch(r){n.error(i("ArchiverView.visibility.hideFailure")),console.error(r)}finally{o.value=null}}async function P(){o.value="optimize";try{const r=await Ue({path:{event_pk:m.value}});l.value=r.data,n.success(i("ArchiverView.votingData.optimizeSuccess"))}catch(r){n.error(i("ArchiverView.votingData.optimizeFailure")),console.error(r)}finally{o.value=null}}async function B(){const r=i("ArchiverView.votingData.removeVotesConfirm");await h.value.ifConfirmed(r,async()=>{o.value="removeVotes";try{const f=await qe({path:{event_pk:m.value}});l.value=f.data,n.success(i("ArchiverView.votingData.removeVotesSuccess"))}catch(f){n.error(i("ArchiverView.votingData.removeVotesFailure")),console.error(f)}finally{o.value=null}})}async function I(){const r=i("ArchiverView.userRights.transferConfirm");await h.value.ifConfirmed(r,async()=>{o.value="transfer";try{const f=await He({path:{event_pk:m.value}});l.value=f.data,n.success(i("ArchiverView.userRights.transferSuccess"))}catch(f){n.error(i("ArchiverView.userRights.transferFailure")),console.error(f)}finally{o.value=null}})}return Ie(A),Re(m,()=>{l.value=null,A()}),(r,f)=>(y(),g(Ye,{key:`archiver-${m.value}`,breadcrumbs:z.value},{default:s(()=>[w.value?(y(),g(V,{key:0,class:"d-flex justify-center my-8"},{default:s(()=>[t(Te,{indeterminate:"",size:"64"})]),_:1})):(y(),g(V,{key:1},{default:s(()=>[l.value?.ongoing_activity?(y(),g(S,{key:0,class:"mb-4"},{default:s(()=>[t(V,{cols:"12"},{default:s(()=>[t(aa,{type:"warning",variant:"tonal",prominent:""},{prepend:s(()=>[t(e(d),{icon:e(Ee),size:"lg"},null,8,["icon"])]),default:s(()=>[u(" "+c(e(i)("ArchiverView.ongoingWarning")),1)]),_:1})]),_:1})]),_:1})):Fe("",!0),t(S,{class:"mb-4"},{default:s(()=>[t(V,{cols:"12"},{default:s(()=>[t(T,null,{default:s(()=>[t(E,{class:"d-flex align-center"},{default:s(()=>[t(e(d),{icon:e(W),class:"mr-2"},null,8,["icon"]),u(" "+c(e(i)("ArchiverView.visibility.title")),1)]),_:1}),t(F,null,{default:s(()=>[v("p",ta,c(e(i)("ArchiverView.visibility.description")),1),t(k,{color:l.value?.is_archived?"success":"grey",class:"mb-4"},{default:s(()=>[t(e(d),{icon:l.value?.is_archived?e(C):e(Y),class:"mr-2"},null,8,["icon"]),u(" "+c(l.value?.is_archived?e(i)("ArchiverView.visibility.visible"):e(i)("ArchiverView.visibility.hidden")),1)]),_:1},8,["color"])]),_:1}),t($,null,{default:s(()=>[l.value?.is_archived?(y(),g(b,{key:0,color:"warning",loading:o.value==="hide",disabled:!!o.value,onClick:D},{prepend:s(()=>[t(e(d),{icon:e($e)},null,8,["icon"])]),default:s(()=>[u(" "+c(e(i)("ArchiverView.visibility.hideBtn")),1)]),_:1},8,["loading","disabled"])):(y(),g(b,{key:1,color:"success",loading:o.value==="show",disabled:!!o.value,onClick:x},{prepend:s(()=>[t(e(d),{icon:e(W)},null,8,["icon"])]),default:s(()=>[u(" "+c(e(i)("ArchiverView.visibility.showBtn")),1)]),_:1},8,["loading","disabled"]))]),_:1})]),_:1})]),_:1})]),_:1}),t(S,{class:"mb-4"},{default:s(()=>[t(V,{cols:"12"},{default:s(()=>[t(T,null,{default:s(()=>[t(E,{class:"d-flex align-center"},{default:s(()=>[t(e(d),{icon:e(G),class:"mr-2"},null,8,["icon"]),u(" "+c(e(i)("ArchiverView.votingData.title")),1)]),_:1}),t(F,null,{default:s(()=>[v("p",ia,c(e(i)("ArchiverView.votingData.description")),1),v("div",sa,[v("strong",null,c(e(i)("ArchiverView.votingData.scoresStatus")),1),t(k,{color:l.value?.votes_unoptimized?"warning":"success",class:"ml-2"},{default:s(()=>[t(e(d),{icon:l.value?.votes_unoptimized?e(Y):e(C),class:"mr-2"},null,8,["icon"]),u(" "+c(l.value?.votes_unoptimized?e(i)("ArchiverView.votingData.notOptimized"):e(i)("ArchiverView.votingData.optimized")),1)]),_:1},8,["color"])]),v("div",null,[v("strong",null,c(e(i)("ArchiverView.votingData.oldVotesStatus")),1),t(k,{color:l.value?.old_votes_found?"info":"success",class:"ml-2"},{default:s(()=>[t(e(d),{icon:l.value?.old_votes_found?e(Oe):e(C),class:"mr-2"},null,8,["icon"]),u(" "+c(l.value?.old_votes_found?e(i)("ArchiverView.votingData.oldVotesFound"):e(i)("ArchiverView.votingData.noOldVotes")),1)]),_:1},8,["color"])])]),_:1}),t($,null,{default:s(()=>[t(b,{color:"primary",loading:o.value==="optimize",disabled:!!o.value||l.value?.ongoing_activity||!l.value?.votes_unoptimized,onClick:P},{prepend:s(()=>[t(e(d),{icon:e(G)},null,8,["icon"])]),default:s(()=>[u(" "+c(e(i)("ArchiverView.votingData.optimizeBtn")),1)]),_:1},8,["loading","disabled"]),t(b,{color:"error",loading:o.value==="removeVotes",disabled:!!o.value||l.value?.ongoing_activity||l.value?.votes_unoptimized||!l.value?.old_votes_found,onClick:B},{prepend:s(()=>[t(e(d),{icon:e(je)},null,8,["icon"])]),default:s(()=>[u(" "+c(e(i)("ArchiverView.votingData.removeVotesBtn")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1}),t(S,{class:"mb-4"},{default:s(()=>[t(V,{cols:"12"},{default:s(()=>[t(T,null,{default:s(()=>[t(E,{class:"d-flex align-center"},{default:s(()=>[t(e(d),{icon:e(J),class:"mr-2"},null,8,["icon"]),u(" "+c(e(i)("ArchiverView.userRights.title")),1)]),_:1}),t(F,null,{default:s(()=>[v("p",la,c(e(i)("ArchiverView.userRights.description")),1),t(k,{color:l.value?.has_non_archived_items?"warning":"success",class:"mb-4"},{default:s(()=>[t(e(d),{icon:l.value?.has_non_archived_items?e(Le):e(C),class:"mr-2"},null,8,["icon"]),u(" "+c(l.value?.has_non_archived_items?e(i)("ArchiverView.userRights.hasNonArchived"):e(i)("ArchiverView.userRights.allTransferred")),1)]),_:1},8,["color"])]),_:1}),t($,null,{default:s(()=>[t(b,{color:"error",loading:o.value==="transfer",disabled:!!o.value||l.value?.ongoing_activity||!l.value?.has_non_archived_items,onClick:I},{prepend:s(()=>[t(e(d),{icon:e(J)},null,8,["icon"])]),default:s(()=>[u(" "+c(e(i)("ArchiverView.userRights.transferBtn")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1},8,["breadcrumbs"]))}});export{da as default};
//# sourceMappingURL=ArchiverView-BYihabe9.js.map
