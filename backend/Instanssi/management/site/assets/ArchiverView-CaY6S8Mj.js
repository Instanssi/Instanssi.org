import{d as $,a as G,v as L,J as M,K as P,o as W,U as Z,b as f,g as m,w as i,e as a,A as q,i as n,t as o,j as e,k as c,dz as Q,D as X,p as y,aB as b,c0 as R,B as C,f as h,a4 as g,Z as V,by as x,C as k,V as p,dA as Y,dB as E,dC as ee,a0 as ae,dD as I,dE as ie,I as F,s as D,dF as se,dG as te,dH as re,dI as le,dJ as oe,dK as ne,H as ce}from"./index-DXU74lGt.js";import{V as _,_ as ue}from"./LayoutBase.vue_vue_type_script_setup_true_lang-D4jd1chv.js";import{V as w}from"./VRow-B94Tto0H.js";import{V as ve}from"./VAlert-4DnKC4aq.js";import{p as de}from"./parseInt-Bzw_2rWL.js";import"./VContainer-BfWqa_tJ.js";const he={class:"mb-4"},fe={class:"mb-4"},me={class:"mb-4"},_e={class:"mb-4"},be=$({__name:"ArchiverView",props:{eventId:{}},setup(T){const z=T,{t:s}=G(),u=L(),S=M(P),{getEventById:N}=ce(),v=F(()=>de(z.eventId,10)),A=D(!1),r=D(null),t=D(null),O=F(()=>[{title:N(v.value)?.name??"...",to:{name:"dashboard",params:{eventId:z.eventId}}},{title:s("ArchiverView.title"),disabled:!0}]);async function B(){A.value=!0;try{const l=await se({path:{event_pk:v.value}});t.value=l.data}catch(l){u.error(s("ArchiverView.loadFailure")),console.error(l)}finally{A.value=!1}}async function j(){r.value="show";try{const l=await te({path:{event_pk:v.value}});t.value=l.data,u.success(s("ArchiverView.visibility.showSuccess"))}catch(l){u.error(s("ArchiverView.visibility.showFailure")),console.error(l)}finally{r.value=null}}async function H(){r.value="hide";try{const l=await re({path:{event_pk:v.value}});t.value=l.data,u.success(s("ArchiverView.visibility.hideSuccess"))}catch(l){u.error(s("ArchiverView.visibility.hideFailure")),console.error(l)}finally{r.value=null}}async function K(){r.value="optimize";try{const l=await le({path:{event_pk:v.value}});t.value=l.data,u.success(s("ArchiverView.votingData.optimizeSuccess"))}catch(l){u.error(s("ArchiverView.votingData.optimizeFailure")),console.error(l)}finally{r.value=null}}async function U(){const l=s("ArchiverView.votingData.removeVotesConfirm");await S.value.ifConfirmed(l,async()=>{r.value="removeVotes";try{const d=await oe({path:{event_pk:v.value}});t.value=d.data,u.success(s("ArchiverView.votingData.removeVotesSuccess"))}catch(d){u.error(s("ArchiverView.votingData.removeVotesFailure")),console.error(d)}finally{r.value=null}})}async function J(){const l=s("ArchiverView.userRights.transferConfirm");await S.value.ifConfirmed(l,async()=>{r.value="transfer";try{const d=await ne({path:{event_pk:v.value}});t.value=d.data,u.success(s("ArchiverView.userRights.transferSuccess"))}catch(d){u.error(s("ArchiverView.userRights.transferFailure")),console.error(d)}finally{r.value=null}})}return W(B),Z(v,()=>{t.value=null,B()}),(l,d)=>(f(),m(ue,{key:`archiver-${v.value}`,breadcrumbs:O.value},{default:i(()=>[A.value?(f(),m(_,{key:0,class:"d-flex justify-center my-8"},{default:i(()=>[a(q,{indeterminate:"",size:"64"})]),_:1})):(f(),m(_,{key:1},{default:i(()=>[t.value?.ongoing_activity?(f(),m(w,{key:0,class:"mb-4"},{default:i(()=>[a(_,{cols:"12"},{default:i(()=>[a(ve,{type:"warning",variant:"tonal",prominent:""},{prepend:i(()=>[a(e(c),{icon:e(Q),size:"lg"},null,8,["icon"])]),default:i(()=>[n(" "+o(e(s)("ArchiverView.ongoingWarning")),1)]),_:1})]),_:1})]),_:1})):X("",!0),a(w,{class:"mb-4"},{default:i(()=>[a(_,{cols:"12"},{default:i(()=>[a(y,null,{default:i(()=>[a(b,{class:"d-flex align-center"},{default:i(()=>[a(e(c),{icon:e(R),class:"mr-2"},null,8,["icon"]),n(" "+o(e(s)("ArchiverView.visibility.title")),1)]),_:1}),a(C,null,{default:i(()=>[h("p",he,o(e(s)("ArchiverView.visibility.description")),1),a(g,{color:t.value?.is_archived?"success":"grey",class:"mb-4"},{default:i(()=>[a(e(c),{icon:t.value?.is_archived?e(V):e(x),class:"mr-2"},null,8,["icon"]),n(" "+o(t.value?.is_archived?e(s)("ArchiverView.visibility.visible"):e(s)("ArchiverView.visibility.hidden")),1)]),_:1},8,["color"])]),_:1}),a(k,null,{default:i(()=>[t.value?.is_archived?(f(),m(p,{key:0,color:"warning",loading:r.value==="hide",disabled:!!r.value,onClick:H},{prepend:i(()=>[a(e(c),{icon:e(Y)},null,8,["icon"])]),default:i(()=>[n(" "+o(e(s)("ArchiverView.visibility.hideBtn")),1)]),_:1},8,["loading","disabled"])):(f(),m(p,{key:1,color:"success",loading:r.value==="show",disabled:!!r.value,onClick:j},{prepend:i(()=>[a(e(c),{icon:e(R)},null,8,["icon"])]),default:i(()=>[n(" "+o(e(s)("ArchiverView.visibility.showBtn")),1)]),_:1},8,["loading","disabled"]))]),_:1})]),_:1})]),_:1})]),_:1}),a(w,{class:"mb-4"},{default:i(()=>[a(_,{cols:"12"},{default:i(()=>[a(y,null,{default:i(()=>[a(b,{class:"d-flex align-center"},{default:i(()=>[a(e(c),{icon:e(E),class:"mr-2"},null,8,["icon"]),n(" "+o(e(s)("ArchiverView.votingData.title")),1)]),_:1}),a(C,null,{default:i(()=>[h("p",fe,o(e(s)("ArchiverView.votingData.description")),1),h("div",me,[h("strong",null,o(e(s)("ArchiverView.votingData.scoresStatus")),1),a(g,{color:t.value?.votes_unoptimized?"warning":"success",class:"ml-2"},{default:i(()=>[a(e(c),{icon:t.value?.votes_unoptimized?e(x):e(V),class:"mr-2"},null,8,["icon"]),n(" "+o(t.value?.votes_unoptimized?e(s)("ArchiverView.votingData.notOptimized"):e(s)("ArchiverView.votingData.optimized")),1)]),_:1},8,["color"])]),h("div",null,[h("strong",null,o(e(s)("ArchiverView.votingData.oldVotesStatus")),1),a(g,{color:t.value?.old_votes_found?"info":"success",class:"ml-2"},{default:i(()=>[a(e(c),{icon:t.value?.old_votes_found?e(ee):e(V),class:"mr-2"},null,8,["icon"]),n(" "+o(t.value?.old_votes_found?e(s)("ArchiverView.votingData.oldVotesFound"):e(s)("ArchiverView.votingData.noOldVotes")),1)]),_:1},8,["color"])])]),_:1}),a(k,null,{default:i(()=>[a(p,{color:"primary",loading:r.value==="optimize",disabled:!!r.value||t.value?.ongoing_activity||!t.value?.votes_unoptimized,onClick:K},{prepend:i(()=>[a(e(c),{icon:e(E)},null,8,["icon"])]),default:i(()=>[n(" "+o(e(s)("ArchiverView.votingData.optimizeBtn")),1)]),_:1},8,["loading","disabled"]),a(p,{color:"error",loading:r.value==="removeVotes",disabled:!!r.value||t.value?.ongoing_activity||t.value?.votes_unoptimized||!t.value?.old_votes_found,onClick:U},{prepend:i(()=>[a(e(c),{icon:e(ae)},null,8,["icon"])]),default:i(()=>[n(" "+o(e(s)("ArchiverView.votingData.removeVotesBtn")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1}),a(w,{class:"mb-4"},{default:i(()=>[a(_,{cols:"12"},{default:i(()=>[a(y,null,{default:i(()=>[a(b,{class:"d-flex align-center"},{default:i(()=>[a(e(c),{icon:e(I),class:"mr-2"},null,8,["icon"]),n(" "+o(e(s)("ArchiverView.userRights.title")),1)]),_:1}),a(C,null,{default:i(()=>[h("p",_e,o(e(s)("ArchiverView.userRights.description")),1),a(g,{color:t.value?.has_non_archived_items?"warning":"success",class:"mb-4"},{default:i(()=>[a(e(c),{icon:t.value?.has_non_archived_items?e(ie):e(V),class:"mr-2"},null,8,["icon"]),n(" "+o(t.value?.has_non_archived_items?e(s)("ArchiverView.userRights.hasNonArchived"):e(s)("ArchiverView.userRights.allTransferred")),1)]),_:1},8,["color"])]),_:1}),a(k,null,{default:i(()=>[a(p,{color:"error",loading:r.value==="transfer",disabled:!!r.value||t.value?.ongoing_activity||!t.value?.has_non_archived_items,onClick:J},{prepend:i(()=>[a(e(c),{icon:e(I)},null,8,["icon"])]),default:i(()=>[n(" "+o(e(s)("ArchiverView.userRights.transferBtn")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1},8,["breadcrumbs"]))}});export{be as default};
//# sourceMappingURL=ArchiverView-CaY6S8Mj.js.map
