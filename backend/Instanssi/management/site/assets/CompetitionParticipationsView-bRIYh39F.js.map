{"version":3,"file":"CompetitionParticipationsView-bRIYh39F.js","sources":["../../../../../admin/src/views/kompomaatti/CompetitionParticipationsView.vue"],"sourcesContent":["<template>\n    <LayoutBase :key=\"`participations-${eventId}`\" :breadcrumbs=\"breadcrumbs\">\n        <v-col>\n            <v-row>\n                <v-btn\n                    v-if=\"auth.canAdd(PermissionTarget.COMPETITION_PARTICIPATION)\"\n                    color=\"primary\"\n                    @click=\"createParticipation\"\n                >\n                    <template #prepend>\n                        <FontAwesomeIcon :icon=\"faPlus\" />\n                    </template>\n                    {{ t(\"CompetitionParticipationsView.newParticipation\") }}\n                </v-btn>\n                <div v-if=\"auth.canView(PermissionTarget.COMPETITION_PARTICIPATION)\" class=\"ml-4\">\n                    <ExportButton\n                        :label=\"t('CompetitionParticipationsView.exportResults')\"\n                        :loading=\"exportLoading\"\n                        @export=\"downloadResults\"\n                    />\n                </div>\n                <v-btn\n                    v-if=\"auth.canView(PermissionTarget.COMPETITION_PARTICIPATION)\"\n                    color=\"secondary\"\n                    class=\"ml-4\"\n                    @click=\"openDiplomaDialog\"\n                >\n                    <template #prepend>\n                        <FontAwesomeIcon :icon=\"faCertificate\" />\n                    </template>\n                    {{ t(\"DiplomaGenerator.title\") }}\n                </v-btn>\n                <v-text-field\n                    v-model=\"tableState.search.value\"\n                    variant=\"outlined\"\n                    density=\"compact\"\n                    :label=\"t('General.search')\"\n                    style=\"max-width: 400px\"\n                    class=\"ma-0 pa-0 ml-4\"\n                    clearable\n                />\n                <v-select\n                    v-model=\"selectedCompetition\"\n                    :items=\"competitionOptions\"\n                    variant=\"outlined\"\n                    density=\"compact\"\n                    :label=\"t('CompetitionParticipationsView.filterByCompetition')\"\n                    style=\"max-width: 300px\"\n                    class=\"ma-0 pa-0 ml-4\"\n                    clearable\n                />\n                <v-select\n                    v-model=\"filterDisqualified\"\n                    :items=\"[\n                        { title: t('CompetitionParticipationsView.allStatuses'), value: null },\n                        { title: t('General.disqualifiedOn'), value: true },\n                        { title: t('General.disqualifiedOff'), value: false },\n                    ]\"\n                    variant=\"outlined\"\n                    density=\"compact\"\n                    :label=\"t('CompetitionParticipationsView.filterByDisqualified')\"\n                    style=\"max-width: 200px\"\n                    class=\"ma-0 pa-0 ml-4\"\n                />\n            </v-row>\n        </v-col>\n        <v-col>\n            <v-row>\n                <v-data-table-server\n                    v-model:items-per-page=\"tableState.perPage.value\"\n                    :sort-by=\"tableState.sortByArray.value\"\n                    class=\"elevation-1 primary\"\n                    item-value=\"id\"\n                    density=\"compact\"\n                    :headers=\"headers\"\n                    :items=\"participations\"\n                    :items-length=\"totalItems\"\n                    :loading=\"loading\"\n                    :page=\"tableState.page.value\"\n                    :search=\"tableState.search.value\"\n                    :items-per-page-options=\"tableState.pageSizeOptions\"\n                    :no-data-text=\"t('CompetitionParticipationsView.noParticipationsFound')\"\n                    :loading-text=\"t('CompetitionParticipationsView.loadingParticipations')\"\n                    @update:options=\"onTableOptionsUpdate\"\n                >\n                    <template #item.competition=\"{ item }\">\n                        {{ getCompetitionName(item.competition) }}\n                    </template>\n                    <template #item.user=\"{ item }\">\n                        {{ getUserName(item.user) }}\n                    </template>\n                    <template #item.disqualified=\"{ item }\">\n                        <FontAwesomeIcon\n                            v-if=\"item.disqualified\"\n                            :icon=\"faCheck\"\n                            class=\"text-red\"\n                        />\n                        <FontAwesomeIcon v-else :icon=\"faXmark\" class=\"text-green\" />\n                    </template>\n                    <template #item.rank=\"{ item }\">\n                        {{ item.rank ?? \"-\" }}\n                    </template>\n                    <template #item.actions=\"{ item }\">\n                        <TableActionButtons\n                            :can-edit=\"auth.canChange(PermissionTarget.COMPETITION_PARTICIPATION)\"\n                            :can-delete=\"auth.canDelete(PermissionTarget.COMPETITION_PARTICIPATION)\"\n                            :audit-log=\"{\n                                appLabel: 'kompomaatti',\n                                model: 'competitionparticipation',\n                                objectPk: item.id,\n                            }\"\n                            @edit=\"editParticipation(item.id)\"\n                            @delete=\"deleteParticipation(item)\"\n                        />\n                    </template>\n                </v-data-table-server>\n            </v-row>\n        </v-col>\n        <DiplomaGeneratorDialog ref=\"diplomaDialog\" :event-id=\"eventId\" />\n    </LayoutBase>\n</template>\n\n<script setup lang=\"ts\">\nimport { faCertificate, faCheck, faPlus, faXmark } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/vue-fontawesome\";\nimport { debounce, parseInt } from \"lodash-es\";\nimport { type Ref, computed, inject, onMounted, ref, watch } from \"vue\";\nimport { useI18n } from \"vue-i18n\";\nimport { useRouter } from \"vue-router\";\nimport { useToast } from \"vue-toastification\";\nimport type { VDataTable } from \"vuetify/components\";\n\nimport * as api from \"@/api\";\nimport type { Competition, CompetitionParticipation, User } from \"@/api\";\nimport ExportButton from \"@/components/form/ExportButton.vue\";\nimport LayoutBase, { type BreadcrumbItem } from \"@/components/layout/LayoutBase.vue\";\nimport TableActionButtons from \"@/components/table/TableActionButtons.vue\";\nimport { useTableState } from \"@/composables/useTableState\";\nimport { PermissionTarget, useAuth } from \"@/services/auth\";\nimport { useEvents } from \"@/services/events\";\nimport { type LoadArgs, getLoadArgs } from \"@/services/utils/query_tools\";\nimport { confirmDialogKey } from \"@/symbols\";\nimport type { ConfirmDialogType } from \"@/symbols\";\nimport { getApiErrorMessage } from \"@/utils/http\";\nimport { toRomanNumeral } from \"@/utils/roman\";\nimport { downloadSpreadsheet, type SpreadsheetFormat } from \"@/utils/spreadsheet\";\nimport DiplomaGeneratorDialog from \"./DiplomaGeneratorDialog.vue\";\n\ntype ReadonlyHeaders = VDataTable[\"$props\"][\"headers\"];\n\nconst props = defineProps<{ eventId: string }>();\nconst { t } = useI18n();\nconst router = useRouter();\nconst confirmDialog: ConfirmDialogType = inject(confirmDialogKey)!;\nconst toast = useToast();\nconst auth = useAuth();\nconst { getEventById } = useEvents();\nconst eventId = computed(() => parseInt(props.eventId, 10));\nconst loading = ref(false);\nconst exportLoading = ref(false);\nconst diplomaDialog: Ref<InstanceType<typeof DiplomaGeneratorDialog> | undefined> = ref(undefined);\n\nconst breadcrumbs = computed<BreadcrumbItem[]>(() => [\n    {\n        title: getEventById(eventId.value)?.name ?? \"...\",\n        to: { name: \"dashboard\", params: { eventId: props.eventId } },\n    },\n    { title: t(\"CompetitionParticipationsView.title\"), disabled: true },\n]);\n\nconst tableState = useTableState({ filterKeys: [\"competition\", \"disqualified\"] });\nconst totalItems = ref(0);\nconst participations: Ref<CompetitionParticipation[]> = ref([]);\nconst competitions: Ref<Competition[]> = ref([]);\nconst users: Ref<User[]> = ref([]);\nconst lastLoadArgs: Ref<LoadArgs | null> = ref(null);\n\nconst selectedCompetition = computed({\n    get: () => tableState.getFilterAsNumber(\"competition\"),\n    set: (value: number | null) => {\n        tableState.setFilter(\"competition\", value);\n        tableState.resetPage();\n    },\n});\n\nconst filterDisqualified = tableState.useBooleanFilter(\"disqualified\");\n\nconst headers: ReadonlyHeaders = [\n    {\n        title: t(\"CompetitionParticipationsView.headers.id\"),\n        sortable: true,\n        key: \"id\",\n    },\n    {\n        title: t(\"CompetitionParticipationsView.headers.participantName\"),\n        sortable: true,\n        key: \"participant_name\",\n    },\n    {\n        title: t(\"CompetitionParticipationsView.headers.user\"),\n        sortable: false,\n        key: \"user\",\n    },\n    {\n        title: t(\"CompetitionParticipationsView.headers.competition\"),\n        sortable: false,\n        key: \"competition\",\n    },\n    {\n        title: t(\"CompetitionParticipationsView.headers.score\"),\n        sortable: true,\n        key: \"score\",\n    },\n    {\n        title: t(\"CompetitionParticipationsView.headers.disqualified\"),\n        sortable: false,\n        key: \"disqualified\",\n    },\n    {\n        title: t(\"CompetitionParticipationsView.headers.rank\"),\n        sortable: false,\n        key: \"rank\",\n    },\n    {\n        title: t(\"CompetitionParticipationsView.headers.actions\"),\n        sortable: false,\n        key: \"actions\",\n        align: \"end\",\n    },\n];\n\nconst competitionOptions = computed(() => [\n    { title: t(\"CompetitionParticipationsView.allCompetitions\"), value: null },\n    ...competitions.value.map((c) => ({ title: c.name, value: c.id })),\n]);\n\nfunction getCompetitionName(competitionId: number): string {\n    const competition = competitions.value.find((c) => c.id === competitionId);\n    return competition?.name ?? `#${competitionId}`;\n}\n\nfunction getUserName(userId: number): string {\n    const user = users.value.find((u) => u.id === userId);\n    return user?.username ?? `#${userId}`;\n}\n\nfunction flushData() {\n    if (lastLoadArgs.value) {\n        load(lastLoadArgs.value);\n    }\n}\n\nasync function loadCompetitions() {\n    try {\n        const response = await api.adminEventKompomaattiCompetitionsList({\n            path: { event_pk: eventId.value },\n            query: { limit: 100 },\n        });\n        competitions.value = response.data!.results;\n    } catch (e) {\n        console.error(\"Failed to load competitions:\", e);\n    }\n}\n\nasync function loadUsers() {\n    try {\n        const response = await api.adminUsersList({\n            query: { limit: 1000 },\n        });\n        users.value = response.data!.results;\n    } catch (e) {\n        console.error(\"Failed to load users:\", e);\n    }\n}\n\nasync function load(args: LoadArgs) {\n    loading.value = true;\n    lastLoadArgs.value = args;\n    try {\n        const response = await api.adminEventKompomaattiCompetitionParticipationsList({\n            path: { event_pk: parseInt(props.eventId, 10) },\n            query: {\n                ...getLoadArgs(args),\n                ...(selectedCompetition.value ? { competition: selectedCompetition.value } : {}),\n                ...(filterDisqualified.value !== null\n                    ? { disqualified: filterDisqualified.value }\n                    : {}),\n            },\n        });\n        participations.value = response.data!.results;\n        totalItems.value = response.data!.count;\n    } catch (e) {\n        toast.error(t(\"CompetitionParticipationsView.loadFailure\"));\n        console.error(e);\n    } finally {\n        loading.value = false;\n    }\n}\n\nconst debouncedLoad = debounce(load, 250);\n\nfunction onTableOptionsUpdate(args: LoadArgs) {\n    tableState.onOptionsUpdate(args);\n    debouncedLoad(args);\n}\n\n// Reload when filters change\nwatch([selectedCompetition, filterDisqualified], () => {\n    if (lastLoadArgs.value) {\n        debouncedLoad({ ...lastLoadArgs.value, page: 1 });\n    }\n});\n\nfunction refresh() {\n    tableState.setFilter(\"competition\", null);\n    tableState.setFilter(\"disqualified\", null);\n    tableState.search.value = \"\";\n    tableState.page.value = 1;\n    loadCompetitions();\n    debouncedLoad({\n        page: 1,\n        itemsPerPage: tableState.perPage.value ?? 25,\n        sortBy: [],\n        groupBy: [] as never,\n        search: \"\",\n    });\n}\n\n// Reload competitions when event changes\nwatch(eventId, refresh);\n\nasync function deleteParticipation(item: CompetitionParticipation): Promise<void> {\n    const text = t(\"CompetitionParticipationsView.confirmDelete\", {\n        name: item.participant_name || `#${item.id}`,\n    });\n    await confirmDialog.value!.ifConfirmed(text, async () => {\n        try {\n            await api.adminEventKompomaattiCompetitionParticipationsDestroy({\n                path: { event_pk: eventId.value, id: item.id },\n            });\n            toast.success(t(\"CompetitionParticipationsView.deleteSuccess\"));\n            flushData();\n        } catch (e) {\n            toast.error(getApiErrorMessage(e, t(\"CompetitionParticipationsView.deleteFailure\")));\n            console.error(e);\n        }\n    });\n}\n\nfunction editParticipation(id: number): void {\n    router.push({\n        name: \"competition-participations-edit\",\n        params: { eventId: eventId.value, id },\n    });\n}\n\nfunction createParticipation(): void {\n    router.push({ name: \"competition-participations-new\", params: { eventId: eventId.value } });\n}\n\nfunction openDiplomaDialog(): void {\n    diplomaDialog.value?.open();\n}\n\ninterface ResultRow {\n    participantName: string;\n    rankString: string;\n    competitionName: string;\n}\n\n/**\n * Generate results data with top 3 participations per competition.\n */\nfunction generateResultsData(allParticipations: CompetitionParticipation[]): ResultRow[] {\n    // Group participations by competition\n    const participationsByCompetition = new Map<number, CompetitionParticipation[]>();\n    for (const participation of allParticipations) {\n        const compParticipations = participationsByCompetition.get(participation.competition) ?? [];\n        compParticipations.push(participation);\n        participationsByCompetition.set(participation.competition, compParticipations);\n    }\n\n    // Build rows: top 3 participations per competition, sorted by rank\n    const rows: ResultRow[] = [];\n    for (const competition of competitions.value) {\n        const compParticipations = participationsByCompetition.get(competition.id) ?? [];\n\n        // Sort by rank (participations without rank go to the end)\n        const sorted = [...compParticipations].sort((a, b) => {\n            if (a.rank === null && b.rank === null) return 0;\n            if (a.rank === null) return 1;\n            if (b.rank === null) return -1;\n            return a.rank - b.rank;\n        });\n\n        // Take top 3\n        const top3 = sorted.slice(0, 3);\n\n        for (const participation of top3) {\n            if (participation.rank === null) continue; // Skip unranked participations\n            rows.push({\n                participantName: participation.participant_name || \"Unknown\",\n                rankString: toRomanNumeral(participation.rank),\n                competitionName: competition.name,\n            });\n        }\n    }\n\n    return rows;\n}\n\n/**\n * Generate and download spreadsheet with top 3 participations per competition\n */\nasync function downloadResults(format: SpreadsheetFormat): Promise<void> {\n    exportLoading.value = true;\n    try {\n        const response = await api.adminEventKompomaattiCompetitionParticipationsList({\n            path: { event_pk: eventId.value },\n            query: { limit: 10000 },\n        });\n        const results = generateResultsData(response.data!.results);\n        const data = results.map((row) => [\n            row.participantName,\n            row.rankString,\n            row.competitionName,\n        ]);\n        downloadSpreadsheet(data, \"instanssi_competition_results\", format, \"Results\");\n        toast.success(t(\"CompetitionParticipationsView.exportSuccess\"));\n    } catch (e) {\n        toast.error(t(\"CompetitionParticipationsView.exportFailure\"));\n        console.error(e);\n    } finally {\n        exportLoading.value = false;\n    }\n}\n\nonMounted(() => {\n    loadCompetitions();\n    loadUsers();\n});\n</script>\n"],"names":["props","__props","t","useI18n","router","useRouter","confirmDialog","inject","confirmDialogKey","toast","useToast","auth","useAuth","getEventById","useEvents","eventId","computed","parseInt","loading","ref","exportLoading","diplomaDialog","breadcrumbs","tableState","useTableState","totalItems","participations","competitions","users","lastLoadArgs","selectedCompetition","value","filterDisqualified","headers","competitionOptions","c","getCompetitionName","competitionId","getUserName","userId","u","flushData","load","loadCompetitions","response","api.adminEventKompomaattiCompetitionsList","e","loadUsers","api.adminUsersList","args","api.adminEventKompomaattiCompetitionParticipationsList","getLoadArgs","debouncedLoad","debounce","onTableOptionsUpdate","watch","refresh","deleteParticipation","item","text","api.adminEventKompomaattiCompetitionParticipationsDestroy","getApiErrorMessage","editParticipation","id","createParticipation","openDiplomaDialog","generateResultsData","allParticipations","participationsByCompetition","participation","compParticipations","rows","competition","top3","a","b","toRomanNumeral","downloadResults","format","data","row","downloadSpreadsheet","onMounted","_createBlock","LayoutBase","_createVNode","_component_v_col","_component_v_row","_unref","PermissionTarget","_component_v_btn","FontAwesomeIcon","faPlus","_createTextVNode","_openBlock","_createElementBlock","_hoisted_1","ExportButton","faCertificate","_component_v_text_field","$event","_component_v_select","_component_v_data_table_server","_withCtx","faCheck","faXmark","_toDisplayString","TableActionButtons","DiplomaGeneratorDialog"],"mappings":"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"}