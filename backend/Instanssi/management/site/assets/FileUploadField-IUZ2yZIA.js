import{d as K,a as J,U as Q,aM as Y,b as d,c as y,e as l,h as Z,w as t,aA as L,l as U,j as a,az as R,g as C,V as p,k as c,aF as ee,aG as le,aH as ae,aN as te,p as I,aB as h,f as j,t as V,aC as _,aD as N,B as E,aE as P,D as $,F as ie,s as m,I as k,_ as ne}from"./index-DXU74lGt.js";import{V as oe,g as D}from"./formdata-BXUVcBgf.js";const ue=["title"],re=["src"],se=["src"],de=K({__name:"FileUploadField",props:{modelValue:{},currentFileUrl:{default:null},label:{},errorMessage:{default:void 0},accept:{default:void 0},required:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(x,{emit:O}){const z=["jpg","jpeg","png","gif","webp","svg","bmp","ico"],A=["mp4","mkv","webm","avi","mov","wmv","flv","ogv"],M=["mp3","ogg","opus","aac","wav","flac","m4a","wma"];function S(n,e){if(e){if(e.startsWith("image/"))return"image";if(e.startsWith("video/"))return"video";if(e.startsWith("audio/"))return"audio"}if(n){const i=n.split(".").pop()?.toLowerCase();if(i){if(z.includes(i))return"image";if(A.includes(i))return"video";if(M.includes(i))return"audio"}}return"other"}function T(n){if(!n)return null;try{return new URL(n).pathname.split("/").pop()||null}catch{return n.split("/").pop()?.split("?")[0]||null}}const o=x,B=O,{t:u}=J(),X=m(),v=m(!1),F=m(!1),w=m(!1),r=m(null),f=m(!1),W=k(()=>o.required?`${o.label} *`:o.label),g=k(()=>D(o.modelValue)),q=k(()=>{if(g.value)return g.value;if(f.value)return null;if(o.currentFileUrl){const n=T(o.currentFileUrl);if(n)return new File([],n)}return null}),b=k(()=>{if(g.value)return S(g.value.name,g.value.type);if(!f.value&&o.currentFileUrl){const n=T(o.currentFileUrl);return S(n,null)}return"other"});Q(()=>o.modelValue,n=>{r.value&&(URL.revokeObjectURL(r.value),r.value=null);const e=D(n);e&&(r.value=URL.createObjectURL(e),f.value=!1)},{immediate:!0}),Y(()=>{r.value&&URL.revokeObjectURL(r.value)});const s=k(()=>r.value?r.value:f.value?null:o.currentFileUrl??null);function G(n){f.value=!1,B("update:modelValue",n)}function H(){f.value=!0,B("update:modelValue",null)}return(n,e)=>(d(),y(ie,null,[l(oe,{ref_key:"fileInputRef",ref:X,"model-value":q.value,label:W.value,"error-messages":x.errorMessage,accept:x.accept,variant:"outlined","prepend-icon":"",clearable:"","onUpdate:modelValue":G,"onClick:clear":H},Z({"prepend-inner":t(()=>[l(a(c),{icon:a(te),class:"mr-2"},null,8,["icon"])]),_:2},[s.value?{name:"append-inner",fn:t(()=>[b.value==="image"?(d(),y("div",{key:0,class:"file-preview",role:"button",tabindex:"0",title:a(u)("FileUploadField.clickToPreview"),onClick:e[0]||(e[0]=U(i=>v.value=!0,["stop"])),onKeydown:[e[1]||(e[1]=L(i=>v.value=!0,["enter"])),e[2]||(e[2]=L(U(i=>v.value=!0,["prevent"]),["space"]))]},[l(R,{src:s.value,width:"32",height:"32",cover:"",class:"rounded"},null,8,["src"])],40,ue)):b.value==="video"?(d(),C(p,{key:1,icon:"",variant:"text",size:"x-small",title:a(u)("FileUploadField.clickToPreview"),onClick:e[3]||(e[3]=U(i=>F.value=!0,["stop"]))},{default:t(()=>[l(a(c),{icon:a(ee),size:"lg"},null,8,["icon"])]),_:1},8,["title"])):b.value==="audio"?(d(),C(p,{key:2,icon:"",variant:"text",size:"x-small",title:a(u)("FileUploadField.clickToPreview"),onClick:e[4]||(e[4]=U(i=>w.value=!0,["stop"]))},{default:t(()=>[l(a(c),{icon:a(le),size:"lg"},null,8,["icon"])]),_:1},8,["title"])):(d(),C(p,{key:3,icon:"",variant:"text",size:"x-small",href:s.value,target:"_blank",title:a(u)("FileUploadField.download"),onClick:e[5]||(e[5]=U(()=>{},["stop"]))},{default:t(()=>[l(a(c),{icon:a(ae),size:"lg"},null,8,["icon"])]),_:1},8,["href","title"]))]),key:"0"}:void 0]),1032,["model-value","label","error-messages","accept"]),l(P,{modelValue:v.value,"onUpdate:modelValue":e[7]||(e[7]=i=>v.value=i),"max-width":"900"},{default:t(()=>[l(I,null,{default:t(()=>[l(h,{class:"d-flex justify-space-between align-center"},{default:t(()=>[j("span",null,V(a(u)("FileUploadField.imagePreviewTitle")),1),l(p,{icon:"",variant:"text",density:"compact",onClick:e[6]||(e[6]=i=>v.value=!1)},{default:t(()=>[l(a(c),{icon:a(_)},null,8,["icon"])]),_:1})]),_:1}),l(N),l(E,{class:"d-flex justify-center pa-4"},{default:t(()=>[l(R,{src:s.value??void 0,"max-height":"70vh","max-width":"100%"},null,8,["src"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(P,{modelValue:F.value,"onUpdate:modelValue":e[9]||(e[9]=i=>F.value=i),"max-width":"900"},{default:t(()=>[l(I,null,{default:t(()=>[l(h,{class:"d-flex justify-space-between align-center"},{default:t(()=>[j("span",null,V(a(u)("FileUploadField.videoPreviewTitle")),1),l(p,{icon:"",variant:"text",density:"compact",onClick:e[8]||(e[8]=i=>F.value=!1)},{default:t(()=>[l(a(c),{icon:a(_)},null,8,["icon"])]),_:1})]),_:1}),l(N),l(E,{class:"d-flex justify-center pa-4"},{default:t(()=>[F.value&&s.value?(d(),y("video",{key:0,src:s.value,controls:"",autoplay:"",class:"video-player"},V(a(u)("FileUploadField.videoNotSupported")),9,re)):$("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(P,{modelValue:w.value,"onUpdate:modelValue":e[11]||(e[11]=i=>w.value=i),"max-width":"500"},{default:t(()=>[l(I,null,{default:t(()=>[l(h,{class:"d-flex justify-space-between align-center"},{default:t(()=>[j("span",null,V(a(u)("FileUploadField.audioPreviewTitle")),1),l(p,{icon:"",variant:"text",density:"compact",onClick:e[10]||(e[10]=i=>w.value=!1)},{default:t(()=>[l(a(c),{icon:a(_)},null,8,["icon"])]),_:1})]),_:1}),l(N),l(E,{class:"d-flex justify-center pa-4"},{default:t(()=>[w.value&&s.value?(d(),y("audio",{key:0,src:s.value,controls:"",autoplay:"",class:"audio-player"},V(a(u)("FileUploadField.audioNotSupported")),9,se)):$("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),fe=ne(de,[["__scopeId","data-v-ca2bbe6c"]]);export{fe as F};
//# sourceMappingURL=FileUploadField-IUZ2yZIA.js.map
