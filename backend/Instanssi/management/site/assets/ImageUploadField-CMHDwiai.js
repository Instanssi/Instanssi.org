import{d as B,a as j,L as R,aO as _,b as $,c as D,e as l,h as O,w as r,f as V,aB as U,aC as w,l as b,j as s,k as I,bv as T,p as M,aD as q,t as E,V as K,aE as N,aF as P,B as S,aG as A,F as G,s as p,I as d,_ as X}from"./index-CQkWvXOv.js";import{V as z,g as F}from"./formdata-0PwnLkt-.js";const H=["title"],J=B({__name:"ImageUploadField",props:{modelValue:{},currentImageUrl:{default:null},label:{},errorMessage:{default:void 0},accept:{default:"image/*"},required:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(c,{emit:h}){const t=c,v=h,{t:f}=j(),u=p(!1),n=p(null),o=p(!1),x=d(()=>t.required?`${t.label} *`:t.label),g=d(()=>F(t.modelValue));function C(a){if(!a)return null;try{return new URL(a).pathname.split("/").pop()||null}catch{return a.split("/").pop()?.split("?")[0]||null}}const k=d(()=>{if(g.value)return g.value;if(o.value)return null;if(t.currentImageUrl){const a=C(t.currentImageUrl);if(a)return new File([],a)}return null});R(()=>t.modelValue,a=>{n.value&&(URL.revokeObjectURL(n.value),n.value=null);const e=F(a);e&&(n.value=URL.createObjectURL(e),o.value=!1)},{immediate:!0}),_(()=>{n.value&&URL.revokeObjectURL(n.value)});const m=d(()=>n.value?n.value:o.value?null:t.currentImageUrl??null);function y(a){o.value=!1,v("update:modelValue",a)}function L(){o.value=!0,v("update:modelValue",null)}return(a,e)=>($(),D(G,null,[l(z,{"model-value":k.value,label:x.value,"error-messages":c.errorMessage,accept:c.accept,variant:"outlined","prepend-icon":"",clearable:"","onUpdate:modelValue":y,"onClick:clear":L},O({"prepend-inner":r(()=>[l(s(I),{icon:s(T),class:"mr-2"},null,8,["icon"])]),_:2},[m.value?{name:"append-inner",fn:r(()=>[V("div",{class:"image-preview",role:"button",tabindex:"0",title:s(f)("ImageUploadField.clickToPreview"),onClick:e[0]||(e[0]=b(i=>u.value=!0,["stop"])),onKeydown:[e[1]||(e[1]=w(i=>u.value=!0,["enter"])),e[2]||(e[2]=w(b(i=>u.value=!0,["prevent"]),["space"]))]},[l(U,{src:m.value,width:"32",height:"32",cover:"",class:"rounded"},null,8,["src"])],40,H)]),key:"0"}:void 0]),1032,["model-value","label","error-messages","accept"]),l(A,{modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=i=>u.value=i),"max-width":"900"},{default:r(()=>[l(M,null,{default:r(()=>[l(q,{class:"d-flex justify-space-between align-center"},{default:r(()=>[V("span",null,E(s(f)("ImageUploadField.previewTitle")),1),l(K,{icon:"",variant:"text",density:"compact",onClick:e[3]||(e[3]=i=>u.value=!1)},{default:r(()=>[l(s(I),{icon:s(N)},null,8,["icon"])]),_:1})]),_:1}),l(P),l(S,{class:"d-flex justify-center pa-4"},{default:r(()=>[l(U,{src:m.value??void 0,"max-height":"70vh","max-width":"100%"},null,8,["src"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),Y=X(J,[["__scopeId","data-v-2547effa"]]);export{Y as I};
//# sourceMappingURL=ImageUploadField-CMHDwiai.js.map
