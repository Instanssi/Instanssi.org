{"version":3,"file":"LoginView-B0FHJA5r.js","sources":["../../../../../admin/src/views/auth/LoginView.vue"],"sourcesContent":["<template>\n    <div class=\"d-flex align-center justify-center fill-height\">\n        <v-card color=\"grey-darken-4\" class=\"opacity-95\" :title=\"t('LoginView.title')\">\n            <template #subtitle>\n                {{ t(\"LoginView.subtitle\") }}\n            </template>\n            <template #text>\n                <div class=\"d-flex justify-center\">\n                    <v-btn\n                        v-for=\"method in socialLoginUrls\"\n                        :key=\"method.method\"\n                        variant=\"plain\"\n                        :href=\"method.url\"\n                    >\n                        <template v-if=\"socialIcons[method.method]\" #prepend>\n                            <FontAwesomeIcon :icon=\"socialIcons[method.method]!\" />\n                        </template>\n                        {{ method.name }}\n                    </v-btn>\n                </div>\n                <v-form class=\"mt-4\" @submit.prevent=\"submit\">\n                    <v-container class=\"ma-0 pa-0\">\n                        <v-row dense no-gutters class=\"mb-2 mt-2\">\n                            <v-text-field\n                                v-model=\"username.value.value\"\n                                :error-messages=\"username.errorMessage.value\"\n                                density=\"compact\"\n                                variant=\"outlined\"\n                                :label=\"t('LoginView.username')\"\n                            />\n                        </v-row>\n                        <v-row dense no-gutters class=\"mb-2 mt-2\">\n                            <v-text-field\n                                v-model=\"password.value.value\"\n                                :error-messages=\"password.errorMessage.value\"\n                                type=\"password\"\n                                density=\"compact\"\n                                variant=\"outlined\"\n                                :label=\"t('LoginView.password')\"\n                            />\n                        </v-row>\n                        <v-row dense no-gutters class=\"justify-end\">\n                            <v-btn type=\"submit\" color=\"primary\" variant=\"elevated\">\n                                <template #prepend>\n                                    <FontAwesomeIcon :icon=\"faRightToBracket\" />\n                                </template>\n                                {{ t(\"LoginView.login\") }}\n                            </v-btn>\n                        </v-row>\n                    </v-container>\n                </v-form>\n            </template>\n        </v-card>\n    </div>\n</template>\n\n<script setup lang=\"ts\">\nimport type { IconDefinition } from \"@fortawesome/fontawesome-svg-core\";\nimport { faGithub, faGoogle, faSteam } from \"@fortawesome/free-brands-svg-icons\";\nimport { faRightToBracket } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/vue-fontawesome\";\nimport { useField, useForm } from \"vee-validate\";\nimport { type Ref, onMounted, ref } from \"vue\";\nimport { useI18n } from \"vue-i18n\";\nimport { useRouter } from \"vue-router\";\nimport { object as yupObject, string as yupString } from \"yup\";\n\nimport type { SocialAuthUrl } from \"@/api\";\nimport { PermissionTarget, useAuth } from \"@/services/auth\";\n\nconst authService = useAuth();\nconst router = useRouter();\nconst { t } = useI18n();\n\nconst socialIcons: Record<string, IconDefinition> = {\n    google: faGoogle,\n    steam: faSteam,\n    github: faGithub,\n};\n\nconst socialLoginUrls: Ref<SocialAuthUrl[]> = ref([]);\n\n// Field validation rules\nconst validationSchema = yupObject({\n    username: yupString().required().min(1),\n    password: yupString().required().min(1),\n});\nconst { handleSubmit, setErrors } = useForm({ validationSchema });\nconst username = useField(\"username\");\nconst password = useField(\"password\");\n\nconst submit = handleSubmit(async (values) => {\n    const loginOk = await authService.login(values.username, values.password);\n    if (!loginOk) {\n        setErrors({\n            username: t(\"LoginView.auth_failed\"),\n            password: t(\"LoginView.auth_failed\"),\n        });\n        return;\n    }\n    if (!authService.canView(PermissionTarget.EVENT)) {\n        await authService.logout();\n        setErrors({\n            username: t(\"LoginView.insufficient_permissions\"),\n            password: t(\"LoginView.insufficient_permissions\"),\n        });\n        return;\n    }\n    await router.push({ name: \"index\" });\n});\n\nonMounted(async () => {\n    socialLoginUrls.value = await authService.getSocialAuthURLs();\n});\n</script>\n\n<style scoped lang=\"scss\">\n.opacity-95 {\n    opacity: 0.95;\n}\n</style>\n"],"names":["authService","useAuth","router","useRouter","useI18n","socialIcons","faGoogle","faSteam","faGithub","socialLoginUrls","ref","validationSchema","yupObject","yupString","handleSubmit","setErrors","useForm","username","useField","password","submit","values","PermissionTarget","onMounted","_openBlock","_createElementBlock","_hoisted_1","_createVNode","_component_v_card","_unref","_createElementVNode","_hoisted_2","_Fragment","_renderList","method","_createBlock","_component_v_btn","_toDisplayString","FontAwesomeIcon","_component_v_form","_component_v_container","_component_v_row","_component_v_text_field","$event","faRightToBracket","_createTextVNode"],"mappings":"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"}