import{d as F,u as B,a as T,P as j,o as C,b as d,c as w,e as a,w as s,f as E,F as I,r as M,g as N,V as _,h as R,i as m,t as c,j as e,k as v,l as U,m as b,n as q,p as A,q as G,s as O,_ as P}from"./index-CQkWvXOv.js";import{f as $,a as D,b as z}from"./index-DW3SUbXG.js";import{c as H,a as h,u as J,b as y}from"./index.esm-aFENq7CA.js";import{V as K}from"./VForm-VvaADaOh.js";import{V as Q}from"./VContainer-DqJ8gu3P.js";import{V as f}from"./VRow-CXIXhuhq.js";import"./_commonjsHelpers-CqkleIqs.js";const W={class:"d-flex align-center justify-center fill-height"},X={class:"d-flex justify-center"},Y=F({__name:"LoginView",setup(Z){const r=G(),L=B(),{t}=T(),p={google:z,steam:D,github:$},g=O([]),k=H({username:h().required().min(1),password:h().required().min(1)}),{handleSubmit:x,setErrors:V}=J({validationSchema:k}),i=y("username"),l=y("password"),S=x(async u=>{if(!await r.login(u.username,u.password)){V({username:t("LoginView.auth_failed"),password:t("LoginView.auth_failed")});return}if(!r.canView(j.EVENT)){await r.logout(),V({username:t("LoginView.insufficient_permissions"),password:t("LoginView.insufficient_permissions")});return}await L.push({name:"index"})});return C(async()=>{g.value=await r.getSocialAuthURLs()}),(u,n)=>(d(),w("div",W,[a(A,{color:"grey-darken-4",class:"opacity-95",title:e(t)("LoginView.title")},{subtitle:s(()=>[m(c(e(t)("LoginView.subtitle")),1)]),text:s(()=>[E("div",X,[(d(!0),w(I,null,M(g.value,o=>(d(),N(_,{key:o.method,variant:"plain",href:o.url},R({default:s(()=>[m(" "+c(o.name),1)]),_:2},[p[o.method]?{name:"prepend",fn:s(()=>[a(e(v),{icon:p[o.method]},null,8,["icon"])]),key:"0"}:void 0]),1032,["href"]))),128))]),a(K,{class:"mt-4",onSubmit:U(e(S),["prevent"])},{default:s(()=>[a(Q,{class:"ma-0 pa-0"},{default:s(()=>[a(f,{dense:"","no-gutters":"",class:"mb-2 mt-2"},{default:s(()=>[a(b,{modelValue:e(i).value.value,"onUpdate:modelValue":n[0]||(n[0]=o=>e(i).value.value=o),"error-messages":e(i).errorMessage.value,density:"compact",variant:"outlined",label:e(t)("LoginView.username")},null,8,["modelValue","error-messages","label"])]),_:1}),a(f,{dense:"","no-gutters":"",class:"mb-2 mt-2"},{default:s(()=>[a(b,{modelValue:e(l).value.value,"onUpdate:modelValue":n[1]||(n[1]=o=>e(l).value.value=o),"error-messages":e(l).errorMessage.value,type:"password",density:"compact",variant:"outlined",label:e(t)("LoginView.password")},null,8,["modelValue","error-messages","label"])]),_:1}),a(f,{dense:"","no-gutters":"",class:"justify-end"},{default:s(()=>[a(_,{type:"submit",color:"primary",variant:"elevated"},{prepend:s(()=>[a(e(v),{icon:e(q)},null,8,["icon"])]),default:s(()=>[m(" "+c(e(t)("LoginView.login")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["title"])]))}}),ie=P(Y,[["__scopeId","data-v-4c1e2e7d"]]);export{ie as default};
//# sourceMappingURL=LoginView-PWPhMlSG.js.map
