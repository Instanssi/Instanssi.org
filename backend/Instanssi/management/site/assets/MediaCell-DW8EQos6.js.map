{"version":3,"file":"MediaCell-DW8EQos6.js","sources":["../../../../../admin/src/utils/media.ts","../../../../../admin/src/components/table/MediaCell.vue"],"sourcesContent":["/**\n * Shared media utilities for file type detection\n */\n\nexport const IMAGE_EXTENSIONS = [\"jpg\", \"jpeg\", \"png\", \"gif\", \"webp\", \"svg\", \"bmp\", \"ico\"];\nexport const VIDEO_EXTENSIONS = [\"mp4\", \"mkv\", \"webm\", \"avi\", \"mov\", \"wmv\", \"flv\", \"ogv\"];\nexport const AUDIO_EXTENSIONS = [\"mp3\", \"ogg\", \"opus\", \"aac\", \"wav\", \"flac\", \"m4a\", \"wma\"];\n\nexport type MediaType = \"image\" | \"video\" | \"audio\" | \"other\";\n\n/**\n * Extract filename from a URL\n * @param url - The URL to extract filename from\n * @returns The filename or null if extraction fails\n */\nexport function getFilenameFromUrl(url: string | null): string | null {\n    if (!url) return null;\n    try {\n        const pathname = new URL(url).pathname;\n        return pathname.split(\"/\").pop() || null;\n    } catch {\n        // If URL parsing fails, try to extract filename directly\n        return url.split(\"/\").pop()?.split(\"?\")[0] || null;\n    }\n}\n\n/**\n * Extract file extension from a filename\n * @param filename - The filename to extract extension from\n * @returns The lowercase extension or null if extraction fails\n */\nexport function getExtension(filename: string | null): string | null {\n    if (!filename) return null;\n    const ext = filename.split(\".\").pop()?.toLowerCase();\n    return ext || null;\n}\n\n/**\n * Detect media type from a URL based on file extension\n * @param url - The URL to detect media type for\n * @returns The detected media type\n */\nexport function detectMediaType(url: string | null): MediaType {\n    const filename = getFilenameFromUrl(url);\n    const ext = getExtension(filename);\n\n    if (!ext) return \"other\";\n\n    if (IMAGE_EXTENSIONS.includes(ext)) return \"image\";\n    if (VIDEO_EXTENSIONS.includes(ext)) return \"video\";\n    if (AUDIO_EXTENSIONS.includes(ext)) return \"audio\";\n\n    return \"other\";\n}\n","<template>\n    <div v-if=\"url\" class=\"media-cell\">\n        <!-- Image: thumbnail + preview dialog -->\n        <template v-if=\"mediaType === 'image'\">\n            <div\n                class=\"image-thumbnail\"\n                role=\"button\"\n                tabindex=\"0\"\n                :title=\"t('MediaCell.clickToPreview')\"\n                @click=\"showImagePreview = true\"\n                @keydown.enter=\"showImagePreview = true\"\n                @keydown.space.prevent=\"showImagePreview = true\"\n            >\n                <v-img :src=\"url\" :width=\"size\" :height=\"size\" cover class=\"rounded\" />\n            </div>\n\n            <v-dialog v-model=\"showImagePreview\" max-width=\"900\">\n                <v-card>\n                    <v-card-title class=\"d-flex justify-space-between align-center\">\n                        <span>{{ t(\"MediaCell.imagePreviewTitle\") }}</span>\n                        <v-btn\n                            icon\n                            variant=\"text\"\n                            density=\"compact\"\n                            @click=\"showImagePreview = false\"\n                        >\n                            <FontAwesomeIcon :icon=\"faXmark\" />\n                        </v-btn>\n                    </v-card-title>\n                    <v-divider />\n                    <v-card-text class=\"d-flex justify-center pa-4\">\n                        <v-img :src=\"url\" max-height=\"70vh\" max-width=\"100%\" />\n                    </v-card-text>\n                </v-card>\n            </v-dialog>\n        </template>\n\n        <!-- Video: play icon button + player dialog -->\n        <template v-else-if=\"mediaType === 'video'\">\n            <v-btn\n                icon\n                variant=\"text\"\n                size=\"small\"\n                :title=\"t('MediaCell.clickToPreview')\"\n                @click=\"showVideoPreview = true\"\n            >\n                <FontAwesomeIcon :icon=\"faCirclePlay\" size=\"lg\" />\n            </v-btn>\n\n            <v-dialog v-model=\"showVideoPreview\" max-width=\"900\">\n                <v-card>\n                    <v-card-title class=\"d-flex justify-space-between align-center\">\n                        <span>{{ t(\"MediaCell.videoPreviewTitle\") }}</span>\n                        <v-btn\n                            icon\n                            variant=\"text\"\n                            density=\"compact\"\n                            @click=\"showVideoPreview = false\"\n                        >\n                            <FontAwesomeIcon :icon=\"faXmark\" />\n                        </v-btn>\n                    </v-card-title>\n                    <v-divider />\n                    <v-card-text class=\"d-flex justify-center pa-4\">\n                        <video\n                            v-if=\"showVideoPreview\"\n                            :src=\"url\"\n                            controls\n                            autoplay\n                            class=\"video-player\"\n                        >\n                            {{ t(\"MediaCell.videoNotSupported\") }}\n                        </video>\n                    </v-card-text>\n                </v-card>\n            </v-dialog>\n        </template>\n\n        <!-- Audio: audio icon button + player dialog -->\n        <template v-else-if=\"mediaType === 'audio'\">\n            <v-btn\n                icon\n                variant=\"text\"\n                size=\"small\"\n                :title=\"t('MediaCell.clickToPreview')\"\n                @click=\"showAudioPreview = true\"\n            >\n                <FontAwesomeIcon :icon=\"faVolumeHigh\" size=\"lg\" />\n            </v-btn>\n\n            <v-dialog v-model=\"showAudioPreview\" max-width=\"500\">\n                <v-card>\n                    <v-card-title class=\"d-flex justify-space-between align-center\">\n                        <span>{{ t(\"MediaCell.audioPreviewTitle\") }}</span>\n                        <v-btn\n                            icon\n                            variant=\"text\"\n                            density=\"compact\"\n                            @click=\"showAudioPreview = false\"\n                        >\n                            <FontAwesomeIcon :icon=\"faXmark\" />\n                        </v-btn>\n                    </v-card-title>\n                    <v-divider />\n                    <v-card-text class=\"d-flex justify-center pa-4\">\n                        <audio\n                            v-if=\"showAudioPreview\"\n                            :src=\"url\"\n                            controls\n                            autoplay\n                            class=\"audio-player\"\n                        >\n                            {{ t(\"MediaCell.audioNotSupported\") }}\n                        </audio>\n                    </v-card-text>\n                </v-card>\n            </v-dialog>\n        </template>\n\n        <!-- Other: just download icon -->\n        <template v-else>\n            <FontAwesomeIcon :icon=\"faDownload\" class=\"other-icon ma-3\" />\n        </template>\n\n        <!-- Always show filename as download link -->\n        <a :href=\"url\" target=\"_blank\" class=\"filename-link\" :title=\"t('MediaCell.download')\">\n            {{ displayFilename }}\n        </a>\n    </div>\n    <span v-else>{{ fallback }}</span>\n</template>\n\n<script setup lang=\"ts\">\nimport { faCirclePlay, faDownload, faVolumeHigh, faXmark } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/vue-fontawesome\";\nimport { computed, ref } from \"vue\";\nimport { useI18n } from \"vue-i18n\";\n\nimport { detectMediaType, getFilenameFromUrl } from \"@/utils/media\";\n\nconst props = withDefaults(\n    defineProps<{\n        url: string | null;\n        filename?: string | null;\n        size?: number;\n        fallback?: string;\n    }>(),\n    {\n        filename: null,\n        size: 40,\n        fallback: \"-\",\n    }\n);\n\nconst { t } = useI18n();\nconst showImagePreview = ref(false);\nconst showVideoPreview = ref(false);\nconst showAudioPreview = ref(false);\n\nconst mediaType = computed(() => detectMediaType(props.url));\n\nconst displayFilename = computed(() => {\n    if (props.filename) return props.filename;\n    return getFilenameFromUrl(props.url) || props.url || \"\";\n});\n</script>\n\n<style scoped>\n.media-cell {\n    display: inline-flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.image-thumbnail {\n    cursor: pointer;\n    border-radius: 4px;\n    transition: opacity 0.2s;\n    flex-shrink: 0;\n    margin-top: 1px;\n    margin-bottom: 3px;\n}\n\n.image-thumbnail:hover {\n    opacity: 0.8;\n}\n\n.image-thumbnail:focus {\n    outline: 2px solid rgb(var(--v-theme-primary));\n    outline-offset: 1px;\n}\n\n.video-player {\n    max-width: 100%;\n    max-height: 70vh;\n}\n\n.audio-player {\n    width: 100%;\n    min-width: 300px;\n}\n\n.filename-link {\n    word-break: break-all;\n}\n\n.other-icon {\n    opacity: 0.7;\n}\n</style>\n"],"names":["IMAGE_EXTENSIONS","VIDEO_EXTENSIONS","AUDIO_EXTENSIONS","getFilenameFromUrl","url","getExtension","filename","detectMediaType","ext","props","__props","t","useI18n","showImagePreview","ref","showVideoPreview","showAudioPreview","mediaType","computed","displayFilename","_openBlock","_createElementBlock","_hoisted_1","_Fragment","_createElementVNode","_unref","_createVNode","_component_v_img","_component_v_dialog","$event","_component_v_card","_component_v_card_title","_component_v_btn","FontAwesomeIcon","faXmark","_component_v_divider","_component_v_card_text","faCirclePlay","_hoisted_3","faVolumeHigh","_hoisted_4","_createBlock","faDownload","_hoisted_5"],"mappings":"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"}