import{d as Ee,a as we,u as Ue,v as ke,ah as ye,ai as _e,o as Pe,aj as Fe,b as g,g as U,w as i,e as a,A as Te,p as Ie,B as xe,l as Me,j as e,i as v,t as p,m as u,c as Ce,F as he,D as Z,C as De,E as Se,V as ee,k as Oe,G as Be,s as b,I as k,H as $e}from"./index-CQkWvXOv.js";import{c as je,f as le,d as Ae,g as Ge,a as n,u as He,b as s}from"./index.esm-aFENq7CA.js";import{_ as Ne}from"./AuditLogButton.vue_vue_type_script_setup_true_lang-DHg2h5we.js";import{F as V}from"./FormSection-Drw9hFWe.js";import{I as ae}from"./ImageUploadField-CMHDwiai.js";import{V as d,_ as ze}from"./LayoutBase.vue_vue_type_script_setup_true_lang-D5aCeQDf.js";import{_ as re}from"./ToggleSwitch.vue_vue_type_script_setup_true_lang-C_s5Zpn8.js";import{t as te,a as oe}from"./datetime-Dz9fjSvq.js";import{t as ie,g as Re,p as qe}from"./formdata-0PwnLkt-.js";import{h as se}from"./http-CET7UDul.js";import{p as R}from"./parseInt-BJ5A4_3y.js";import{V as Le}from"./VForm-VvaADaOh.js";import{V as Je}from"./VTextarea-CQIJ1p3t.js";import{V as f}from"./VRow-CXIXhuhq.js";import"./_commonjsHelpers-CqkleIqs.js";import"./AuditLogDialog.vue_vue_type_script_setup_true_lang-1MnYozFL.js";import"./useAuditLogUtils-BdjF9k7b.js";import"./DateTimeCell.vue_vue_type_script_setup_true_lang-DaLynL44.js";import"./VDataTableServer-C6tuZDKn.js";import"./VDataTable-f5_9vewM.js";import"./VContainer-DqJ8gu3P.js";import"./VSwitch-JF6EcneO.js";const bl=Ee({__name:"ProgramEventEditView",props:{eventId:{},id:{}},setup(ne){const q={title:"title",description:"description",start:"start",end:"end",place:"place",presenters:"presenters",presenters_titles:"presentersTitles",icon_original:"icon1File",icon2_original:"icon2File",home_url:"homeUrl",email:"email",twitter_url:"twitterUrl",github_url:"githubUrl",facebook_url:"facebookUrl",linkedin_url:"linkedinUrl",wiki_url:"wikiUrl",event_type:"eventType",active:"active"},m=ne,{t}=we(),ue=Ue(),c=ke(),{getEventById:de}=$e(),y=b(!1),_=b(!1),L=b(""),E=k(()=>R(m.eventId,10)),w=k(()=>m.id!==void 0),J=b(null),K=b(null),P=k({get:()=>W.value.value===1,set:o=>{W.value.value=o?1:0}}),me=k(()=>{const o=[{title:de(E.value)?.name??"...",to:{name:"dashboard",params:{eventId:m.eventId}}},{title:t("ProgramEventsView.title"),to:{name:"program",params:{eventId:m.eventId}}}];return w.value?o.push({title:L.value||"...",disabled:!0}):o.push({title:t("Breadcrumbs.newProgramEvent"),disabled:!0}),o}),ve=je({title:n().required().min(1).max(64),description:n(),start:n().required(),end:n().nullable(),place:n().max(64),presenters:n().max(256),presentersTitles:n().max(256),homeUrl:n().url().max(255),email:n().email().max(128),twitterUrl:n().url().max(255),githubUrl:n().url().max(255),facebookUrl:n().url().max(255),linkedinUrl:n().url().max(255),wikiUrl:n().url().max(255),eventType:Ge().oneOf([0,1]),active:Ae(),icon1File:le().nullable(),icon2File:le().nullable()}),{handleSubmit:pe,setValues:ce,setErrors:Q,meta:ge}=He({validationSchema:ve,initialValues:{title:"",description:"",start:"",end:"",place:"",presenters:"",presentersTitles:"",homeUrl:"",email:"",twitterUrl:"",githubUrl:"",facebookUrl:"",linkedinUrl:"",wikiUrl:"",eventType:0,active:!0,icon1File:void 0,icon2File:void 0}}),F=s("title"),T=s("description"),I=s("start"),x=s("end"),M=s("place"),C=s("presenters"),h=s("presentersTitles"),D=s("homeUrl"),S=s("email"),O=s("twitterUrl"),B=s("githubUrl"),$=s("facebookUrl"),j=s("linkedinUrl"),A=s("wikiUrl"),W=s("eventType"),G=s("active"),H=s("icon1File"),N=s("icon2File"),X=pe(async o=>{_.value=!0;let l;w.value?l=await Ve(R(m.id,10),o):l=await be(o),_.value=!1,l&&z()});function Y(o,l){const r=l?Re:qe;return{title:o.title,description:o.description||"",start:oe(o.start),end:oe(o.end),place:o.place||"",presenters:o.presenters||"",presenters_titles:o.presentersTitles||"",home_url:o.homeUrl||"",email:o.email||"",twitter_url:o.twitterUrl||"",github_url:o.githubUrl||"",facebook_url:o.facebookUrl||"",linkedin_url:o.linkedinUrl||"",wiki_url:o.wikiUrl||"",event_type:o.eventType??0,active:o.active,icon_original:r(o.icon1File),icon2_original:r(o.icon2File)}}async function be(o){const l=Y(o,!0);try{return await ye({path:{event_pk:E.value},body:l,bodySerializer:()=>ie(l)}),c.success(t("ProgramEventEditView.createSuccess")),!0}catch(r){se(r,Q,c,t("ProgramEventEditView.createFailure"),q)}return!1}async function Ve(o,l){const r=Y(l,!1);try{return await _e({path:{event_pk:E.value,id:o},body:r,bodySerializer:()=>ie(r)}),c.success(t("ProgramEventEditView.editSuccess")),!0}catch(fe){se(fe,Q,c,t("ProgramEventEditView.editFailure"),q)}return!1}function z(){ue.push({name:"program",params:{eventId:m.eventId}})}return Pe(async()=>{if(w.value){y.value=!0;try{const l=(await Fe({path:{event_pk:E.value,id:R(m.id,10)}})).data;L.value=l.title,J.value=l.icon_small_url??null,K.value=l.icon2_small_url??null,ce({title:l.title,description:l.description??"",start:te(l.start),end:te(l.end),place:l.place??"",presenters:l.presenters??"",presentersTitles:l.presenters_titles??"",homeUrl:l.home_url??"",email:l.email??"",twitterUrl:l.twitter_url??"",githubUrl:l.github_url??"",facebookUrl:l.facebook_url??"",linkedinUrl:l.linkedin_url??"",wikiUrl:l.wiki_url??"",eventType:l.event_type??0,active:l.active??!0})}catch(o){c.error(t("ProgramEventEditView.loadFailure")),console.error(o),z()}finally{y.value=!1}}}),(o,l)=>(g(),U(ze,{breadcrumbs:me.value},{default:i(()=>[y.value?(g(),U(d,{key:0,class:"d-flex justify-center my-8"},{default:i(()=>[a(Te,{indeterminate:"",size:"64"})]),_:1})):(g(),U(d,{key:1},{default:i(()=>[a(Ie,null,{default:i(()=>[a(xe,null,{default:i(()=>[a(Le,{onSubmit:Me(e(X),["prevent"])},{default:i(()=>[a(V,null,{default:i(()=>[v(p(e(t)("ProgramEventEditView.sections.basic")),1)]),_:1}),a(u,{modelValue:e(F).value.value,"onUpdate:modelValue":l[0]||(l[0]=r=>e(F).value.value=r),"error-messages":e(F).errorMessage.value,variant:"outlined",label:e(t)("ProgramEventEditView.labels.title")+" *"},null,8,["modelValue","error-messages","label"]),a(Je,{modelValue:e(T).value.value,"onUpdate:modelValue":l[1]||(l[1]=r=>e(T).value.value=r),"error-messages":e(T).errorMessage.value,variant:"outlined",label:e(t)("ProgramEventEditView.labels.description"),rows:"4"},null,8,["modelValue","error-messages","label"]),a(f,null,{default:i(()=>[a(d,{cols:"12",md:"6"},{default:i(()=>[a(u,{modelValue:e(I).value.value,"onUpdate:modelValue":l[2]||(l[2]=r=>e(I).value.value=r),type:"datetime-local","error-messages":e(I).errorMessage.value,variant:"outlined",label:e(t)("ProgramEventEditView.labels.start")+" *"},null,8,["modelValue","error-messages","label"])]),_:1}),a(d,{cols:"12",md:"6"},{default:i(()=>[a(u,{modelValue:e(x).value.value,"onUpdate:modelValue":l[3]||(l[3]=r=>e(x).value.value=r),type:"datetime-local","error-messages":e(x).errorMessage.value,variant:"outlined",label:e(t)("ProgramEventEditView.labels.end")},null,8,["modelValue","error-messages","label"])]),_:1})]),_:1}),a(u,{modelValue:e(M).value.value,"onUpdate:modelValue":l[4]||(l[4]=r=>e(M).value.value=r),"error-messages":e(M).errorMessage.value,variant:"outlined",label:e(t)("ProgramEventEditView.labels.place")},null,8,["modelValue","error-messages","label"]),P.value?(g(),Ce(he,{key:0},[a(V,null,{default:i(()=>[v(p(e(t)("ProgramEventEditView.sections.presenters")),1)]),_:1}),a(u,{modelValue:e(C).value.value,"onUpdate:modelValue":l[5]||(l[5]=r=>e(C).value.value=r),"error-messages":e(C).errorMessage.value,variant:"outlined",label:e(t)("ProgramEventEditView.labels.presenters")},null,8,["modelValue","error-messages","label"]),a(u,{modelValue:e(h).value.value,"onUpdate:modelValue":l[6]||(l[6]=r=>e(h).value.value=r),"error-messages":e(h).errorMessage.value,variant:"outlined",label:e(t)("ProgramEventEditView.labels.presentersTitles")},null,8,["modelValue","error-messages","label"]),a(V,null,{default:i(()=>[v(p(e(t)("ProgramEventEditView.sections.images")),1)]),_:1}),a(f,null,{default:i(()=>[a(d,{cols:"12",md:"6"},{default:i(()=>[a(ae,{modelValue:e(H).value.value,"onUpdate:modelValue":l[7]||(l[7]=r=>e(H).value.value=r),"current-image-url":J.value,label:e(t)("ProgramEventEditView.labels.icon1"),"error-message":e(H).errorMessage.value},null,8,["modelValue","current-image-url","label","error-message"])]),_:1}),a(d,{cols:"12",md:"6"},{default:i(()=>[a(ae,{modelValue:e(N).value.value,"onUpdate:modelValue":l[8]||(l[8]=r=>e(N).value.value=r),"current-image-url":K.value,label:e(t)("ProgramEventEditView.labels.icon2"),"error-message":e(N).errorMessage.value},null,8,["modelValue","current-image-url","label","error-message"])]),_:1})]),_:1}),a(V,null,{default:i(()=>[v(p(e(t)("ProgramEventEditView.sections.links")),1)]),_:1}),a(f,null,{default:i(()=>[a(d,{cols:"12",md:"6"},{default:i(()=>[a(u,{modelValue:e(D).value.value,"onUpdate:modelValue":l[9]||(l[9]=r=>e(D).value.value=r),"error-messages":e(D).errorMessage.value,variant:"outlined",label:e(t)("ProgramEventEditView.labels.homeUrl"),type:"url"},null,8,["modelValue","error-messages","label"])]),_:1}),a(d,{cols:"12",md:"6"},{default:i(()=>[a(u,{modelValue:e(S).value.value,"onUpdate:modelValue":l[10]||(l[10]=r=>e(S).value.value=r),"error-messages":e(S).errorMessage.value,variant:"outlined",label:e(t)("ProgramEventEditView.labels.email"),type:"email"},null,8,["modelValue","error-messages","label"])]),_:1})]),_:1}),a(f,null,{default:i(()=>[a(d,{cols:"12",md:"6"},{default:i(()=>[a(u,{modelValue:e(O).value.value,"onUpdate:modelValue":l[11]||(l[11]=r=>e(O).value.value=r),"error-messages":e(O).errorMessage.value,variant:"outlined",label:e(t)("ProgramEventEditView.labels.twitterUrl"),type:"url"},null,8,["modelValue","error-messages","label"])]),_:1}),a(d,{cols:"12",md:"6"},{default:i(()=>[a(u,{modelValue:e(B).value.value,"onUpdate:modelValue":l[12]||(l[12]=r=>e(B).value.value=r),"error-messages":e(B).errorMessage.value,variant:"outlined",label:e(t)("ProgramEventEditView.labels.githubUrl"),type:"url"},null,8,["modelValue","error-messages","label"])]),_:1})]),_:1}),a(f,null,{default:i(()=>[a(d,{cols:"12",md:"6"},{default:i(()=>[a(u,{modelValue:e($).value.value,"onUpdate:modelValue":l[13]||(l[13]=r=>e($).value.value=r),"error-messages":e($).errorMessage.value,variant:"outlined",label:e(t)("ProgramEventEditView.labels.facebookUrl"),type:"url"},null,8,["modelValue","error-messages","label"])]),_:1}),a(d,{cols:"12",md:"6"},{default:i(()=>[a(u,{modelValue:e(j).value.value,"onUpdate:modelValue":l[14]||(l[14]=r=>e(j).value.value=r),"error-messages":e(j).errorMessage.value,variant:"outlined",label:e(t)("ProgramEventEditView.labels.linkedinUrl"),type:"url"},null,8,["modelValue","error-messages","label"])]),_:1})]),_:1}),a(u,{modelValue:e(A).value.value,"onUpdate:modelValue":l[15]||(l[15]=r=>e(A).value.value=r),"error-messages":e(A).errorMessage.value,variant:"outlined",label:e(t)("ProgramEventEditView.labels.wikiUrl"),type:"url"},null,8,["modelValue","error-messages","label"])],64)):Z("",!0),a(V,null,{default:i(()=>[v(p(e(t)("ProgramEventEditView.sections.settings")),1)]),_:1}),a(re,{modelValue:P.value,"onUpdate:modelValue":l[16]||(l[16]=r=>P.value=r),"label-on":e(t)("ProgramEventEditView.labels.eventTypeDetailedOn"),"label-off":e(t)("ProgramEventEditView.labels.eventTypeDetailedOff"),"hint-on":e(t)("ProgramEventEditView.labels.eventTypeDetailedHintOn"),"hint-off":e(t)("ProgramEventEditView.labels.eventTypeDetailedHintOff")},null,8,["modelValue","label-on","label-off","hint-on","hint-off"]),a(re,{modelValue:e(G).value.value,"onUpdate:modelValue":l[17]||(l[17]=r=>e(G).value.value=r),"error-message":e(G).errorMessage.value,"label-on":e(t)("ProgramEventEditView.labels.activeOn"),"label-off":e(t)("ProgramEventEditView.labels.activeOff"),"hint-on":e(t)("ProgramEventEditView.labels.activeHintOn"),"hint-off":e(t)("ProgramEventEditView.labels.activeHintOff")},null,8,["modelValue","error-message","label-on","label-off","hint-on","hint-off"])]),_:1},8,["onSubmit"])]),_:1}),a(De,{class:"justify-end"},{default:i(()=>[w.value?(g(),U(Ne,{key:0,"app-label":"ext_programme",model:"programmeevent","object-pk":m.id},null,8,["object-pk"])):Z("",!0),a(Se),a(ee,{variant:"text",onClick:z},{default:i(()=>[v(p(e(t)("General.cancel")),1)]),_:1}),a(ee,{variant:"elevated",color:"primary",loading:_.value,disabled:!e(ge).valid,onClick:e(X)},{prepend:i(()=>[a(e(Oe),{icon:e(Be)},null,8,["icon"])]),default:i(()=>[v(" "+p(e(t)("General.save")),1)]),_:1},8,["loading","disabled","onClick"])]),_:1})]),_:1})]),_:1}))]),_:1},8,["breadcrumbs"]))}});export{bl as default};
//# sourceMappingURL=ProgramEventEditView-BRteaYn_.js.map
