import{d as fe,a as Ee,u as we,v as Ue,a5 as ke,a6 as ye,o as Pe,a7 as _e,b as E,g as z,w as i,e as a,A as Fe,p as Te,B as Ie,l as Me,j as e,i as v,t as p,m as u,c as xe,F as Ce,K as De,C as he,V as Z,k as Se,D as Oe,s as g,G as w,E as Be}from"./index-qrfwdmHz.js";import{c as $e,f as ee,d as Ae,g as Ge,a as n,u as He,b as s,V as Ne}from"./index.esm-BpR9m2gH.js";import{F as b}from"./FormSection-GyinszpZ.js";import{I as le}from"./ImageUploadField-BSeTtGYW.js";import{V as d,_ as je}from"./LayoutBase.vue_vue_type_script_setup_true_lang-Cgp8Musd.js";import{_ as ae}from"./ToggleSwitch.vue_vue_type_script_setup_true_lang-BaRBjAD0.js";import{t as te,a as re}from"./datetime-DsxOZgAd.js";import{t as oe,g as ze,p as Re}from"./formdata-DVnEsizw.js";import{h as ie}from"./http-Cqy_sGiB.js";import{p as R}from"./parseInt-CGa1F4cm.js";import{V as qe}from"./VTextarea-CedNBKzo.js";import{V}from"./VRow-EkiCBxID.js";import"./VContainer-e74dHNZG.js";import"./VSwitch-eDN7lqDz.js";import"./classApi-bnmGQydb.js";const sl=fe({__name:"ProgramEventEditView",props:{eventId:{},id:{}},setup(se){const q={title:"title",description:"description",start:"start",end:"end",place:"place",presenters:"presenters",presenters_titles:"presentersTitles",icon_original:"icon1File",icon2_original:"icon2File",home_url:"homeUrl",email:"email",twitter_url:"twitterUrl",github_url:"githubUrl",facebook_url:"facebookUrl",linkedin_url:"linkedinUrl",wiki_url:"wikiUrl",event_type:"eventType",active:"active"},m=se,{t:r}=Ee(),ne=we(),c=Ue(),{getEventById:ue}=Be(),U=g(!1),k=g(!1),L=g(""),f=w(()=>R(m.eventId,10)),y=w(()=>m.id!==void 0),K=g(null),J=g(null),P=w({get:()=>W.value.value===1,set:o=>{W.value.value=o?1:0}}),de=w(()=>{const o=[{title:ue(f.value)?.name??"...",to:{name:"dashboard",params:{eventId:m.eventId}}},{title:r("ProgramEventsView.title"),to:{name:"program",params:{eventId:m.eventId}}}];return y.value?o.push({title:L.value||"...",disabled:!0}):o.push({title:r("Breadcrumbs.newProgramEvent"),disabled:!0}),o}),me=$e({title:n().required().min(1).max(64),description:n(),start:n().required(),end:n().nullable(),place:n().max(64),presenters:n().max(256),presentersTitles:n().max(256),homeUrl:n().url().max(255),email:n().email().max(128),twitterUrl:n().url().max(255),githubUrl:n().url().max(255),facebookUrl:n().url().max(255),linkedinUrl:n().url().max(255),wikiUrl:n().url().max(255),eventType:Ge().oneOf([0,1]),active:Ae(),icon1File:ee().nullable(),icon2File:ee().nullable()}),{handleSubmit:ve,setValues:pe,setErrors:Q,meta:ce}=He({validationSchema:me,initialValues:{title:"",description:"",start:"",end:"",place:"",presenters:"",presentersTitles:"",homeUrl:"",email:"",twitterUrl:"",githubUrl:"",facebookUrl:"",linkedinUrl:"",wikiUrl:"",eventType:0,active:!0,icon1File:void 0,icon2File:void 0}}),_=s("title"),F=s("description"),T=s("start"),I=s("end"),M=s("place"),x=s("presenters"),C=s("presentersTitles"),D=s("homeUrl"),h=s("email"),S=s("twitterUrl"),O=s("githubUrl"),B=s("facebookUrl"),$=s("linkedinUrl"),A=s("wikiUrl"),W=s("eventType"),G=s("active"),H=s("icon1File"),N=s("icon2File"),X=ve(async o=>{k.value=!0;let l;y.value?l=await be(R(m.id,10),o):l=await ge(o),k.value=!1,l&&j()});function Y(o,l){const t=l?ze:Re;return{title:o.title,description:o.description||"",start:re(o.start),end:re(o.end),place:o.place||"",presenters:o.presenters||"",presenters_titles:o.presentersTitles||"",home_url:o.homeUrl||"",email:o.email||"",twitter_url:o.twitterUrl||"",github_url:o.githubUrl||"",facebook_url:o.facebookUrl||"",linkedin_url:o.linkedinUrl||"",wiki_url:o.wikiUrl||"",event_type:o.eventType??0,active:o.active,icon_original:t(o.icon1File),icon2_original:t(o.icon2File)}}async function ge(o){const l=Y(o,!0);try{return await ke({path:{event_pk:f.value},body:l,bodySerializer:()=>oe(l)}),c.success(r("ProgramEventEditView.createSuccess")),!0}catch(t){ie(t,Q,c,r("ProgramEventEditView.createFailure"),q)}return!1}async function be(o,l){const t=Y(l,!1);try{return await ye({path:{event_pk:f.value,id:o},body:t,bodySerializer:()=>oe(t)}),c.success(r("ProgramEventEditView.editSuccess")),!0}catch(Ve){ie(Ve,Q,c,r("ProgramEventEditView.editFailure"),q)}return!1}function j(){ne.push({name:"program",params:{eventId:m.eventId}})}return Pe(async()=>{if(y.value){U.value=!0;try{const l=(await _e({path:{event_pk:f.value,id:R(m.id,10)}})).data;L.value=l.title,K.value=l.icon_small_url??null,J.value=l.icon2_small_url??null,pe({title:l.title,description:l.description??"",start:te(l.start),end:te(l.end),place:l.place??"",presenters:l.presenters??"",presentersTitles:l.presenters_titles??"",homeUrl:l.home_url??"",email:l.email??"",twitterUrl:l.twitter_url??"",githubUrl:l.github_url??"",facebookUrl:l.facebook_url??"",linkedinUrl:l.linkedin_url??"",wikiUrl:l.wiki_url??"",eventType:l.event_type??0,active:l.active??!0})}catch(o){c.error(r("ProgramEventEditView.loadFailure")),console.error(o),j()}finally{U.value=!1}}}),(o,l)=>(E(),z(je,{breadcrumbs:de.value},{default:i(()=>[U.value?(E(),z(d,{key:0,class:"d-flex justify-center my-8"},{default:i(()=>[a(Fe,{indeterminate:"",size:"64"})]),_:1})):(E(),z(d,{key:1},{default:i(()=>[a(Te,null,{default:i(()=>[a(Ie,null,{default:i(()=>[a(Ne,{onSubmit:Me(e(X),["prevent"])},{default:i(()=>[a(b,null,{default:i(()=>[v(p(e(r)("ProgramEventEditView.sections.basic")),1)]),_:1}),a(u,{modelValue:e(_).value.value,"onUpdate:modelValue":l[0]||(l[0]=t=>e(_).value.value=t),"error-messages":e(_).errorMessage.value,variant:"outlined",label:e(r)("ProgramEventEditView.labels.title")+" *"},null,8,["modelValue","error-messages","label"]),a(qe,{modelValue:e(F).value.value,"onUpdate:modelValue":l[1]||(l[1]=t=>e(F).value.value=t),"error-messages":e(F).errorMessage.value,variant:"outlined",label:e(r)("ProgramEventEditView.labels.description"),rows:"4"},null,8,["modelValue","error-messages","label"]),a(V,null,{default:i(()=>[a(d,{cols:"12",md:"6"},{default:i(()=>[a(u,{modelValue:e(T).value.value,"onUpdate:modelValue":l[2]||(l[2]=t=>e(T).value.value=t),type:"datetime-local","error-messages":e(T).errorMessage.value,variant:"outlined",label:e(r)("ProgramEventEditView.labels.start")+" *"},null,8,["modelValue","error-messages","label"])]),_:1}),a(d,{cols:"12",md:"6"},{default:i(()=>[a(u,{modelValue:e(I).value.value,"onUpdate:modelValue":l[3]||(l[3]=t=>e(I).value.value=t),type:"datetime-local","error-messages":e(I).errorMessage.value,variant:"outlined",label:e(r)("ProgramEventEditView.labels.end")},null,8,["modelValue","error-messages","label"])]),_:1})]),_:1}),a(u,{modelValue:e(M).value.value,"onUpdate:modelValue":l[4]||(l[4]=t=>e(M).value.value=t),"error-messages":e(M).errorMessage.value,variant:"outlined",label:e(r)("ProgramEventEditView.labels.place")},null,8,["modelValue","error-messages","label"]),P.value?(E(),xe(Ce,{key:0},[a(b,null,{default:i(()=>[v(p(e(r)("ProgramEventEditView.sections.presenters")),1)]),_:1}),a(u,{modelValue:e(x).value.value,"onUpdate:modelValue":l[5]||(l[5]=t=>e(x).value.value=t),"error-messages":e(x).errorMessage.value,variant:"outlined",label:e(r)("ProgramEventEditView.labels.presenters")},null,8,["modelValue","error-messages","label"]),a(u,{modelValue:e(C).value.value,"onUpdate:modelValue":l[6]||(l[6]=t=>e(C).value.value=t),"error-messages":e(C).errorMessage.value,variant:"outlined",label:e(r)("ProgramEventEditView.labels.presentersTitles")},null,8,["modelValue","error-messages","label"]),a(b,null,{default:i(()=>[v(p(e(r)("ProgramEventEditView.sections.images")),1)]),_:1}),a(V,null,{default:i(()=>[a(d,{cols:"12",md:"6"},{default:i(()=>[a(le,{modelValue:e(H).value.value,"onUpdate:modelValue":l[7]||(l[7]=t=>e(H).value.value=t),"current-image-url":K.value,label:e(r)("ProgramEventEditView.labels.icon1"),"error-message":e(H).errorMessage.value},null,8,["modelValue","current-image-url","label","error-message"])]),_:1}),a(d,{cols:"12",md:"6"},{default:i(()=>[a(le,{modelValue:e(N).value.value,"onUpdate:modelValue":l[8]||(l[8]=t=>e(N).value.value=t),"current-image-url":J.value,label:e(r)("ProgramEventEditView.labels.icon2"),"error-message":e(N).errorMessage.value},null,8,["modelValue","current-image-url","label","error-message"])]),_:1})]),_:1}),a(b,null,{default:i(()=>[v(p(e(r)("ProgramEventEditView.sections.links")),1)]),_:1}),a(V,null,{default:i(()=>[a(d,{cols:"12",md:"6"},{default:i(()=>[a(u,{modelValue:e(D).value.value,"onUpdate:modelValue":l[9]||(l[9]=t=>e(D).value.value=t),"error-messages":e(D).errorMessage.value,variant:"outlined",label:e(r)("ProgramEventEditView.labels.homeUrl"),type:"url"},null,8,["modelValue","error-messages","label"])]),_:1}),a(d,{cols:"12",md:"6"},{default:i(()=>[a(u,{modelValue:e(h).value.value,"onUpdate:modelValue":l[10]||(l[10]=t=>e(h).value.value=t),"error-messages":e(h).errorMessage.value,variant:"outlined",label:e(r)("ProgramEventEditView.labels.email"),type:"email"},null,8,["modelValue","error-messages","label"])]),_:1})]),_:1}),a(V,null,{default:i(()=>[a(d,{cols:"12",md:"6"},{default:i(()=>[a(u,{modelValue:e(S).value.value,"onUpdate:modelValue":l[11]||(l[11]=t=>e(S).value.value=t),"error-messages":e(S).errorMessage.value,variant:"outlined",label:e(r)("ProgramEventEditView.labels.twitterUrl"),type:"url"},null,8,["modelValue","error-messages","label"])]),_:1}),a(d,{cols:"12",md:"6"},{default:i(()=>[a(u,{modelValue:e(O).value.value,"onUpdate:modelValue":l[12]||(l[12]=t=>e(O).value.value=t),"error-messages":e(O).errorMessage.value,variant:"outlined",label:e(r)("ProgramEventEditView.labels.githubUrl"),type:"url"},null,8,["modelValue","error-messages","label"])]),_:1})]),_:1}),a(V,null,{default:i(()=>[a(d,{cols:"12",md:"6"},{default:i(()=>[a(u,{modelValue:e(B).value.value,"onUpdate:modelValue":l[13]||(l[13]=t=>e(B).value.value=t),"error-messages":e(B).errorMessage.value,variant:"outlined",label:e(r)("ProgramEventEditView.labels.facebookUrl"),type:"url"},null,8,["modelValue","error-messages","label"])]),_:1}),a(d,{cols:"12",md:"6"},{default:i(()=>[a(u,{modelValue:e($).value.value,"onUpdate:modelValue":l[14]||(l[14]=t=>e($).value.value=t),"error-messages":e($).errorMessage.value,variant:"outlined",label:e(r)("ProgramEventEditView.labels.linkedinUrl"),type:"url"},null,8,["modelValue","error-messages","label"])]),_:1})]),_:1}),a(u,{modelValue:e(A).value.value,"onUpdate:modelValue":l[15]||(l[15]=t=>e(A).value.value=t),"error-messages":e(A).errorMessage.value,variant:"outlined",label:e(r)("ProgramEventEditView.labels.wikiUrl"),type:"url"},null,8,["modelValue","error-messages","label"])],64)):De("",!0),a(b,null,{default:i(()=>[v(p(e(r)("ProgramEventEditView.sections.settings")),1)]),_:1}),a(ae,{modelValue:P.value,"onUpdate:modelValue":l[16]||(l[16]=t=>P.value=t),"label-on":e(r)("ProgramEventEditView.labels.eventTypeDetailedOn"),"label-off":e(r)("ProgramEventEditView.labels.eventTypeDetailedOff"),"hint-on":e(r)("ProgramEventEditView.labels.eventTypeDetailedHintOn"),"hint-off":e(r)("ProgramEventEditView.labels.eventTypeDetailedHintOff")},null,8,["modelValue","label-on","label-off","hint-on","hint-off"]),a(ae,{modelValue:e(G).value.value,"onUpdate:modelValue":l[17]||(l[17]=t=>e(G).value.value=t),"error-message":e(G).errorMessage.value,"label-on":e(r)("ProgramEventEditView.labels.activeOn"),"label-off":e(r)("ProgramEventEditView.labels.activeOff"),"hint-on":e(r)("ProgramEventEditView.labels.activeHintOn"),"hint-off":e(r)("ProgramEventEditView.labels.activeHintOff")},null,8,["modelValue","error-message","label-on","label-off","hint-on","hint-off"])]),_:1},8,["onSubmit"])]),_:1}),a(he,{class:"justify-end"},{default:i(()=>[a(Z,{variant:"text",onClick:j},{default:i(()=>[v(p(e(r)("General.cancel")),1)]),_:1}),a(Z,{variant:"elevated",color:"primary",loading:k.value,disabled:!e(ce).valid,onClick:e(X)},{prepend:i(()=>[a(e(Se),{icon:e(Oe)},null,8,["icon"])]),default:i(()=>[v(" "+p(e(r)("General.save")),1)]),_:1},8,["loading","disabled","onClick"])]),_:1})]),_:1})]),_:1}))]),_:1},8,["breadcrumbs"]))}});export{sl as default};
//# sourceMappingURL=ProgramEventEditView-DW5wwv4T.js.map
