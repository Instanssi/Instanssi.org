import{d as N,a as G,b as s,c as u,j as e,e as l,ad as Y,k as f,D as d,I as V,_ as Z,u as ee,J as te,K as ae,v as le,U as S,g as D,w as n,P as E,V as re,i as A,t as $,L as ne,m as ie,a3 as se,q as oe,s as m,ae as ce,af as ue,H as me}from"./index-DXU74lGt.js";import{_ as de}from"./BooleanIcon.vue_vue_type_script_setup_true_lang-CqjGGkAi.js";import{_ as R}from"./DateTimeCell.vue_vue_type_script_setup_true_lang-BMnBYvTq.js";import{I as B}from"./ImageCell-DJVG8mod.js";import{V as F,_ as ve}from"./LayoutBase.vue_vue_type_script_setup_true_lang-D4jd1chv.js";import{c as fe,f as ge,d as ke,e as pe,g as he}from"./index-DW3SUbXG.js";import{_ as _e}from"./TableActionButtons.vue_vue_type_script_setup_true_lang-CUVfxWfg.js";import{g as be}from"./query_tools-BInV9OzK.js";import{g as we}from"./http-BTZWMaMN.js";import{d as ye}from"./debounce-CQ84CrOG.js";import{V as M}from"./VRow-B94Tto0H.js";import{V as Ee}from"./VDataTableServer-CMLVDy59.js";import{p as Ve}from"./parseInt-Bzw_2rWL.js";import"./datetime-Dz9fjSvq.js";import"./VContainer-BfWqa_tJ.js";import"./AuditLogDialog.vue_vue_type_script_setup_true_lang-WkXOSlqa.js";import"./useAuditLogUtils-BqNOieoY.js";import"./VDataTable-Jd7io3gq.js";const Pe={class:"social-links-cell"},Ue=["href","title"],Ie=["href","title"],xe=["href","title"],Le=["href","title"],Ce=["href","title"],Te=["href","title"],Se={key:6,class:"no-links"},De=N({__name:"SocialLinksCell",props:{homeUrl:{},twitterUrl:{},githubUrl:{},facebookUrl:{},linkedinUrl:{},wikiUrl:{}},setup(r){const o=r,{t}=G(),k=V(()=>!!(o.homeUrl||o.twitterUrl||o.githubUrl||o.facebookUrl||o.linkedinUrl||o.wikiUrl));return(P,p)=>(s(),u("div",Pe,[r.homeUrl?(s(),u("a",{key:0,href:r.homeUrl,target:"_blank",class:"social-link",title:e(t)("SocialLinksCell.home")},[l(e(f),{icon:e(Y)},null,8,["icon"])],8,Ue)):d("",!0),r.twitterUrl?(s(),u("a",{key:1,href:r.twitterUrl,target:"_blank",class:"social-link",title:e(t)("SocialLinksCell.twitter")},[l(e(f),{icon:e(fe)},null,8,["icon"])],8,Ie)):d("",!0),r.githubUrl?(s(),u("a",{key:2,href:r.githubUrl,target:"_blank",class:"social-link",title:e(t)("SocialLinksCell.github")},[l(e(f),{icon:e(ge)},null,8,["icon"])],8,xe)):d("",!0),r.facebookUrl?(s(),u("a",{key:3,href:r.facebookUrl,target:"_blank",class:"social-link",title:e(t)("SocialLinksCell.facebook")},[l(e(f),{icon:e(ke)},null,8,["icon"])],8,Le)):d("",!0),r.linkedinUrl?(s(),u("a",{key:4,href:r.linkedinUrl,target:"_blank",class:"social-link",title:e(t)("SocialLinksCell.linkedin")},[l(e(f),{icon:e(pe)},null,8,["icon"])],8,Ce)):d("",!0),r.wikiUrl?(s(),u("a",{key:5,href:r.wikiUrl,target:"_blank",class:"social-link",title:e(t)("SocialLinksCell.wikipedia")},[l(e(f),{icon:e(he)},null,8,["icon"])],8,Te)):d("",!0),k.value?d("",!0):(s(),u("span",Se,"-"))]))}}),Ae=Z(De,[["__scopeId","data-v-352bfabc"]]),Ze=N({__name:"ProgramEventsView",props:{eventId:{}},setup(r){const o=r,{t}=G(),k=ee(),P=te(ae),p=le(),_=oe(),{getEventById:O}=me(),v=V(()=>Ve(o.eventId,10)),b=m(!1),j=V(()=>[{title:O(v.value)?.name??"...",to:{name:"dashboard",params:{eventId:o.eventId}}},{title:t("ProgramEventsView.title"),disabled:!0}]),U=[25,50,100],w=m(U[0]),I=m(0),q=m(1),x=m([]),h=m(""),g=m(null),y=m(null),H=[{title:t("ProgramEventsView.eventTypes.0"),value:0},{title:t("ProgramEventsView.eventTypes.1"),value:1}],K=[{title:t("ProgramEventsView.headers.id"),sortable:!0,key:"id"},{title:t("ProgramEventsView.headers.icon"),sortable:!1,key:"icon_small_url",width:60},{title:t("ProgramEventsView.headers.icon2"),sortable:!1,key:"icon2_small_url",width:60},{title:t("ProgramEventsView.headers.title"),sortable:!1,key:"title"},{title:t("ProgramEventsView.headers.start"),sortable:!0,key:"start"},{title:t("ProgramEventsView.headers.end"),sortable:!0,key:"end"},{title:t("ProgramEventsView.headers.place"),sortable:!1,key:"place"},{title:t("ProgramEventsView.headers.socialLinks"),sortable:!1,key:"social_links"},{title:t("ProgramEventsView.headers.eventType"),sortable:!1,key:"event_type"},{title:t("ProgramEventsView.headers.active"),sortable:!1,key:"active"},{title:t("ProgramEventsView.headers.actions"),sortable:!1,key:"actions",align:"end"}];function L(){y.value&&C(y.value)}async function C(c){b.value=!0,y.value=c;try{const i=await ue({path:{event_pk:v.value},query:{...be(c),...g.value!==null?{event_type:g.value}:{}}});x.value=i.data.results,I.value=i.data.count}catch(i){p.error(t("ProgramEventsView.loadFailure")),console.error(i)}finally{b.value=!1}}const T=ye(C,250);S(g,()=>{L()});function W(){g.value=null,h.value="",T({page:1,itemsPerPage:w.value??25,sortBy:[],groupBy:[],search:""})}S(v,W);async function z(c){const i=t("ProgramEventsView.confirmDelete",c);await P.value.ifConfirmed(i,async()=>{try{await ce({path:{event_pk:v.value,id:c.id}}),p.success(t("ProgramEventsView.deleteSuccess")),L()}catch(a){p.error(we(a,t("ProgramEventsView.deleteFailure"))),console.error(a)}})}function J(c){k.push({name:"program-edit",params:{eventId:v.value,id:c}})}function X(){k.push({name:"program-new",params:{eventId:v.value}})}return(c,i)=>(s(),D(ve,{key:`program-${v.value}`,breadcrumbs:j.value},{default:n(()=>[l(F,null,{default:n(()=>[l(M,null,{default:n(()=>[e(_).canAdd(e(E).PROGRAMME_EVENT)?(s(),D(re,{key:0,color:"primary",onClick:X},{prepend:n(()=>[l(e(f),{icon:e(ne)},null,8,["icon"])]),default:n(()=>[A(" "+$(e(t)("ProgramEventsView.newProgramEvent")),1)]),_:1})):d("",!0),l(ie,{modelValue:h.value,"onUpdate:modelValue":i[0]||(i[0]=a=>h.value=a),variant:"outlined",density:"compact",label:e(t)("General.search"),style:{"max-width":"400px"},class:"ma-0 pa-0 ml-4",clearable:""},null,8,["modelValue","label"]),l(se,{modelValue:g.value,"onUpdate:modelValue":i[1]||(i[1]=a=>g.value=a),variant:"outlined",density:"compact",label:e(t)("ProgramEventsView.filterEventType"),items:H,style:{"max-width":"200px"},class:"ma-0 pa-0 ml-4",clearable:""},null,8,["modelValue","label"])]),_:1})]),_:1}),l(F,null,{default:n(()=>[l(M,null,{default:n(()=>[l(Ee,{"items-per-page":w.value,"onUpdate:itemsPerPage":i[2]||(i[2]=a=>w.value=a),class:"elevation-1 primary","item-value":"id",density:"compact",headers:K,items:x.value,"items-length":I.value,loading:b.value,search:h.value,page:q.value,"items-per-page-options":U,"no-data-text":e(t)("ProgramEventsView.noProgramEventsFound"),"loading-text":e(t)("ProgramEventsView.loadingProgramEvents"),"onUpdate:options":e(T)},{"item.icon_small_url":n(({item:a})=>[l(B,{url:a.icon_small_url},null,8,["url"])]),"item.icon2_small_url":n(({item:a})=>[l(B,{url:a.icon2_small_url},null,8,["url"])]),"item.start":n(({item:a})=>[l(R,{value:a.start},null,8,["value"])]),"item.end":n(({item:a})=>[l(R,{value:a.end},null,8,["value"])]),"item.social_links":n(({item:a})=>[l(Ae,{"home-url":a.home_url,"twitter-url":a.twitter_url,"github-url":a.github_url,"facebook-url":a.facebook_url,"linkedin-url":a.linkedin_url,"wiki-url":a.wiki_url},null,8,["home-url","twitter-url","github-url","facebook-url","linkedin-url","wiki-url"])]),"item.event_type":n(({item:a})=>[A($(e(t)(`ProgramEventsView.eventTypes.${a.event_type}`)),1)]),"item.active":n(({item:a})=>[l(de,{value:a.active},null,8,["value"])]),"item.actions":n(({item:a})=>[l(_e,{"can-edit":e(_).canChange(e(E).PROGRAMME_EVENT),"can-delete":e(_).canDelete(e(E).PROGRAMME_EVENT),"audit-log":{appLabel:"ext_programme",model:"programmeevent",objectPk:a.id},onEdit:Q=>J(a.id),onDelete:Q=>z(a)},null,8,["can-edit","can-delete","audit-log","onEdit","onDelete"])]),_:1},8,["items-per-page","items","items-length","loading","search","page","no-data-text","loading-text","onUpdate:options"])]),_:1})]),_:1})]),_:1},8,["breadcrumbs"]))}});export{Ze as default};
//# sourceMappingURL=ProgramEventsView-DbfDy0bD.js.map
