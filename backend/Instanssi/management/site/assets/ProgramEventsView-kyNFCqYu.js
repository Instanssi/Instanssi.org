import{d as $,a as M,b as u,c as m,j as e,e as l,ae as Y,k as g,D as d,I as w,_ as Z,u as ee,J as te,K as ae,v as le,L,g as C,w as s,P,V as ie,i as S,t as A,M as re,m as ne,N as F,O as se,q as oe,s as y,af as ue,ag as ce,H as me}from"./index-CQkWvXOv.js";import{_ as de}from"./BooleanIcon.vue_vue_type_script_setup_true_lang-BUZkEwsX.js";import{_ as D}from"./DateTimeCell.vue_vue_type_script_setup_true_lang-DaLynL44.js";import{I as O}from"./ImageCell-BlQ2k2ZF.js";import{V as B,_ as ve}from"./LayoutBase.vue_vue_type_script_setup_true_lang-D5aCeQDf.js";import{c as ge,f as pe,d as fe,e as ke,g as he}from"./index-DW3SUbXG.js";import{_ as be}from"./TableActionButtons.vue_vue_type_script_setup_true_lang-DepTf6Bi.js";import{u as ye,d as we}from"./useTableState-CutuDm2i.js";import{g as _e}from"./query_tools-BInV9OzK.js";import{g as Ve}from"./http-CET7UDul.js";import{V as R}from"./VRow-CXIXhuhq.js";import{V as Ee}from"./VDataTableServer-C6tuZDKn.js";import{p as Pe}from"./parseInt-BJ5A4_3y.js";import"./datetime-Dz9fjSvq.js";import"./VContainer-DqJ8gu3P.js";import"./AuditLogDialog.vue_vue_type_script_setup_true_lang-1MnYozFL.js";import"./useAuditLogUtils-BdjF9k7b.js";import"./VDataTable-f5_9vewM.js";const Ue={class:"social-links-cell"},Te=["href","title"],xe=["href","title"],Ie=["href","title"],Le=["href","title"],Ce=["href","title"],Se=["href","title"],Ae={key:6,class:"no-links"},Fe=$({__name:"SocialLinksCell",props:{homeUrl:{},twitterUrl:{},githubUrl:{},facebookUrl:{},linkedinUrl:{},wikiUrl:{}},setup(r){const c=r,{t}=M(),h=w(()=>!!(c.homeUrl||c.twitterUrl||c.githubUrl||c.facebookUrl||c.linkedinUrl||c.wikiUrl));return(U,b)=>(u(),m("div",Ue,[r.homeUrl?(u(),m("a",{key:0,href:r.homeUrl,target:"_blank",class:"social-link",title:e(t)("SocialLinksCell.home")},[l(e(g),{icon:e(Y)},null,8,["icon"])],8,Te)):d("",!0),r.twitterUrl?(u(),m("a",{key:1,href:r.twitterUrl,target:"_blank",class:"social-link",title:e(t)("SocialLinksCell.twitter")},[l(e(g),{icon:e(ge)},null,8,["icon"])],8,xe)):d("",!0),r.githubUrl?(u(),m("a",{key:2,href:r.githubUrl,target:"_blank",class:"social-link",title:e(t)("SocialLinksCell.github")},[l(e(g),{icon:e(pe)},null,8,["icon"])],8,Ie)):d("",!0),r.facebookUrl?(u(),m("a",{key:3,href:r.facebookUrl,target:"_blank",class:"social-link",title:e(t)("SocialLinksCell.facebook")},[l(e(g),{icon:e(fe)},null,8,["icon"])],8,Le)):d("",!0),r.linkedinUrl?(u(),m("a",{key:4,href:r.linkedinUrl,target:"_blank",class:"social-link",title:e(t)("SocialLinksCell.linkedin")},[l(e(g),{icon:e(ke)},null,8,["icon"])],8,Ce)):d("",!0),r.wikiUrl?(u(),m("a",{key:5,href:r.wikiUrl,target:"_blank",class:"social-link",title:e(t)("SocialLinksCell.wikipedia")},[l(e(g),{icon:e(he)},null,8,["icon"])],8,Se)):d("",!0),h.value?d("",!0):(u(),m("span",Ae,"-"))]))}}),De=Z(Fe,[["__scopeId","data-v-352bfabc"]]),et=$({__name:"ProgramEventsView",props:{eventId:{}},setup(r){const c=r,{t}=M(),h=ee(),U=te(ae),b=le(),_=oe(),{getEventById:N}=me(),v=w(()=>Pe(c.eventId,10)),V=y(!1),G=w(()=>[{title:N(v.value)?.name??"...",to:{name:"dashboard",params:{eventId:c.eventId}}},{title:t("ProgramEventsView.title"),disabled:!0}]),i=ye({filterKeys:["eventType","active"]}),T=y(0),x=y([]),f=y(null),k=w({get:()=>i.getFilterAsNumber("eventType"),set:o=>{i.setFilter("eventType",o),i.resetPage()}}),p=i.useBooleanFilter("active"),j=[{title:t("ProgramEventsView.eventTypes.0"),value:0},{title:t("ProgramEventsView.eventTypes.1"),value:1}],K=[{title:t("ProgramEventsView.headers.id"),sortable:!0,key:"id"},{title:t("ProgramEventsView.headers.icon"),sortable:!1,key:"icon_small_url",width:60},{title:t("ProgramEventsView.headers.icon2"),sortable:!1,key:"icon2_small_url",width:60},{title:t("ProgramEventsView.headers.title"),sortable:!0,key:"title"},{title:t("ProgramEventsView.headers.start"),sortable:!0,key:"start"},{title:t("ProgramEventsView.headers.end"),sortable:!0,key:"end"},{title:t("ProgramEventsView.headers.place"),sortable:!1,key:"place"},{title:t("ProgramEventsView.headers.socialLinks"),sortable:!1,key:"social_links"},{title:t("ProgramEventsView.headers.eventType"),sortable:!0,key:"event_type"},{title:t("ProgramEventsView.headers.active"),sortable:!1,key:"active"},{title:t("ProgramEventsView.headers.actions"),sortable:!1,key:"actions",align:"end"}];function q(){f.value&&I(f.value)}async function I(o){V.value=!0,f.value=o;try{const n=await ce({path:{event_pk:v.value},query:{..._e(o),...k.value!==null?{event_type:k.value}:{},...p.value!==null?{active:p.value}:{}}});x.value=n.data.results,T.value=n.data.count}catch(n){b.error(t("ProgramEventsView.loadFailure")),console.error(n)}finally{V.value=!1}}const E=we(I,250);function H(o){i.onOptionsUpdate(o),E(o)}L([k,p],()=>{f.value&&E({...f.value,page:1})});function W(){i.setFilter("eventType",null),i.setFilter("active",null),i.search.value="",i.page.value=1,E({page:1,itemsPerPage:i.perPage.value??25,sortBy:[],groupBy:[],search:""})}L(v,W);async function z(o){const n=t("ProgramEventsView.confirmDelete",o);await U.value.ifConfirmed(n,async()=>{try{await ue({path:{event_pk:v.value,id:o.id}}),b.success(t("ProgramEventsView.deleteSuccess")),q()}catch(a){b.error(Ve(a,t("ProgramEventsView.deleteFailure"))),console.error(a)}})}function J(o){h.push({name:"program-edit",params:{eventId:v.value,id:o}})}function X(){h.push({name:"program-new",params:{eventId:v.value}})}return(o,n)=>(u(),C(ve,{key:`program-${v.value}`,breadcrumbs:G.value},{default:s(()=>[l(B,null,{default:s(()=>[l(R,null,{default:s(()=>[e(_).canAdd(e(P).PROGRAMME_EVENT)?(u(),C(ie,{key:0,color:"primary",onClick:X},{prepend:s(()=>[l(e(g),{icon:e(re)},null,8,["icon"])]),default:s(()=>[S(" "+A(e(t)("ProgramEventsView.newProgramEvent")),1)]),_:1})):d("",!0),l(ne,{modelValue:e(i).search.value,"onUpdate:modelValue":n[0]||(n[0]=a=>e(i).search.value=a),variant:"outlined",density:"compact",label:e(t)("General.search"),style:{"max-width":"400px"},class:"ma-0 pa-0 ml-4",clearable:""},null,8,["modelValue","label"]),l(F,{modelValue:k.value,"onUpdate:modelValue":n[1]||(n[1]=a=>k.value=a),variant:"outlined",density:"compact",label:e(t)("ProgramEventsView.filterEventType"),items:j,style:{"max-width":"200px"},class:"ma-0 pa-0 ml-4",clearable:""},null,8,["modelValue","label"]),l(F,{modelValue:e(p),"onUpdate:modelValue":n[2]||(n[2]=a=>se(p)?p.value=a:null),items:[{title:e(t)("ProgramEventsView.allStatuses"),value:null},{title:e(t)("ProgramEventsView.activeOnly"),value:!0},{title:e(t)("ProgramEventsView.inactiveOnly"),value:!1}],variant:"outlined",density:"compact",label:e(t)("ProgramEventsView.filterActive"),style:{"max-width":"200px"},class:"ma-0 pa-0 ml-4"},null,8,["modelValue","items","label"])]),_:1})]),_:1}),l(B,null,{default:s(()=>[l(R,null,{default:s(()=>[l(Ee,{"items-per-page":e(i).perPage.value,"onUpdate:itemsPerPage":n[3]||(n[3]=a=>e(i).perPage.value=a),"sort-by":e(i).sortByArray.value,class:"elevation-1 primary","item-value":"id",density:"compact",headers:K,items:x.value,"items-length":T.value,loading:V.value,search:e(i).search.value,page:e(i).page.value,"items-per-page-options":e(i).pageSizeOptions,"no-data-text":e(t)("ProgramEventsView.noProgramEventsFound"),"loading-text":e(t)("ProgramEventsView.loadingProgramEvents"),"onUpdate:options":H},{"item.icon_small_url":s(({item:a})=>[l(O,{url:a.icon_small_url},null,8,["url"])]),"item.icon2_small_url":s(({item:a})=>[l(O,{url:a.icon2_small_url},null,8,["url"])]),"item.start":s(({item:a})=>[l(D,{value:a.start},null,8,["value"])]),"item.end":s(({item:a})=>[l(D,{value:a.end},null,8,["value"])]),"item.social_links":s(({item:a})=>[l(De,{"home-url":a.home_url,"twitter-url":a.twitter_url,"github-url":a.github_url,"facebook-url":a.facebook_url,"linkedin-url":a.linkedin_url,"wiki-url":a.wiki_url},null,8,["home-url","twitter-url","github-url","facebook-url","linkedin-url","wiki-url"])]),"item.event_type":s(({item:a})=>[S(A(e(t)(`ProgramEventsView.eventTypes.${a.event_type}`)),1)]),"item.active":s(({item:a})=>[l(de,{value:a.active},null,8,["value"])]),"item.actions":s(({item:a})=>[l(be,{"can-edit":e(_).canChange(e(P).PROGRAMME_EVENT),"can-delete":e(_).canDelete(e(P).PROGRAMME_EVENT),"audit-log":{appLabel:"ext_programme",model:"programmeevent",objectPk:a.id},onEdit:Q=>J(a.id),onDelete:Q=>z(a)},null,8,["can-edit","can-delete","audit-log","onEdit","onDelete"])]),_:1},8,["items-per-page","sort-by","items","items-length","loading","search","page","items-per-page-options","no-data-text","loading-text"])]),_:1})]),_:1})]),_:1},8,["breadcrumbs"]))}});export{et as default};
//# sourceMappingURL=ProgramEventsView-kyNFCqYu.js.map
