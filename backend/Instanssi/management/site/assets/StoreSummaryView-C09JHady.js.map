{"version":3,"file":"StoreSummaryView-C09JHady.js","sources":["../../../../../admin/src/components/dashboard/charts/SalesByHourChart.vue","../../../../../admin/src/components/dashboard/charts/SalesPerDayChart.vue","../../../../../admin/src/views/store/StoreSummaryView.vue"],"sourcesContent":["<template>\n    <ChartCard\n        :title=\"t('StoreSummaryView.charts.salesByHour')\"\n        :has-data=\"chartData.labels.length > 0\"\n        :no-data-text=\"t('StoreSummaryView.charts.noData')\"\n    >\n        <Bar :data=\"chartData\" :options=\"chartOptions\" />\n    </ChartCard>\n</template>\n\n<script setup lang=\"ts\">\nimport {\n    BarElement,\n    CategoryScale,\n    Chart as ChartJS,\n    Legend,\n    LinearScale,\n    Tooltip,\n} from \"chart.js\";\nimport { Temporal } from \"temporal-polyfill\";\nimport { computed } from \"vue\";\nimport { useI18n } from \"vue-i18n\";\nimport { Bar } from \"vue-chartjs\";\n\nimport ChartCard from \"@/components/dashboard/ChartCard.vue\";\n\nChartJS.register(BarElement, CategoryScale, Legend, LinearScale, Tooltip);\n\nconst props = defineProps<{\n    paidTimes: Temporal.ZonedDateTime[];\n}>();\n\nconst { t } = useI18n();\n\nconst chartOptions = {\n    responsive: true,\n    maintainAspectRatio: false,\n    plugins: {\n        legend: {\n            display: false,\n        },\n    },\n    scales: {\n        y: {\n            beginAtZero: true,\n            ticks: {\n                stepSize: 1,\n            },\n        },\n    },\n};\n\nconst chartData = computed(() => {\n    if (props.paidTimes.length === 0) {\n        return { labels: [], datasets: [] };\n    }\n\n    // Group sales by hour (in Helsinki timezone)\n    const salesByHour = new Array(24).fill(0);\n    for (const paidTime of props.paidTimes) {\n        const hour = paidTime.hour;\n        salesByHour[hour]++;\n    }\n\n    const labels: string[] = [];\n    const data: number[] = [];\n    for (let i = 0; i < 24; i++) {\n        labels.push(`${i.toString().padStart(2, \"0\")}:00`);\n        data.push(salesByHour[i]);\n    }\n\n    return {\n        labels,\n        datasets: [\n            {\n                label: t(\"StoreSummaryView.charts.salesCount\"),\n                data,\n                backgroundColor: \"#2196F3\",\n            },\n        ],\n    };\n});\n</script>\n","<template>\n    <ChartCard\n        :title=\"t('StoreSummaryView.charts.salesPerDay')\"\n        :has-data=\"chartData.labels.length > 0\"\n        :no-data-text=\"t('StoreSummaryView.charts.noData')\"\n    >\n        <Bar :data=\"chartData\" :options=\"chartOptions\" />\n    </ChartCard>\n</template>\n\n<script setup lang=\"ts\">\nimport {\n    BarElement,\n    CategoryScale,\n    Chart as ChartJS,\n    Legend,\n    LinearScale,\n    Tooltip,\n} from \"chart.js\";\nimport { Temporal } from \"temporal-polyfill\";\nimport { computed } from \"vue\";\nimport { useI18n } from \"vue-i18n\";\nimport { Bar } from \"vue-chartjs\";\n\nimport ChartCard from \"@/components/dashboard/ChartCard.vue\";\n\nChartJS.register(BarElement, CategoryScale, Legend, LinearScale, Tooltip);\n\nconst props = defineProps<{\n    paidTimes: Temporal.ZonedDateTime[];\n}>();\n\nconst { t } = useI18n();\n\nconst chartOptions = {\n    responsive: true,\n    maintainAspectRatio: false,\n    plugins: {\n        legend: {\n            display: false,\n        },\n    },\n    scales: {\n        y: {\n            beginAtZero: true,\n            ticks: {\n                stepSize: 1,\n            },\n        },\n    },\n};\n\nconst chartData = computed(() => {\n    if (props.paidTimes.length === 0) {\n        return { labels: [], datasets: [] };\n    }\n\n    // Group sales by date (in Helsinki timezone)\n    const salesByDate = new Map<string, number>();\n    for (const paidTime of props.paidTimes) {\n        const dateKey = paidTime.toPlainDate().toString();\n        salesByDate.set(dateKey, (salesByDate.get(dateKey) ?? 0) + 1);\n    }\n\n    // Get date range and fill in all days\n    const sortedDates = Array.from(salesByDate.keys()).sort();\n    if (sortedDates.length === 0) {\n        return { labels: [], datasets: [] };\n    }\n\n    const labels: string[] = [];\n    const data: number[] = [];\n    const firstDate = sortedDates[0];\n    const lastDate = sortedDates[sortedDates.length - 1];\n    if (!firstDate || !lastDate) {\n        return { labels: [], datasets: [] };\n    }\n\n    // Iterate through date range using Temporal\n    let currentDate = Temporal.PlainDate.from(firstDate);\n    const endDate = Temporal.PlainDate.from(lastDate);\n    while (Temporal.PlainDate.compare(currentDate, endDate) <= 0) {\n        const dateKey = currentDate.toString();\n        labels.push(dateKey);\n        data.push(salesByDate.get(dateKey) ?? 0);\n        currentDate = currentDate.add({ days: 1 });\n    }\n\n    return {\n        labels,\n        datasets: [\n            {\n                label: t(\"StoreSummaryView.charts.salesCount\"),\n                data,\n                backgroundColor: \"#4CAF50\",\n            },\n        ],\n    };\n});\n</script>\n","<template>\n    <LayoutBase :key=\"`store-summary-${eventId}`\" :breadcrumbs=\"breadcrumbs\">\n        <v-col v-if=\"loading\" class=\"d-flex justify-center my-8\">\n            <v-progress-circular indeterminate size=\"64\" />\n        </v-col>\n        <v-col v-else>\n            <!-- Summary Cards -->\n            <v-row class=\"mb-4\">\n                <v-col cols=\"12\" sm=\"6\">\n                    <StatCard\n                        :icon=\"faBoxOpen\"\n                        :value=\"totalItemsSold\"\n                        :label=\"t('StoreSummaryView.totals.totalItems')\"\n                        color=\"primary\"\n                    />\n                </v-col>\n                <v-col cols=\"12\" sm=\"6\">\n                    <StatCard\n                        :icon=\"faEuroSign\"\n                        :value=\"`${totalRevenue.toFixed(2)} â‚¬`\"\n                        :label=\"t('StoreSummaryView.totals.totalRevenue')\"\n                        color=\"success\"\n                    />\n                </v-col>\n            </v-row>\n\n            <!-- Charts -->\n            <v-row class=\"mb-4\">\n                <v-col cols=\"12\" md=\"6\">\n                    <SalesPerDayChart :paid-times=\"paidTimesForItems\" />\n                </v-col>\n                <v-col cols=\"12\" md=\"6\">\n                    <SalesByHourChart :paid-times=\"paidTimesForItems\" />\n                </v-col>\n            </v-row>\n\n            <!-- Sales Table -->\n            <v-row>\n                <v-col cols=\"12\">\n                    <v-card>\n                        <v-card-title class=\"d-flex align-center\">\n                            {{ t(\"StoreSummaryView.title\") }}\n                            <v-spacer />\n                            <ExportButton\n                                :label=\"t('StoreSummaryView.export')\"\n                                :loading=\"exportLoading\"\n                                size=\"small\"\n                                @export=\"exportData\"\n                            />\n                        </v-card-title>\n                        <v-card-text>\n                            <v-data-table\n                                v-if=\"summaryRows.length > 0\"\n                                :headers=\"headers\"\n                                :items=\"summaryRows\"\n                                density=\"compact\"\n                                class=\"elevation-0\"\n                                :items-per-page=\"-1\"\n                                hide-default-footer\n                            >\n                                <template #item.revenue=\"{ item }\">\n                                    {{ item.revenue.toFixed(2) }} &euro;\n                                </template>\n                            </v-data-table>\n                            <div v-else class=\"text-grey text-center py-8\">\n                                {{ t(\"StoreSummaryView.noSalesFound\") }}\n                            </div>\n                        </v-card-text>\n                    </v-card>\n                </v-col>\n            </v-row>\n        </v-col>\n    </LayoutBase>\n</template>\n\n<script setup lang=\"ts\">\nimport { faBoxOpen, faEuroSign } from \"@fortawesome/free-solid-svg-icons\";\nimport { parseInt } from \"lodash-es\";\nimport { computed, onMounted, ref, type Ref } from \"vue\";\nimport { useI18n } from \"vue-i18n\";\nimport { useToast } from \"vue-toastification\";\nimport type { VDataTable } from \"vuetify/components\";\n\nimport { Temporal } from \"temporal-polyfill\";\n\nimport * as api from \"@/api\";\nimport type { StoreItem, StoreTransaction, TransactionItem } from \"@/api\";\nimport SalesByHourChart from \"@/components/dashboard/charts/SalesByHourChart.vue\";\nimport SalesPerDayChart from \"@/components/dashboard/charts/SalesPerDayChart.vue\";\nimport ExportButton from \"@/components/form/ExportButton.vue\";\nimport LayoutBase, { type BreadcrumbItem } from \"@/components/layout/LayoutBase.vue\";\nimport StatCard from \"@/components/dashboard/StatCard.vue\";\nimport { useEvents } from \"@/services/events\";\nimport { ADMIN_TIMEZONE } from \"@/utils/datetime\";\nimport { downloadSpreadsheet, type SpreadsheetFormat } from \"@/utils/spreadsheet\";\n\ntype ReadonlyHeaders = VDataTable[\"$props\"][\"headers\"];\n\ninterface SummaryRow {\n    item: string;\n    variant: string;\n    quantity: number;\n    revenue: number;\n}\n\nconst props = defineProps<{ eventId: string }>();\nconst { t } = useI18n();\nconst toast = useToast();\nconst { getEventById } = useEvents();\nconst eventId = computed(() => parseInt(props.eventId, 10));\nconst loading = ref(false);\nconst exportLoading = ref(false);\n\nconst storeItems: Ref<StoreItem[]> = ref([]);\nconst transactions: Ref<StoreTransaction[]> = ref([]);\nconst transactionItems: Ref<TransactionItem[]> = ref([]);\n\nconst breadcrumbs = computed<BreadcrumbItem[]>(() => [\n    {\n        title: getEventById(eventId.value)?.name ?? \"...\",\n        to: { name: \"dashboard\", params: { eventId: props.eventId } },\n    },\n    { title: t(\"StoreSummaryView.title\"), disabled: true },\n]);\n\nconst headers: ReadonlyHeaders = [\n    {\n        title: t(\"StoreSummaryView.headers.item\"),\n        key: \"item\",\n        sortable: true,\n    },\n    {\n        title: t(\"StoreSummaryView.headers.variant\"),\n        key: \"variant\",\n        sortable: true,\n    },\n    {\n        title: t(\"StoreSummaryView.headers.quantity\"),\n        key: \"quantity\",\n        sortable: true,\n        align: \"end\",\n    },\n    {\n        title: t(\"StoreSummaryView.headers.revenue\"),\n        key: \"revenue\",\n        sortable: true,\n        align: \"end\",\n    },\n];\n\n// Get paid transactions sorted by time\nconst paidTransactions = computed(() => {\n    return transactions.value\n        .filter((tx) => tx.is_paid && tx.time_paid)\n        .sort((a, b) => {\n            const timeA = a.time_paid ? new Date(a.time_paid).getTime() : 0;\n            const timeB = b.time_paid ? new Date(b.time_paid).getTime() : 0;\n            return timeA - timeB;\n        });\n});\n\n// Get set of paid transaction IDs\nconst paidTransactionIds = computed(() => {\n    return new Set(paidTransactions.value.map((t) => t.id));\n});\n\n// Filter transaction items to only include paid ones\nconst paidTransactionItems = computed(() => {\n    return transactionItems.value.filter((item) => paidTransactionIds.value.has(item.transaction));\n});\n\n// Build transaction ID to paid time map (in Helsinki timezone)\nconst transactionPaidTimeMap = computed(() => {\n    const map = new Map<number, Temporal.ZonedDateTime>();\n    for (const tx of paidTransactions.value) {\n        if (tx.time_paid) {\n            const instant = Temporal.Instant.from(tx.time_paid);\n            map.set(tx.id, instant.toZonedDateTimeISO(ADMIN_TIMEZONE));\n        }\n    }\n    return map;\n});\n\n// Get paid times array for charts (one entry per transaction item)\nconst paidTimesForItems = computed(() => {\n    const times: Temporal.ZonedDateTime[] = [];\n    for (const txItem of paidTransactionItems.value) {\n        const paidTime = transactionPaidTimeMap.value.get(txItem.transaction);\n        if (paidTime) {\n            times.push(paidTime);\n        }\n    }\n    return times;\n});\n\n// Build summary rows grouped by item + variant\nconst summaryRows = computed<SummaryRow[]>(() => {\n    const grouped = new Map<string, SummaryRow>();\n\n    for (const txItem of paidTransactionItems.value) {\n        const itemName = getItemName(txItem.item);\n        const variantName = getVariantName(txItem.item, txItem.variant);\n        const key = `${txItem.item}-${txItem.variant ?? \"null\"}`;\n\n        if (!grouped.has(key)) {\n            grouped.set(key, {\n                item: itemName,\n                variant: variantName,\n                quantity: 0,\n                revenue: 0,\n            });\n        }\n\n        const row = grouped.get(key)!;\n        row.quantity += 1;\n        row.revenue += parseFloat(txItem.purchase_price);\n    }\n\n    return Array.from(grouped.values()).sort((a, b) => a.item.localeCompare(b.item));\n});\n\nconst totalItemsSold = computed(() => {\n    return summaryRows.value.reduce((sum, row) => sum + row.quantity, 0);\n});\n\nconst totalRevenue = computed(() => {\n    return summaryRows.value.reduce((sum, row) => sum + row.revenue, 0);\n});\n\nfunction getItemName(itemId: number): string {\n    const item = storeItems.value.find((i) => i.id === itemId);\n    return item?.name ?? `#${itemId}`;\n}\n\nfunction getVariantName(itemId: number, variantId: number | null | undefined): string {\n    if (!variantId) return \"-\";\n    const item = storeItems.value.find((i) => i.id === itemId);\n    if (!item) return `#${variantId}`;\n    const variant = item.variants?.find((v) => v.id === variantId);\n    return variant?.name ?? `#${variantId}`;\n}\n\nasync function loadData() {\n    loading.value = true;\n    try {\n        const [itemsResponse, transactionsResponse, txItemsResponse] = await Promise.all([\n            api.adminEventStoreItemsList({\n                path: { event_pk: eventId.value },\n                query: { limit: 1000 },\n            }),\n            api.adminEventStoreTransactionsList({\n                path: { event_pk: eventId.value },\n                query: { limit: 10000 },\n            }),\n            api.adminEventStoreTransactionItemsList({\n                path: { event_pk: eventId.value },\n                query: { limit: 10000 },\n            }),\n        ]);\n        storeItems.value = itemsResponse.data!.results;\n        transactions.value = transactionsResponse.data!.results;\n        transactionItems.value = txItemsResponse.data!.results;\n    } catch (e) {\n        toast.error(t(\"StoreSummaryView.loadFailure\"));\n        console.error(e);\n    } finally {\n        loading.value = false;\n    }\n}\n\nfunction exportData(format: SpreadsheetFormat): void {\n    exportLoading.value = true;\n    try {\n        const data: Array<Array<string | number>> = [\n            [\"Item\", \"Variant\", \"Quantity Sold\", \"Revenue (EUR)\"],\n        ];\n\n        for (const row of summaryRows.value) {\n            data.push([row.item, row.variant, row.quantity, row.revenue.toFixed(2)]);\n        }\n\n        // Add totals row\n        data.push([]);\n        data.push([\"TOTAL\", \"\", totalItemsSold.value, totalRevenue.value.toFixed(2)]);\n\n        downloadSpreadsheet(data, \"instanssi_sales_summary\", format, \"Sales Summary\");\n        toast.success(t(\"StoreSummaryView.exportSuccess\"));\n    } catch (e) {\n        toast.error(t(\"StoreSummaryView.exportFailure\"));\n        console.error(e);\n    } finally {\n        exportLoading.value = false;\n    }\n}\n\nonMounted(loadData);\n</script>\n"],"names":["ChartJS","BarElement","CategoryScale","Legend","LinearScale","Tooltip","props","__props","t","useI18n","chartOptions","chartData","computed","salesByHour","paidTime","hour","labels","data","i","_createBlock","ChartCard","_unref","_createVNode","Bar","salesByDate","dateKey","sortedDates","firstDate","lastDate","currentDate","Temporal","endDate","toast","useToast","getEventById","useEvents","eventId","parseInt","loading","ref","exportLoading","storeItems","transactions","transactionItems","breadcrumbs","headers","paidTransactions","tx","a","b","timeA","timeB","paidTransactionIds","paidTransactionItems","item","transactionPaidTimeMap","map","instant","ADMIN_TIMEZONE","paidTimesForItems","times","txItem","summaryRows","grouped","itemName","getItemName","variantName","getVariantName","key","row","totalItemsSold","sum","totalRevenue","itemId","variantId","v","loadData","itemsResponse","transactionsResponse","txItemsResponse","api.adminEventStoreItemsList","api.adminEventStoreTransactionsList","api.adminEventStoreTransactionItemsList","e","exportData","format","downloadSpreadsheet","onMounted","LayoutBase","_component_v_col","_component_v_progress_circular","_component_v_row","StatCard","faBoxOpen","faEuroSign","SalesPerDayChart","SalesByHourChart","_component_v_card","_component_v_card_title","_createTextVNode","_toDisplayString","_component_v_spacer","ExportButton","_component_v_card_text","_component_v_data_table","_withCtx","_createElementBlock","_hoisted_1"],"mappings":"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"}