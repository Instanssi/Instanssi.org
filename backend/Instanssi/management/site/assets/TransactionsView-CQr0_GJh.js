import{d as k,a as C,b as I,c as O,e as t,w as s,j as a,k as w,c6 as R,V as b,p as z,aD as j,f as q,t as v,aE as G,aF as H,B as X,i as B,aG as J,D as K,s as p,_ as M,u as Q,v as W,L as Y,g as Z,m as ee,P as ae,a5 as te,q as se,I as y,c7 as ne,H as le}from"./index-CQkWvXOv.js";import{_ as ie}from"./DateTimeCell.vue_vue_type_script_setup_true_lang-DaLynL44.js";import{V as h,_ as oe}from"./LayoutBase.vue_vue_type_script_setup_true_lang-D5aCeQDf.js";import{_ as re}from"./PriceCell.vue_vue_type_script_setup_true_lang-FibLybm5.js";import{_ as ue}from"./TableActionButtons.vue_vue_type_script_setup_true_lang-DepTf6Bi.js";import{u as ce,d as de}from"./useTableState-CutuDm2i.js";import{g as me}from"./query_tools-BInV9OzK.js";import{V as x}from"./VRow-CXIXhuhq.js";import{V as pe}from"./VDataTableServer-C6tuZDKn.js";import{p as fe}from"./parseInt-BJ5A4_3y.js";import"./datetime-Dz9fjSvq.js";import"./VContainer-DqJ8gu3P.js";import"./AuditLogDialog.vue_vue_type_script_setup_true_lang-1MnYozFL.js";import"./useAuditLogUtils-BdjF9k7b.js";import"./VDataTable-f5_9vewM.js";const ve={key:0,class:"long-text-cell"},ge=k({__name:"LongTextCell",props:{value:{},title:{}},setup(u){const{t:c}=C(),e=p(!1);return(g,r)=>u.value?(I(),O("div",ve,[t(b,{icon:"",variant:"text",density:"compact",size:"small",title:a(c)("LongTextCell.clickToView"),onClick:r[0]||(r[0]=d=>e.value=!0)},{default:s(()=>[t(a(w),{icon:a(R)},null,8,["icon"])]),_:1},8,["title"]),t(J,{modelValue:e.value,"onUpdate:modelValue":r[2]||(r[2]=d=>e.value=d),"max-width":"600"},{default:s(()=>[t(z,null,{default:s(()=>[t(j,{class:"d-flex justify-space-between align-center"},{default:s(()=>[q("span",null,v(u.title??a(c)("LongTextCell.dialogTitle")),1),t(b,{icon:"",variant:"text",density:"compact",onClick:r[1]||(r[1]=d=>e.value=!1)},{default:s(()=>[t(a(w),{icon:a(G)},null,8,["icon"])]),_:1})]),_:1}),t(H),t(X,{class:"pa-4",style:{"white-space":"pre-wrap"}},{default:s(()=>[B(v(u.value),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])])):K("",!0)}}),Ve=M(ge,[["__scopeId","data-v-080bb279"]]),Ae=k({__name:"TransactionsView",props:{eventId:{}},setup(u){const c=u,{t:e}=C(),g=Q(),r=W(),d=se(),{getEventById:L}=le(),m=y(()=>fe(c.eventId,10)),f=p(!1),S=y(()=>[{title:L(m.value)?.name??"...",to:{name:"dashboard",params:{eventId:c.eventId}}},{title:e("TransactionsView.title"),disabled:!0}]),i=ce(),V=p(0),_=p([]),D=p(null),P=[{title:e("TransactionsView.headers.id"),sortable:!0,key:"id"},{title:e("TransactionsView.headers.fullName"),sortable:!1,key:"full_name"},{title:e("TransactionsView.headers.email"),sortable:!0,key:"email"},{title:e("TransactionsView.headers.created"),sortable:!0,key:"time_created"},{title:e("TransactionsView.headers.status"),sortable:!1,key:"status"},{title:e("TransactionsView.headers.total"),sortable:!1,key:"total_price"},{title:e("TransactionsView.headers.information"),sortable:!1,key:"information"},{title:e("TransactionsView.headers.actions"),sortable:!1,key:"actions",align:"end"}];function $(n){return n.is_paid?"success":n.is_cancelled?"error":n.is_pending?"warning":"grey"}function A(n){return n.is_paid?e("TransactionsView.statuses.paid"):n.is_cancelled?e("TransactionsView.statuses.cancelled"):n.is_pending?e("TransactionsView.statuses.pending"):e("TransactionsView.statuses.created")}async function N(n){f.value=!0,D.value=n;try{const o=await ne({path:{event_pk:m.value},query:me(n)});_.value=o.data.results,V.value=o.data.count}catch(o){r.error(e("TransactionsView.loadFailure")),console.error(o)}finally{f.value=!1}}const T=de(N,250);function E(n){i.onOptionsUpdate(n),T(n)}function F(){i.search.value="",i.page.value=1,T({page:1,itemsPerPage:i.perPage.value??25,sortBy:[],groupBy:[],search:""})}Y(m,F);function U(n){g.push({name:"store-transaction-detail",params:{eventId:m.value,id:n}})}return(n,o)=>(I(),Z(oe,{key:`transactions-${m.value}`,breadcrumbs:S.value},{default:s(()=>[t(h,null,{default:s(()=>[t(x,null,{default:s(()=>[t(ee,{modelValue:a(i).search.value,"onUpdate:modelValue":o[0]||(o[0]=l=>a(i).search.value=l),variant:"outlined",density:"compact",label:a(e)("General.search"),style:{"max-width":"400px"},class:"ma-0 pa-0",clearable:""},null,8,["modelValue","label"])]),_:1})]),_:1}),t(h,null,{default:s(()=>[t(x,null,{default:s(()=>[t(pe,{"items-per-page":a(i).perPage.value,"onUpdate:itemsPerPage":o[1]||(o[1]=l=>a(i).perPage.value=l),"sort-by":a(i).sortByArray.value,class:"elevation-1 primary","item-value":"id",density:"compact",headers:P,items:_.value,"items-length":V.value,loading:f.value,search:a(i).search.value,page:a(i).page.value,"items-per-page-options":a(i).pageSizeOptions,"no-data-text":a(e)("TransactionsView.noTransactionsFound"),"loading-text":a(e)("TransactionsView.loadingTransactions"),"onUpdate:options":E},{"item.time_created":s(({item:l})=>[t(ie,{value:l.time_created},null,8,["value"])]),"item.status":s(({item:l})=>[t(te,{color:$(l),size:"small",variant:"flat"},{default:s(()=>[B(v(A(l)),1)]),_:2},1032,["color"])]),"item.total_price":s(({item:l})=>[t(re,{value:l.total_price},null,8,["value"])]),"item.information":s(({item:l})=>[t(Ve,{value:l.information,title:a(e)("TransactionsView.headers.informationDialogTitle")},null,8,["value","title"])]),"item.actions":s(({item:l})=>[t(ue,{"can-view":a(d).canView(a(ae).STORE_TRANSACTION),"can-edit":!1,"can-delete":!1,onView:_e=>U(l.id)},null,8,["can-view","onView"])]),_:1},8,["items-per-page","sort-by","items","items-length","loading","search","page","items-per-page-options","no-data-text","loading-text"])]),_:1})]),_:1})]),_:1},8,["breadcrumbs"]))}});export{Ae as default};
//# sourceMappingURL=TransactionsView-CQr0_GJh.js.map
