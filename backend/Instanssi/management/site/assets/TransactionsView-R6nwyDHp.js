import{d as R,a as U,u as D,v as G,b as _,g as V,w as s,e as n,m as L,j as r,P as O,V as q,i as g,t as T,k as z,bW as j,K,b4 as W,q as X,G as w,s as o,bX as H,E as J}from"./index-BSHMv_df.js";import{_ as M}from"./DateTimeCell.vue_vue_type_script_setup_true_lang-CG8AjqQo.js";import{V as b,_ as Q}from"./LayoutBase.vue_vue_type_script_setup_true_lang-C8aKWyeJ.js";import{_ as Y}from"./PriceCell.vue_vue_type_script_setup_true_lang-B8eOis0Q.js";import{d as Z,V as ee,g as ae}from"./query_tools-Co6bP9h2.js";import{V as y}from"./VRow-BUBfmFS3.js";import{p as te}from"./parseInt-3OpbdfxQ.js";import"./datetime-DsxOZgAd.js";import"./classApi-bnmGQydb.js";import"./VContainer--EpXOfw5.js";import"./VDataTable-CpUosGjF.js";import"./filter-C6Uu0LOB.js";const _e=R({__name:"TransactionsView",props:{eventId:{}},setup(h){const d=h,{t:e}=U(),k=D(),x=G(),I=X(),{getEventById:C}=J(),l=w(()=>te(d.eventId,10)),u=o(!1),S=w(()=>[{title:C(l.value)?.name??"...",to:{name:"dashboard",params:{eventId:d.eventId}}},{title:e("TransactionsView.title"),disabled:!0}]),m=[25,50,100],p=o(m[0]),f=o(0),E=o(1),v=o([]),c=o(""),N=[{title:e("TransactionsView.headers.id"),sortable:!0,key:"id"},{title:e("TransactionsView.headers.fullName"),sortable:!0,key:"full_name"},{title:e("TransactionsView.headers.email"),sortable:!0,key:"email"},{title:e("TransactionsView.headers.created"),sortable:!0,key:"time_created"},{title:e("TransactionsView.headers.status"),sortable:!1,key:"status"},{title:e("TransactionsView.headers.total"),sortable:!1,key:"total_price"},{title:e("TransactionsView.headers.actions"),sortable:!1,key:"actions",align:"end"}];function P(a){return a.is_paid?"success":a.is_cancelled?"error":a.is_pending?"warning":"grey"}function A(a){return a.is_paid?e("TransactionsView.statuses.paid"):a.is_cancelled?e("TransactionsView.statuses.cancelled"):a.is_pending?e("TransactionsView.statuses.pending"):e("TransactionsView.statuses.created")}async function $(a){u.value=!0;try{const i=await H({path:{event_pk:l.value},query:ae(a)});v.value=i.data.results,f.value=i.data.count}catch(i){x.error(e("TransactionsView.loadFailure")),console.error(i)}finally{u.value=!1}}const B=Z($,250);function F(a){k.push({name:"store-transaction-detail",params:{eventId:l.value,id:a}})}return(a,i)=>(_(),V(Q,{key:`transactions-${l.value}`,breadcrumbs:S.value},{default:s(()=>[n(b,null,{default:s(()=>[n(y,null,{default:s(()=>[n(L,{modelValue:c.value,"onUpdate:modelValue":i[0]||(i[0]=t=>c.value=t),variant:"outlined",density:"compact",label:r(e)("General.search"),style:{"max-width":"400px"},class:"ma-0 pa-0",clearable:""},null,8,["modelValue","label"])]),_:1})]),_:1}),n(b,null,{default:s(()=>[n(y,null,{default:s(()=>[n(ee,{"items-per-page":p.value,"onUpdate:itemsPerPage":i[1]||(i[1]=t=>p.value=t),class:"elevation-1 primary","item-value":"id",density:"compact",headers:N,items:v.value,"items-length":f.value,loading:u.value,search:c.value,page:E.value,"items-per-page-options":m,"no-data-text":r(e)("TransactionsView.noTransactionsFound"),"loading-text":r(e)("TransactionsView.loadingTransactions"),"onUpdate:options":r(B)},{"item.time_created":s(({item:t})=>[n(M,{value:t.time_created},null,8,["value"])]),"item.status":s(({item:t})=>[n(W,{color:P(t),size:"small",variant:"flat"},{default:s(()=>[g(T(A(t)),1)]),_:2},1032,["color"])]),"item.total_price":s(({item:t})=>[n(Y,{value:t.total_price},null,8,["value"])]),"item.actions":s(({item:t})=>[r(I).canView(r(O).STORE_TRANSACTION)?(_(),V(q,{key:0,density:"compact",variant:"text",onClick:se=>F(t.id)},{prepend:s(()=>[n(r(z),{icon:r(j)},null,8,["icon"])]),default:s(()=>[g(" "+T(r(e)("General.view")),1)]),_:1},8,["onClick"])):K("",!0)]),_:1},8,["items-per-page","items","items-length","loading","search","page","no-data-text","loading-text","onUpdate:options"])]),_:1})]),_:1})]),_:1},8,["breadcrumbs"]))}});export{_e as default};
//# sourceMappingURL=TransactionsView-R6nwyDHp.js.map
