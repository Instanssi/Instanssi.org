import{d as F,a as I,u as L,H as T,I as B,v as q,b as h,g as b,w as o,e as i,j as a,P as f,V as G,i as J,t as K,k as z,J as H,K as M,m as O,q as Q,G as W,s as n,R as X,S as Y,E as Z}from"./index-BSHMv_df.js";import{_ as y}from"./BooleanIcon.vue_vue_type_script_setup_true_lang-COcceYO8.js";import{_ as ee}from"./DateTimeCell.vue_vue_type_script_setup_true_lang-CG8AjqQo.js";import{V as k,_ as se}from"./LayoutBase.vue_vue_type_script_setup_true_lang-C8aKWyeJ.js";import{_ as ae}from"./TableActionButtons.vue_vue_type_script_setup_true_lang-DouyropJ.js";import{d as te,V as re,g as oe}from"./query_tools-Co6bP9h2.js";import{g as ie}from"./http-BZkoYM_m.js";import{V as x}from"./VRow-BUBfmFS3.js";import"./datetime-DsxOZgAd.js";import"./classApi-bnmGQydb.js";import"./VContainer--EpXOfw5.js";import"./VDataTable-CpUosGjF.js";import"./filter-C6Uu0LOB.js";const he=F({__name:"UsersView",setup(ne){const{t:e}=I(),v=L(),D=T(B),u=q(),d=Q(),{getLatestEvent:E}=Z(),S=W(()=>{const t=E();return[{title:t?.name??"...",to:t?{name:"dashboard",params:{eventId:t.id}}:void 0},{title:e("UsersView.title"),disabled:!0}]}),c=n(!1),_=[25,50,100],U=n(_[0]),V=n(0),P=n(1),g=n([]),m=n(""),p=n(null),A=[{title:e("UsersView.headers.id"),sortable:!0,key:"id"},{title:e("UsersView.headers.userName"),sortable:!1,key:"username"},{title:e("UsersView.headers.firstName"),sortable:!0,key:"first_name"},{title:e("UsersView.headers.lastName"),sortable:!0,key:"last_name"},{title:e("UsersView.headers.email"),sortable:!0,key:"email"},{title:e("UsersView.headers.superuser"),sortable:!1,key:"is_superuser"},{title:e("UsersView.headers.active"),sortable:!1,key:"is_active"},{title:e("UsersView.headers.dateJoined"),sortable:!1,key:"date_joined"},{title:e("UsersView.headers.actions"),sortable:!1,key:"actions",align:"end"}];function C(){p.value&&w(p.value)}async function w(t){c.value=!0,p.value=t;try{const r=await Y({query:oe(t)});g.value=r.data.results,V.value=r.data.count}catch(r){u.error(e("UsersView.loadFailure")),console.error(r)}finally{c.value=!1}}const N=te(w,250);async function R(t){const r=e("UsersView.confirmDelete",t);if(await D.value.confirm(r))try{await X({path:{id:t.id}}),C(),u.success(e("UsersView.deleteSuccess"))}catch(l){u.error(ie(l,e("UsersView.deleteFailure"))),console.error(l)}}function $(t){v.push({name:"users-edit",params:{id:t}})}function j(){v.push({name:"users-new"})}return(t,r)=>(h(),b(se,{breadcrumbs:S.value},{default:o(()=>[i(k,null,{default:o(()=>[i(x,null,{default:o(()=>[a(d).canAdd(a(f).USER)?(h(),b(G,{key:0,onClick:j},{prepend:o(()=>[i(a(z),{icon:a(H)},null,8,["icon"])]),default:o(()=>[J(" "+K(a(e)("UsersView.newUser")),1)]),_:1})):M("",!0),i(O,{modelValue:m.value,"onUpdate:modelValue":r[0]||(r[0]=s=>m.value=s),variant:"outlined",density:"compact",label:a(e)("General.search"),style:{"max-width":"400px"},class:"ma-0 pa-0 ml-4",clearable:""},null,8,["modelValue","label"])]),_:1})]),_:1}),i(k,null,{default:o(()=>[i(x,null,{default:o(()=>[i(re,{"items-per-page":U.value,"onUpdate:itemsPerPage":r[1]||(r[1]=s=>U.value=s),class:"elevation-1 primary","item-value":"id",density:"compact",headers:A,items:g.value,"items-length":V.value,loading:c.value,page:P.value,search:m.value,"items-per-page-options":_,"no-data-text":a(e)("UsersView.noUsersFound"),"loading-text":a(e)("UsersView.loadingUsers"),"onUpdate:options":a(N)},{"item.is_superuser":o(({item:s})=>[i(y,{value:s.is_superuser},null,8,["value"])]),"item.is_active":o(({item:s})=>[i(y,{value:s.is_active},null,8,["value"])]),"item.date_joined":o(({item:s})=>[i(ee,{value:s.date_joined},null,8,["value"])]),"item.actions":o(({item:s})=>[i(ae,{"can-edit":a(d).canChange(a(f).USER),"can-delete":a(d).canDelete(a(f).USER),onEdit:l=>$(s.id),onDelete:l=>R(s)},null,8,["can-edit","can-delete","onEdit","onDelete"])]),_:1},8,["items-per-page","items","items-length","loading","page","search","no-data-text","loading-text","onUpdate:options"])]),_:1})]),_:1})]),_:1},8,["breadcrumbs"]))}});export{he as default};
//# sourceMappingURL=UsersView-CcdBspBd.js.map
