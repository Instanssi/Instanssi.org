import{d as j,a as F,u as L,J as R,K as B,v as I,b as h,g as y,w as r,e as o,j as a,P as f,V as q,i as J,t as K,k as z,L as G,D as M,m as O,q as H,s as l,S as Q,T as W}from"./index-DXU74lGt.js";import{_ as b}from"./BooleanIcon.vue_vue_type_script_setup_true_lang-CqjGGkAi.js";import{_ as X}from"./DateTimeCell.vue_vue_type_script_setup_true_lang-BMnBYvTq.js";import{V as k,_ as Y}from"./LayoutBase.vue_vue_type_script_setup_true_lang-D4jd1chv.js";import{_ as Z}from"./TableActionButtons.vue_vue_type_script_setup_true_lang-CUVfxWfg.js";import{g as ee}from"./query_tools-BInV9OzK.js";import{g as se}from"./http-BTZWMaMN.js";import{d as ae}from"./debounce-CQ84CrOG.js";import{V as x}from"./VRow-B94Tto0H.js";import{V as te}from"./VDataTableServer-CMLVDy59.js";import"./datetime-Dz9fjSvq.js";import"./VContainer-BfWqa_tJ.js";import"./AuditLogDialog.vue_vue_type_script_setup_true_lang-WkXOSlqa.js";import"./useAuditLogUtils-BqNOieoY.js";import"./VDataTable-Jd7io3gq.js";const we=j({__name:"UsersView",setup(re){const{t:e}=F(),v=L(),D=R(B),u=I(),d=H(),S=[{title:e("UsersView.title"),disabled:!0}],c=l(!1),_=[25,50,100],U=l(_[0]),V=l(0),P=l(1),g=l([]),m=l(""),p=l(null),A=[{title:e("UsersView.headers.id"),sortable:!0,key:"id"},{title:e("UsersView.headers.userName"),sortable:!1,key:"username"},{title:e("UsersView.headers.firstName"),sortable:!0,key:"first_name"},{title:e("UsersView.headers.lastName"),sortable:!0,key:"last_name"},{title:e("UsersView.headers.email"),sortable:!0,key:"email"},{title:e("UsersView.headers.superuser"),sortable:!1,key:"is_superuser"},{title:e("UsersView.headers.active"),sortable:!1,key:"is_active"},{title:e("UsersView.headers.dateJoined"),sortable:!1,key:"date_joined"},{title:e("UsersView.headers.actions"),sortable:!1,key:"actions",align:"end"}];function C(){p.value&&w(p.value)}async function w(i){c.value=!0,p.value=i;try{const t=await W({query:ee(i)});g.value=t.data.results,V.value=t.data.count}catch(t){u.error(e("UsersView.loadFailure")),console.error(t)}finally{c.value=!1}}const E=ae(w,250);async function N(i){const t=e("UsersView.confirmDelete",i);if(await D.value.confirm(t))try{await Q({path:{id:i.id}}),C(),u.success(e("UsersView.deleteSuccess"))}catch(n){u.error(se(n,e("UsersView.deleteFailure"))),console.error(n)}}function T(i){v.push({name:"users-edit",params:{id:i}})}function $(){v.push({name:"users-new"})}return(i,t)=>(h(),y(Y,{breadcrumbs:S},{default:r(()=>[o(k,null,{default:r(()=>[o(x,null,{default:r(()=>[a(d).canAdd(a(f).USER)?(h(),y(q,{key:0,color:"primary",onClick:$},{prepend:r(()=>[o(a(z),{icon:a(G)},null,8,["icon"])]),default:r(()=>[J(" "+K(a(e)("UsersView.newUser")),1)]),_:1})):M("",!0),o(O,{modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=s=>m.value=s),variant:"outlined",density:"compact",label:a(e)("General.search"),style:{"max-width":"400px"},class:"ma-0 pa-0 ml-4",clearable:""},null,8,["modelValue","label"])]),_:1})]),_:1}),o(k,null,{default:r(()=>[o(x,null,{default:r(()=>[o(te,{"items-per-page":U.value,"onUpdate:itemsPerPage":t[1]||(t[1]=s=>U.value=s),class:"elevation-1 primary","item-value":"id",density:"compact",headers:A,items:g.value,"items-length":V.value,loading:c.value,page:P.value,search:m.value,"items-per-page-options":_,"no-data-text":a(e)("UsersView.noUsersFound"),"loading-text":a(e)("UsersView.loadingUsers"),"onUpdate:options":a(E)},{"item.is_superuser":r(({item:s})=>[o(b,{value:s.is_superuser},null,8,["value"])]),"item.is_active":r(({item:s})=>[o(b,{value:s.is_active},null,8,["value"])]),"item.date_joined":r(({item:s})=>[o(X,{value:s.date_joined},null,8,["value"])]),"item.actions":r(({item:s})=>[o(Z,{"can-edit":a(d).canChange(a(f).USER),"can-delete":a(d).canDelete(a(f).USER),onEdit:n=>T(s.id),onDelete:n=>N(s)},null,8,["can-edit","can-delete","onEdit","onDelete"])]),_:1},8,["items-per-page","items","items-length","loading","page","search","no-data-text","loading-text","onUpdate:options"])]),_:1})]),_:1})]),_:1}))}});export{we as default};
//# sourceMappingURL=UsersView-DrDfxrGF.js.map
