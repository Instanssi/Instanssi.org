import{aV as Ae,aW as Me,aX as Te,aY as Ee,aZ as _e,a_ as J,a$ as Le,b0 as D,b1 as Ne,L as M,b2 as Be,b3 as Ke,I as y,b4 as Oe,b5 as ze,b6 as $e,b7 as Ue,m as Q,e as d,f as F,b8 as ee,b9 as je,F as H,ba as qe,bb as w,aN as He,au as le,bc as We,aF as Xe,bd as Ye,be as Ze,bf as Ge,a5 as ae,bg as Je,bh as Qe,ab as el,bi as ll,i as al,s as O,bj as tl,bk as te,bl as ue,bm as T,bn as ul,bo as nl,bp as E,bq as ol,br as il,bs as sl}from"./index-CQkWvXOv.js";import{u as rl,m as cl,h as vl}from"./VDataTable-f5_9vewM.js";const dl=Oe({alwaysFilter:Boolean,autoSelectFirst:{type:[Boolean,String]},clearOnSelect:{type:Boolean,default:!0},delimiters:Array,...cl({filterKeys:["title"]}),...Ue({hideNoData:!0,returnObject:!0}),...ze($e({modelValue:null,role:"combobox"}),["validationValue","dirty"])},"VCombobox"),bl=Ae()({name:"VCombobox",props:dl(),emits:{"update:focused":l=>!0,"update:modelValue":l=>!0,"update:search":l=>!0,"update:menu":l=>!0},setup(l,ne){let{emit:oe,slots:s}=ne;const{t:ie}=Me(),m=O(),p=D(!1),x=D(!0),z=D(!1),W=O(),_=O(),i=D(-1);let L=!1;const{items:X,transformIn:se,transformOut:re}=Te(l),{textColorClasses:ce,textColorStyles:ve}=Ee(()=>m.value?.color),{InputIcon:de}=_e(l),u=J(l,"modelValue",[],e=>se(il(e)),e=>{const a=re(e);return l.multiple?a:a[0]??null}),I=Le(l),Y=ul(()=>l.closableChips&&!I.isReadonly.value&&!I.isDisabled.value),N=y(()=>!!(l.chips||s.chip)),V=y(()=>N.value||!!s.selection),b=D(!l.multiple&&!V.value?u.value[0]?.title??"":""),S=D(null),c=y({get:()=>b.value,set:async e=>{if(b.value=e??"",e===null||e===""&&!l.multiple&&!V.value?u.value=[]:!l.multiple&&!V.value&&(u.value=[E(l,e)],T(()=>_.value?.scrollToIndex(0))),e&&l.multiple&&l.delimiters?.length){const a=Z(e);a.length>1&&(G(a),b.value="")}e||(i.value=-1),x.value=!e}}),fe=y(()=>typeof l.counterValue=="function"?l.counterValue(u.value):typeof l.counterValue=="number"?l.counterValue:l.multiple?u.value.length:c.value.length),{filteredItems:$,getMatches:me}=rl(l,X,()=>S.value??(l.alwaysFilter||!x.value?c.value:"")),k=y(()=>l.hideSelected&&S.value===null?$.value.filter(e=>!u.value.some(a=>a.value===e.value)):$.value),B=y(()=>l.hideNoData&&!k.value.length||I.isReadonly.value||I.isDisabled.value),U=J(l,"menu"),r=y({get:()=>U.value,set:e=>{U.value&&!e&&W.value?.Î¨openChildren.size||e&&B.value||(U.value=e)}}),{menuId:be,ariaExpanded:he,ariaControls:ge}=Ne(l,r);M(b,e=>{L?T(()=>L=!1):p.value&&!r.value&&(r.value=!0),oe("update:search",e)}),M(u,e=>{!l.multiple&&!V.value&&(b.value=e[0]?.title??"")});const ye=y(()=>u.value.map(e=>e.value)),P=y(()=>k.value.find(e=>e.type==="item"&&!e.props.disabled)),j=y(()=>(l.autoSelectFirst===!0||l.autoSelectFirst==="exact"&&c.value===P.value?.title)&&k.value.length>0&&!x.value&&!z.value),q=O(),pe=tl(q,m);function xe(e){L=!0,T(()=>L=!1),l.openOnClear&&(r.value=!0)}function Ve(){B.value||(r.value=!0)}function ke(e){B.value||(p.value&&(e.preventDefault(),e.stopPropagation()),r.value=!r.value)}function Ce(e){(te(e)||e.key==="Backspace")&&m.value?.focus()}function we(e){if(nl(e)||I.isReadonly.value)return;const a=m.value?.selectionStart,v=u.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(e.key)&&e.preventDefault(),["Enter","ArrowDown"].includes(e.key)&&(r.value=!0),["Escape"].includes(e.key)&&(r.value=!1),j.value&&["Enter","Tab"].includes(e.key)&&P.value&&!u.value.some(t=>{let{value:g}=t;return g===P.value.value})&&h(P.value),e.key==="ArrowDown"&&j.value&&q.value?.focus("next"),e.key==="Enter"&&c.value&&(h(E(l,c.value),!0,!0),V.value&&(b.value="")),["Backspace","Delete"].includes(e.key)){if(!l.multiple&&V.value&&u.value.length>0&&!c.value)return h(u.value[0],!1);if(~i.value){e.preventDefault();const t=i.value;h(u.value[i.value],!1),i.value=t>=v-1?v-2:t}else e.key==="Backspace"&&!c.value&&(i.value=v-1);return}if(l.multiple)if(e.key==="ArrowLeft"){if(i.value<0&&a&&a>0)return;const t=i.value>-1?i.value-1:v-1;u.value[t]?i.value=t:(i.value=-1,m.value?.setSelectionRange(c.value.length,c.value.length))}else if(e.key==="ArrowRight"){if(i.value<0)return;const t=i.value+1;u.value[t]?i.value=t:(i.value=-1,m.value?.setSelectionRange(0,0))}else~i.value&&te(e)&&(i.value=-1)}function Ie(e){const a=e?.clipboardData?.getData("Text")??"",v=Z(a);v.length>1&&l.multiple&&(e.preventDefault(),G(v))}function De(){l.eager&&_.value?.calculateVisibleItems()}function Fe(){p.value&&m.value?.focus(),x.value=!0,S.value=null}function h(e){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!(!e||e.props.disabled))if(l.multiple){const t=u.value.findIndex(n=>(l.valueComparator||ue)(n.value,e.value)),g=a??!~t;if(~t){const n=g?[...u.value,e]:[...u.value];n.splice(t,1),u.value=n}else g&&(u.value=[...u.value,e]);l.clearOnSelect&&(c.value="")}else{const t=a!==!1;u.value=t?[e]:[],(!x.value||l.alwaysFilter)&&b.value&&(S.value=b.value),b.value=t&&!V.value?e.title:"",T(()=>{r.value=v,x.value=!0})}}function Z(e){const v=[`
`,...l.delimiters??[]].map(ol).join("|");return e.split(new RegExp(`(?:${v})+`))}async function G(e){for(let a of e)a=a.trim(),a&&(h(E(l,a)),await T())}function Se(e){p.value=!0,setTimeout(()=>{z.value=!0})}function Pe(e){z.value=!1}return M(p,(e,a)=>{if(!(e||e===a)&&(i.value=-1,r.value=!1,c.value)){if(l.multiple){h(E(l,c.value));return}if(!V.value)return;u.value.some(v=>{let{title:t}=v;return t===c.value})?b.value="":h(E(l,c.value))}}),M(r,e=>{if(!l.hideSelected&&e&&u.value.length&&x.value){const a=k.value.findIndex(v=>u.value.some(t=>(l.valueComparator||ue)(t.value,v.value)));sl&&window.requestAnimationFrame(()=>{a>=0&&_.value?.scrollToIndex(a)})}e&&(S.value=null)}),M(X,(e,a)=>{r.value||p.value&&!a.length&&e.length&&(r.value=!0)}),Be(()=>{const e=!!(!l.hideNoData||k.value.length||s["prepend-item"]||s["append-item"]||s["no-data"]),a=u.value.length>0,v=Q.filterProps(l);return d(Q,w({ref:m},v,{modelValue:c.value,"onUpdate:modelValue":t=>c.value=t,focused:p.value,"onUpdate:focused":t=>p.value=t,validationValue:u.externalValue,counterValue:fe.value,dirty:a,class:["v-combobox",{"v-combobox--active-menu":r.value,"v-combobox--chips":!!l.chips,"v-combobox--selection-slot":!!V.value,"v-combobox--selecting-index":i.value>-1,[`v-combobox--${l.multiple?"multiple":"single"}`]:!0},l.class],style:l.style,readonly:I.isReadonly.value,placeholder:a?void 0:l.placeholder,"onClick:clear":xe,"onMousedown:control":Ve,onKeydown:we,onPaste:Ie,"aria-expanded":he.value,"aria-controls":ge.value}),{...s,default:t=>{let{id:g}=t;return F(H,null,[d(qe,w({id:be.value,ref:W,modelValue:r.value,"onUpdate:modelValue":n=>r.value=n,activator:"parent",contentClass:"v-combobox__content",disabled:B.value,eager:l.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,onAfterEnter:De,onAfterLeave:Fe},l.menuProps),{default:()=>[e&&d(He,w({ref:q,filterable:!0,selected:ye.value,selectStrategy:l.multiple?"independent":"single-independent",onMousedown:n=>n.preventDefault(),selectable:!!k.value.length,onKeydown:Ce,onFocusin:Se,onFocusout:Pe,tabindex:"-1","aria-live":"polite","aria-labelledby":`${g.value}-label`,"aria-multiselectable":l.multiple,color:l.itemColor??l.color},pe,l.listProps),{default:()=>[s["prepend-item"]?.(),!k.value.length&&!l.hideNoData&&(s["no-data"]?.()??d(le,{key:"no-data",title:ie(l.noDataText)},null)),d(We,{ref:_,renderless:!0,items:k.value,itemKey:"value"},{default:n=>{let{item:o,index:C,itemRef:K}=n;const R=w(o.props,{ref:K,key:o.value,active:j.value&&o===P.value?!0:void 0,onClick:()=>h(o,null),"aria-posinset":C+1,"aria-setsize":k.value.length});return o.type==="divider"?s.divider?.({props:o.raw,index:C})??d(Xe,w(o.props,{key:`divider-${C}`}),null):o.type==="subheader"?s.subheader?.({props:o.raw,index:C})??d(Ye,w(o.props,{key:`subheader-${C}`}),null):s.item?.({item:o,index:C,props:R})??d(le,w(R,{role:"option"}),{prepend:A=>{let{isSelected:f}=A;return F(H,null,[l.multiple&&!l.hideSelected?d(Ze,{key:o.value,modelValue:f,ripple:!1,tabindex:"-1","aria-hidden":!0,onClick:Re=>Re.preventDefault()},null):void 0,o.props.prependAvatar&&d(Ge,{image:o.props.prependAvatar},null),o.props.prependIcon&&d(ee,{icon:o.props.prependIcon},null)])},title:()=>x.value?o.title:vl("v-combobox",o.title,me(o)?.title)})}}),s["append-item"]?.()]})]}),u.value.map((n,o)=>{function C(f){f.stopPropagation(),f.preventDefault(),h(n,!1)}const K=w(ae.filterProps(n.props),{"onClick:close":C,onKeydown(f){f.key!=="Enter"&&f.key!==" "||(f.preventDefault(),f.stopPropagation(),C(f))},onMousedown(f){f.preventDefault(),f.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0}),R=N.value?!!s.chip:!!s.selection,A=R?Je(N.value?s.chip({item:n,index:o,props:K}):s.selection({item:n,index:o})):void 0;if(!(R&&!A))return F("div",{key:n.value,class:el(["v-combobox__selection",o===i.value&&["v-combobox__selection--selected",ce.value]]),style:Qe(o===i.value?ve.value:{})},[N.value?s.chip?d(ll,{key:"chip-defaults",defaults:{VChip:{closable:Y.value,size:"small",text:n.title}}},{default:()=>[A]}):d(ae,w({key:"chip",closable:Y.value,size:"small",text:n.title,disabled:n.props.disabled},K),null):A??F("span",{class:"v-combobox__selection-text"},[n.title,l.multiple&&o<u.value.length-1&&F("span",{class:"v-combobox__selection-comma"},[al(",")])])])})])},"append-inner":function(){for(var t=arguments.length,g=new Array(t),n=0;n<t;n++)g[n]=arguments[n];return F(H,null,[s["append-inner"]?.(...g),(!l.hideNoData||l.items.length)&&l.menuIcon?d(ee,{class:"v-combobox__menu-icon",color:m.value?.fieldIconColor,icon:l.menuIcon,onMousedown:ke,onClick:je,"aria-hidden":!0,tabindex:"-1"},null):void 0,l.appendInnerIcon&&d(de,{key:"append-icon",name:"appendInner",color:g[0].iconColor.value},null)])}})}),Ke({isFocused:p,isPristine:x,menu:r,search:c,selectionIndex:i,filteredItems:$,select:h},m)}});export{bl as V};
//# sourceMappingURL=VCombobox-DcsTuhvs.js.map
