import{aJ as Ae,aK as Me,aL as Te,aM as Ee,aN as _e,aO as Q,aP as Be,aQ as D,aR as Le,Z as M,aS as Ne,aT as Ke,G as y,aU as Oe,aV as ze,aW as Ue,aX as $e,m as X,e as d,f as S,aY as ee,aZ as je,F as H,a_ as qe,a$ as w,aB as He,aj as le,b0 as We,at as Ye,b1 as Ze,b2 as Ge,b3 as Je,b4 as ae,b5 as Qe,b6 as Xe,Y as el,b7 as ll,i as al,s as O,b8 as tl,b9 as te,ba as ue,bb as T,bc as ul,bd as nl,be as E,bf as ol,bg as il,bh as sl}from"./index-CY4kEXQX.js";import{u as rl,m as cl,h as vl}from"./filter-B_C-txEo.js";const dl=Oe({alwaysFilter:Boolean,autoSelectFirst:{type:[Boolean,String]},clearOnSelect:{type:Boolean,default:!0},delimiters:Array,...cl({filterKeys:["title"]}),...$e({hideNoData:!0,returnObject:!0}),...ze(Ue({modelValue:null,role:"combobox"}),["validationValue","dirty"])},"VCombobox"),bl=Ae()({name:"VCombobox",props:dl(),emits:{"update:focused":l=>!0,"update:modelValue":l=>!0,"update:search":l=>!0,"update:menu":l=>!0},setup(l,ne){let{emit:oe,slots:s}=ne;const{t:ie}=Me(),m=O(),p=D(!1),x=D(!0),z=D(!1),W=O(),_=O(),i=D(-1);let B=!1;const{items:Y,transformIn:se,transformOut:re}=Te(l),{textColorClasses:ce,textColorStyles:ve}=Ee(()=>m.value?.color),{InputIcon:de}=_e(l),u=Q(l,"modelValue",[],e=>se(il(e)),e=>{const a=re(e);return l.multiple?a:a[0]??null}),I=Be(l),Z=ul(()=>l.closableChips&&!I.isReadonly.value&&!I.isDisabled.value),L=y(()=>!!(l.chips||s.chip)),V=y(()=>L.value||!!s.selection),b=D(!l.multiple&&!V.value?u.value[0]?.title??"":""),F=D(null),c=y({get:()=>b.value,set:async e=>{if(b.value=e??"",e===null||e===""&&!l.multiple&&!V.value?u.value=[]:!l.multiple&&!V.value&&(u.value=[E(l,e)],T(()=>_.value?.scrollToIndex(0))),e&&l.multiple&&l.delimiters?.length){const a=G(e);a.length>1&&(J(a),b.value="")}e||(i.value=-1),x.value=!e}}),fe=y(()=>typeof l.counterValue=="function"?l.counterValue(u.value):typeof l.counterValue=="number"?l.counterValue:l.multiple?u.value.length:c.value.length),{filteredItems:U,getMatches:me}=rl(l,Y,()=>F.value??(l.alwaysFilter||!x.value?c.value:"")),C=y(()=>l.hideSelected&&F.value===null?U.value.filter(e=>!u.value.some(a=>a.value===e.value)):U.value),N=y(()=>l.hideNoData&&!C.value.length||I.isReadonly.value||I.isDisabled.value),$=Q(l,"menu"),r=y({get:()=>$.value,set:e=>{$.value&&!e&&W.value?.Î¨openChildren.size||e&&N.value||($.value=e)}}),{menuId:be,ariaExpanded:he,ariaControls:ge}=Le(l,r);M(b,e=>{B?T(()=>B=!1):p.value&&!r.value&&(r.value=!0),oe("update:search",e)}),M(u,e=>{!l.multiple&&!V.value&&(b.value=e[0]?.title??"")});const ye=y(()=>u.value.map(e=>e.value)),P=y(()=>C.value.find(e=>e.type==="item"&&!e.props.disabled)),j=y(()=>(l.autoSelectFirst===!0||l.autoSelectFirst==="exact"&&c.value===P.value?.title)&&C.value.length>0&&!x.value&&!z.value),q=O(),pe=tl(q,m);function xe(e){B=!0,T(()=>B=!1),l.openOnClear&&(r.value=!0)}function Ve(){N.value||(r.value=!0)}function Ce(e){N.value||(p.value&&(e.preventDefault(),e.stopPropagation()),r.value=!r.value)}function ke(e){(te(e)||e.key==="Backspace")&&m.value?.focus()}function we(e){if(nl(e)||I.isReadonly.value)return;const a=m.value?.selectionStart,v=u.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(e.key)&&e.preventDefault(),["Enter","ArrowDown"].includes(e.key)&&(r.value=!0),["Escape"].includes(e.key)&&(r.value=!1),j.value&&["Enter","Tab"].includes(e.key)&&P.value&&!u.value.some(t=>{let{value:g}=t;return g===P.value.value})&&h(P.value),e.key==="ArrowDown"&&j.value&&q.value?.focus("next"),e.key==="Enter"&&c.value&&(h(E(l,c.value),!0,!0),V.value&&(b.value="")),["Backspace","Delete"].includes(e.key)){if(!l.multiple&&V.value&&u.value.length>0&&!c.value)return h(u.value[0],!1);if(~i.value){e.preventDefault();const t=i.value;h(u.value[i.value],!1),i.value=t>=v-1?v-2:t}else e.key==="Backspace"&&!c.value&&(i.value=v-1);return}if(l.multiple)if(e.key==="ArrowLeft"){if(i.value<0&&a&&a>0)return;const t=i.value>-1?i.value-1:v-1;u.value[t]?i.value=t:(i.value=-1,m.value?.setSelectionRange(c.value.length,c.value.length))}else if(e.key==="ArrowRight"){if(i.value<0)return;const t=i.value+1;u.value[t]?i.value=t:(i.value=-1,m.value?.setSelectionRange(0,0))}else~i.value&&te(e)&&(i.value=-1)}function Ie(e){const a=e?.clipboardData?.getData("Text")??"",v=G(a);v.length>1&&l.multiple&&(e.preventDefault(),J(v))}function De(){l.eager&&_.value?.calculateVisibleItems()}function Se(){p.value&&m.value?.focus(),x.value=!0,F.value=null}function h(e){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!(!e||e.props.disabled))if(l.multiple){const t=u.value.findIndex(n=>(l.valueComparator||ue)(n.value,e.value)),g=a??!~t;if(~t){const n=g?[...u.value,e]:[...u.value];n.splice(t,1),u.value=n}else g&&(u.value=[...u.value,e]);l.clearOnSelect&&(c.value="")}else{const t=a!==!1;u.value=t?[e]:[],(!x.value||l.alwaysFilter)&&b.value&&(F.value=b.value),b.value=t&&!V.value?e.title:"",T(()=>{r.value=v,x.value=!0})}}function G(e){const v=[`
`,...l.delimiters??[]].map(ol).join("|");return e.split(new RegExp(`(?:${v})+`))}async function J(e){for(let a of e)a=a.trim(),a&&(h(E(l,a)),await T())}function Fe(e){p.value=!0,setTimeout(()=>{z.value=!0})}function Pe(e){z.value=!1}return M(p,(e,a)=>{if(!(e||e===a)&&(i.value=-1,r.value=!1,c.value)){if(l.multiple){h(E(l,c.value));return}if(!V.value)return;u.value.some(v=>{let{title:t}=v;return t===c.value})?b.value="":h(E(l,c.value))}}),M(r,e=>{if(!l.hideSelected&&e&&u.value.length&&x.value){const a=C.value.findIndex(v=>u.value.some(t=>(l.valueComparator||ue)(t.value,v.value)));sl&&window.requestAnimationFrame(()=>{a>=0&&_.value?.scrollToIndex(a)})}e&&(F.value=null)}),M(Y,(e,a)=>{r.value||p.value&&!a.length&&e.length&&(r.value=!0)}),Ne(()=>{const e=!!(!l.hideNoData||C.value.length||s["prepend-item"]||s["append-item"]||s["no-data"]),a=u.value.length>0,v=X.filterProps(l);return d(X,w({ref:m},v,{modelValue:c.value,"onUpdate:modelValue":t=>c.value=t,focused:p.value,"onUpdate:focused":t=>p.value=t,validationValue:u.externalValue,counterValue:fe.value,dirty:a,class:["v-combobox",{"v-combobox--active-menu":r.value,"v-combobox--chips":!!l.chips,"v-combobox--selection-slot":!!V.value,"v-combobox--selecting-index":i.value>-1,[`v-combobox--${l.multiple?"multiple":"single"}`]:!0},l.class],style:l.style,readonly:I.isReadonly.value,placeholder:a?void 0:l.placeholder,"onClick:clear":xe,"onMousedown:control":Ve,onKeydown:we,onPaste:Ie,"aria-expanded":he.value,"aria-controls":ge.value}),{...s,default:t=>{let{id:g}=t;return S(H,null,[d(qe,w({id:be.value,ref:W,modelValue:r.value,"onUpdate:modelValue":n=>r.value=n,activator:"parent",contentClass:"v-combobox__content",disabled:N.value,eager:l.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,onAfterEnter:De,onAfterLeave:Se},l.menuProps),{default:()=>[e&&d(He,w({ref:q,filterable:!0,selected:ye.value,selectStrategy:l.multiple?"independent":"single-independent",onMousedown:n=>n.preventDefault(),selectable:!!C.value.length,onKeydown:ke,onFocusin:Fe,onFocusout:Pe,tabindex:"-1","aria-live":"polite","aria-labelledby":`${g.value}-label`,"aria-multiselectable":l.multiple,color:l.itemColor??l.color},pe,l.listProps),{default:()=>[s["prepend-item"]?.(),!C.value.length&&!l.hideNoData&&(s["no-data"]?.()??d(le,{key:"no-data",title:ie(l.noDataText)},null)),d(We,{ref:_,renderless:!0,items:C.value,itemKey:"value"},{default:n=>{let{item:o,index:k,itemRef:K}=n;const R=w(o.props,{ref:K,key:o.value,active:j.value&&o===P.value?!0:void 0,onClick:()=>h(o,null),"aria-posinset":k+1,"aria-setsize":C.value.length});return o.type==="divider"?s.divider?.({props:o.raw,index:k})??d(Ye,w(o.props,{key:`divider-${k}`}),null):o.type==="subheader"?s.subheader?.({props:o.raw,index:k})??d(Ze,w(o.props,{key:`subheader-${k}`}),null):s.item?.({item:o,index:k,props:R})??d(le,w(R,{role:"option"}),{prepend:A=>{let{isSelected:f}=A;return S(H,null,[l.multiple&&!l.hideSelected?d(Ge,{key:o.value,modelValue:f,ripple:!1,tabindex:"-1","aria-hidden":!0,onClick:Re=>Re.preventDefault()},null):void 0,o.props.prependAvatar&&d(Je,{image:o.props.prependAvatar},null),o.props.prependIcon&&d(ee,{icon:o.props.prependIcon},null)])},title:()=>x.value?o.title:vl("v-combobox",o.title,me(o)?.title)})}}),s["append-item"]?.()]})]}),u.value.map((n,o)=>{function k(f){f.stopPropagation(),f.preventDefault(),h(n,!1)}const K=w(ae.filterProps(n.props),{"onClick:close":k,onKeydown(f){f.key!=="Enter"&&f.key!==" "||(f.preventDefault(),f.stopPropagation(),k(f))},onMousedown(f){f.preventDefault(),f.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0}),R=L.value?!!s.chip:!!s.selection,A=R?Qe(L.value?s.chip({item:n,index:o,props:K}):s.selection({item:n,index:o})):void 0;if(!(R&&!A))return S("div",{key:n.value,class:el(["v-combobox__selection",o===i.value&&["v-combobox__selection--selected",ce.value]]),style:Xe(o===i.value?ve.value:{})},[L.value?s.chip?d(ll,{key:"chip-defaults",defaults:{VChip:{closable:Z.value,size:"small",text:n.title}}},{default:()=>[A]}):d(ae,w({key:"chip",closable:Z.value,size:"small",text:n.title,disabled:n.props.disabled},K),null):A??S("span",{class:"v-combobox__selection-text"},[n.title,l.multiple&&o<u.value.length-1&&S("span",{class:"v-combobox__selection-comma"},[al(",")])])])})])},"append-inner":function(){for(var t=arguments.length,g=new Array(t),n=0;n<t;n++)g[n]=arguments[n];return S(H,null,[s["append-inner"]?.(...g),(!l.hideNoData||l.items.length)&&l.menuIcon?d(ee,{class:"v-combobox__menu-icon",color:m.value?.fieldIconColor,icon:l.menuIcon,onMousedown:Ce,onClick:je,"aria-hidden":!0,tabindex:"-1"},null):void 0,l.appendInnerIcon&&d(de,{key:"append-icon",name:"appendInner",color:g[0].iconColor.value},null)])}})}),Ke({isFocused:p,isPristine:x,menu:r,search:c,selectionIndex:i,filteredItems:U,select:h},m)}});export{bl as V};
//# sourceMappingURL=VCombobox-iWbiFWWy.js.map
