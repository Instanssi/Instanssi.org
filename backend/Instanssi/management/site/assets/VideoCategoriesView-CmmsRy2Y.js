import{d as L,a as S,u as U,H as N,I as Y,v as j,b as h,g as b,w as i,e as n,j as e,P as g,V as q,i as K,t as z,k as J,J as M,K as Q,m as W,q as X,G as E,s as r,c4 as Z,c5 as ee,E as ae}from"./index-BSHMv_df.js";import{V as I,_ as te}from"./LayoutBase.vue_vue_type_script_setup_true_lang-C8aKWyeJ.js";import{_ as oe}from"./TableActionButtons.vue_vue_type_script_setup_true_lang-DouyropJ.js";import{d as se,V as ie,g as ne}from"./query_tools-Co6bP9h2.js";import{g as re}from"./http-BZkoYM_m.js";import{V as k}from"./VRow-BUBfmFS3.js";import{p as le}from"./parseInt-3OpbdfxQ.js";import"./VContainer--EpXOfw5.js";import"./VDataTable-CpUosGjF.js";import"./filter-C6Uu0LOB.js";const ye=L({__name:"VideoCategoriesView",props:{eventId:{}},setup(D){const v=D,{t:a}=S(),V=U(),x=N(Y),d=j(),c=X(),{getEventById:A}=ae(),l=E(()=>le(v.eventId,10)),u=r(!1),T=E(()=>[{title:A(l.value)?.name??"...",to:{name:"dashboard",params:{eventId:v.eventId}}},{title:a("VideoCategoriesView.title"),disabled:!0}]),f=[25,50,100],C=r(f[0]),y=r(0),O=r(1),_=r([]),m=r(""),p=r(null),R=[{title:a("VideoCategoriesView.headers.id"),sortable:!0,key:"id"},{title:a("VideoCategoriesView.headers.name"),sortable:!0,key:"name"},{title:a("VideoCategoriesView.headers.actions"),sortable:!1,key:"actions",align:"end"}];function P(){p.value&&w(p.value)}async function w(s){u.value=!0,p.value=s;try{const t=await ee({path:{event_pk:l.value},query:ne(s)});_.value=t.data.results,y.value=t.data.count}catch(t){d.error(a("VideoCategoriesView.loadFailure")),console.error(t)}finally{u.value=!1}}const F=se(w,250);async function G(s){const t=a("VideoCategoriesView.confirmDelete",s);await x.value.ifConfirmed(t,async()=>{try{await Z({path:{event_pk:l.value,id:s.id}}),d.success(a("VideoCategoriesView.deleteSuccess")),P()}catch(o){d.error(re(o,a("VideoCategoriesView.deleteFailure"))),console.error(o)}})}function $(s){V.push({name:"arkisto-categories-edit",params:{eventId:l.value,id:s}})}function B(){V.push({name:"arkisto-categories-new",params:{eventId:l.value}})}return(s,t)=>(h(),b(te,{key:`video-categories-${l.value}`,breadcrumbs:T.value},{default:i(()=>[n(I,null,{default:i(()=>[n(k,null,{default:i(()=>[e(c).canAdd(e(g).OTHER_VIDEO_CATEGORY)?(h(),b(q,{key:0,onClick:B},{prepend:i(()=>[n(e(J),{icon:e(M)},null,8,["icon"])]),default:i(()=>[K(" "+z(e(a)("VideoCategoriesView.newCategory")),1)]),_:1})):Q("",!0),n(W,{modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=o=>m.value=o),variant:"outlined",density:"compact",label:e(a)("General.search"),style:{"max-width":"400px"},class:"ma-0 pa-0 ml-4",clearable:""},null,8,["modelValue","label"])]),_:1})]),_:1}),n(I,null,{default:i(()=>[n(k,null,{default:i(()=>[n(ie,{"items-per-page":C.value,"onUpdate:itemsPerPage":t[1]||(t[1]=o=>C.value=o),class:"elevation-1 primary","item-value":"id",density:"compact",headers:R,items:_.value,"items-length":y.value,loading:u.value,search:m.value,page:O.value,"items-per-page-options":f,"no-data-text":e(a)("VideoCategoriesView.noCategoriesFound"),"loading-text":e(a)("VideoCategoriesView.loadingCategories"),"onUpdate:options":e(F)},{"item.actions":i(({item:o})=>[n(oe,{"can-edit":e(c).canChange(e(g).OTHER_VIDEO_CATEGORY),"can-delete":e(c).canDelete(e(g).OTHER_VIDEO_CATEGORY),onEdit:H=>$(o.id),onDelete:H=>G(o)},null,8,["can-edit","can-delete","onEdit","onDelete"])]),_:1},8,["items-per-page","items","items-length","loading","search","page","no-data-text","loading-text","onUpdate:options"])]),_:1})]),_:1})]),_:1},8,["breadcrumbs"]))}});export{ye as default};
//# sourceMappingURL=VideoCategoriesView-CmmsRy2Y.js.map
