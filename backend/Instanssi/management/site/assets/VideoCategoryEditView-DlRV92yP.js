import{d as R,a as U,u as q,v as z,c6 as L,c7 as H,o as J,c8 as K,b as f,g as V,w as r,e as o,A as O,p as Q,B as W,l as X,j as t,m as Y,C as Z,V as I,i as h,t as F,k as ee,D as ae,s as y,G as g,E as te}from"./index-BSHMv_df.js";import{c as se,a as re,u as oe,b as ie,V as ne}from"./index.esm-71TeWLhH.js";import{V as x,_ as le}from"./LayoutBase.vue_vue_type_script_setup_true_lang-C8aKWyeJ.js";import{h as A}from"./http-BZkoYM_m.js";import{p as C}from"./parseInt-3OpbdfxQ.js";import"./VContainer--EpXOfw5.js";const fe=R({__name:"VideoCategoryEditView",props:{eventId:{},id:{}},setup(B){const b={name:"name"},i=B,{t:s}=U(),S=q(),n=z(),{getEventById:M}=te(),d=y(!1),u=y(!1),_=y(""),l=g(()=>C(i.eventId,10)),c=g(()=>i.id!==void 0),P=g(()=>{const e=[{title:M(l.value)?.name??"...",to:{name:"dashboard",params:{eventId:i.eventId}}},{title:s("VideoCategoriesView.title"),to:{name:"arkisto-categories",params:{eventId:i.eventId}}}];return c.value?e.push({title:_.value||"...",disabled:!0}):e.push({title:s("Breadcrumbs.newVideoCategory"),disabled:!0}),e}),D=se({name:re().required().min(1).max(64)}),{handleSubmit:G,setValues:N,setErrors:k,meta:T}=oe({validationSchema:D,initialValues:{name:""}}),m=ie("name"),w=G(async e=>{u.value=!0;let a;c.value?a=await $(C(i.id,10),e):a=await j(e),u.value=!1,a&&v()});function E(e){return{name:e.name}}async function j(e){try{return await L({path:{event_pk:l.value},body:E(e)}),n.success(s("VideoCategoryEditView.createSuccess")),!0}catch(a){A(a,k,n,s("VideoCategoryEditView.createFailure"),b)}return!1}async function $(e,a){try{return await H({path:{event_pk:l.value,id:e},body:E(a)}),n.success(s("VideoCategoryEditView.editSuccess")),!0}catch(p){A(p,k,n,s("VideoCategoryEditView.editFailure"),b)}return!1}function v(){S.push({name:"arkisto-categories",params:{eventId:i.eventId}})}return J(async()=>{if(c.value){d.value=!0;try{const a=(await K({path:{event_pk:l.value,id:C(i.id,10)}})).data;_.value=a.name,N({name:a.name})}catch(e){n.error(s("VideoCategoryEditView.loadFailure")),console.error(e),v()}finally{d.value=!1}}}),(e,a)=>(f(),V(le,{breadcrumbs:P.value},{default:r(()=>[d.value?(f(),V(x,{key:0,class:"d-flex justify-center my-8"},{default:r(()=>[o(O,{indeterminate:"",size:"64"})]),_:1})):(f(),V(x,{key:1},{default:r(()=>[o(Q,null,{default:r(()=>[o(W,null,{default:r(()=>[o(ne,{onSubmit:X(t(w),["prevent"])},{default:r(()=>[o(Y,{modelValue:t(m).value.value,"onUpdate:modelValue":a[0]||(a[0]=p=>t(m).value.value=p),"error-messages":t(m).errorMessage.value,variant:"outlined",label:t(s)("VideoCategoryEditView.labels.name")+" *"},null,8,["modelValue","error-messages","label"])]),_:1},8,["onSubmit"])]),_:1}),o(Z,{class:"justify-end"},{default:r(()=>[o(I,{variant:"text",onClick:v},{default:r(()=>[h(F(t(s)("General.cancel")),1)]),_:1}),o(I,{variant:"elevated",color:"primary",loading:u.value,disabled:!t(T).valid,onClick:t(w)},{prepend:r(()=>[o(t(ee),{icon:t(ae)},null,8,["icon"])]),default:r(()=>[h(" "+F(t(s)("General.save")),1)]),_:1},8,["loading","disabled","onClick"])]),_:1})]),_:1})]),_:1}))]),_:1},8,["breadcrumbs"]))}});export{fe as default};
//# sourceMappingURL=VideoCategoryEditView-DlRV92yP.js.map
