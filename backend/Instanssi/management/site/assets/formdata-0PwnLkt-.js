import{b4 as O,I as v,aV as ge,aW as he,a_ as be,bS as Fe,L as ke,b2 as De,b3 as we,bT as Ie,b5 as Ce,bU as Se,br as W,bV as Ae,bW as j,bX as x,e as h,f as y,F as I,bY as Ve,bb as C,ab as Be,a5 as Pe,bn as Te,bm as Re,bZ as ze,s as S,b0 as $e,b_ as L}from"./index-CQkWvXOv.js";function Ee(){function e(n){return[...n.dataTransfer?.items??[]].filter(i=>i.kind==="file").map(i=>i.webkitGetAsEntry()).filter(Boolean).length>0||[...n.dataTransfer?.files??[]].length>0}async function a(n){const r=[],i=[...n.dataTransfer?.items??[]].filter(l=>l.kind==="file").map(l=>l.webkitGetAsEntry()).filter(Boolean);if(i.length)for(const l of i){const c=await G(l,_(".",l));r.push(...c.map(o=>o.file))}else r.push(...n.dataTransfer?.files??[]);return r}return{handleDrop:a,hasFilesOrFolders:e}}function G(e){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return new Promise((n,r)=>{e.isFile?e.file(l=>n([{file:l,path:a}]),r):e.isDirectory&&e.createReader().readEntries(async l=>{const c=[];for(const o of l)c.push(...await G(o,_(a,o)));n(c)})})}function _(e,a){return a.isDirectory?`${e}/${a.name}`:e}const Ne=O({filterByType:String},"file-accept");function je(e){const a=v(()=>e.filterByType?xe(e.filterByType):null);function n(r){if(a.value){const i=r.filter(a.value);return{accepted:i,rejected:r.filter(l=>!i.includes(l))}}return{accepted:r,rejected:[]}}return{filterAccepted:n}}function xe(e){const a=e.split(",").map(l=>l.trim().toLowerCase()),n=a.filter(l=>l.startsWith(".")),r=a.filter(l=>l.endsWith("/*")),i=a.filter(l=>!n.includes(l)&&!r.includes(l));return l=>{const c=l.name.split(".").at(-1)?.toLowerCase()??"",o=l.type.split("/").at(0)?.toLowerCase()??"";return i.includes(l.type)||n.includes(`.${c}`)||r.includes(`${o}/*`)}}const Le=O({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},hideInput:Boolean,multiple:Boolean,showSize:{type:[Boolean,Number,String],default:!1,validator:e=>typeof e=="boolean"||[1e3,1024].includes(Number(e))},truncateLength:{type:[Number,String],default:22},...Ce(Se({prependIcon:"$file"}),["direction"]),modelValue:{type:[Array,Object],default:e=>e.multiple?[]:null,validator:e=>W(e).every(a=>a!=null&&typeof a=="object")},...Ne(),...Ie({clearable:!0})},"VFileInput"),We=ge()({name:"VFileInput",inheritAttrs:!1,props:Le(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0,rejected:e=>!0},setup(e,a){let{attrs:n,emit:r,slots:i}=a;const{t:l}=he(),{filterAccepted:c}=je(e),o=be(e,"modelValue",e.modelValue,t=>W(t),t=>!e.multiple&&Array.isArray(t)?t[0]:t),{isFocused:m,focus:U,blur:J}=Fe(e),A=v(()=>typeof e.showSize!="boolean"?e.showSize:void 0),V=v(()=>(o.value??[]).reduce((t,s)=>{let{size:f=0}=s;return t+f},0)),B=v(()=>L(V.value,A.value)),b=v(()=>(o.value??[]).map(t=>{const{name:s="",size:f=0}=t,d=te(s);return e.showSize?`${d} (${L(f,A.value)})`:d})),K=v(()=>{const t=o.value?.length??0;return e.showSize?l(e.counterSizeString,t,B.value):l(e.counterString,t)}),P=S(),T=S(),u=S(),X=Te(()=>m.value||e.active),R=v(()=>["plain","underlined"].includes(e.variant)),g=$e(!1),{handleDrop:Y,hasFilesOrFolders:Z}=Ee();function F(){u.value!==document.activeElement&&u.value?.focus(),m.value||U()}function q(t){u.value?.click()}function H(t){r("mousedown:control",t)}function Q(t){u.value?.click(),r("click:control",t)}function ee(t){t.stopPropagation(),F(),Re(()=>{o.value=[],ze(e["onClick:clear"],t)})}function te(t){if(t.length<Number(e.truncateLength))return t;const s=Math.floor((Number(e.truncateLength)-1)/2);return`${t.slice(0,s)}â€¦${t.slice(t.length-s)}`}function ne(t){t.preventDefault(),t.stopImmediatePropagation(),g.value=!0}function ae(t){t.preventDefault(),g.value=!1}async function le(t){if(t.preventDefault(),t.stopImmediatePropagation(),g.value=!1,!u.value||!Z(t))return;const s=await Y(t);z(s)}function ie(t){if(!(!t.target||t.repack))if(e.filterByType)z([...t.target.files]);else{const s=t.target;o.value=[...s.files??[]]}}function z(t){const s=new DataTransfer,{accepted:f,rejected:d}=c(t);d.length&&r("rejected",d);for(const D of f)s.items.add(D);u.value.files=s.files,o.value=[...s.files];const k=new Event("change",{bubbles:!0});k.repack=!0,u.value.dispatchEvent(k)}return ke(o,t=>{(!Array.isArray(t)||!t.length)&&u.value&&(u.value.value="")}),De(()=>{const t=!!(i.counter||e.counter),s=!!(t||i.details),[f,d]=Ae(n),{modelValue:k,...D}=j.filterProps(e),re={...x.filterProps(e),"onClick:clear":ee},oe=n.webkitdirectory!==void 0&&n.webkitdirectory!==!1,se=n.accept?String(n.accept):void 0,ue=oe?void 0:e.filterByType??se;return h(j,C({ref:P,modelValue:e.multiple?o.value:o.value[0],class:["v-file-input",{"v-file-input--chips":!!e.chips,"v-file-input--dragging":g.value,"v-file-input--hide":e.hideInput,"v-input--plain-underlined":R.value},e.class],style:e.style,"onClick:prepend":q},f,D,{centerAffix:!R.value,focused:m.value}),{...i,default:w=>{let{id:ce,isDisabled:$,isDirty:E,isReadonly:N,isValid:fe,hasDetails:de}=w;return h(x,C({ref:T,prependIcon:e.prependIcon,onMousedown:H,onClick:Q,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},re,{id:ce.value,active:X.value||E.value,dirty:E.value||e.dirty,disabled:$.value,focused:m.value,details:de.value,error:fe.value===!1,onDragover:ne,onDrop:le}),{...i,default:pe=>{let{props:{class:ve,...ye},controlRef:me}=pe;return y(I,null,[y("input",C({ref:p=>u.value=me.value=p,type:"file",accept:ue,readonly:N.value,disabled:$.value,multiple:e.multiple,name:e.name,onClick:p=>{p.stopPropagation(),N.value&&p.preventDefault(),F()},onChange:ie,onDragleave:ae,onFocus:F,onBlur:J},ye,d),null),y("div",{class:Be(ve)},[!!o.value?.length&&!e.hideInput&&(i.selection?i.selection({fileNames:b.value,totalBytes:V.value,totalBytesReadable:B.value}):e.chips?b.value.map(p=>h(Pe,{key:p,size:"small",text:p},null)):b.value.join(", "))])])}})},details:s?w=>y(I,null,[i.details?.(w),t&&y(I,null,[y("span",null,null),h(Ve,{active:!!o.value?.length,value:K.value,disabled:e.disabled},i.counter)])]):void 0})}),we({},P,T,u)}});function Me(e){if(e)return Array.isArray(e)?e[0]:e}function M(e,a,n){typeof n=="string"||n instanceof Blob?e.append(a,n):n instanceof Date?e.append(a,n.toISOString()):e.append(a,JSON.stringify(n))}function Ge(e){const a=new FormData;for(const[n,r]of Object.entries(e))if(r!==void 0){if(r===null){a.append(n,"");continue}Array.isArray(r)?r.forEach(i=>M(a,n,i)):M(a,n,r)}return a}function _e(e){if(e!==void 0)return e===null?null:Me(e)}export{We as V,Me as g,_e as p,Ge as t};
//# sourceMappingURL=formdata-0PwnLkt-.js.map
