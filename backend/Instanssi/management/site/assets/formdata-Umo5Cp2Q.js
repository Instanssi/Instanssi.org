import{aU as L,G as v,aJ as ge,aK as he,aO as be,bG as Fe,Z as ke,aS as De,aT as we,bH as Ie,aV as Ce,bI as Se,bg as G,bJ as Ae,bK as O,bL as j,e as h,f as y,F as I,bM as Ve,a$ as C,Y as Be,b4 as Pe,bc as Te,bb as Re,bN as ze,s as S,aQ as $e,bO as M}from"./index-CY4kEXQX.js";function Ne(){function e(n){return[...n.dataTransfer?.items??[]].filter(i=>i.kind==="file").map(i=>i.webkitGetAsEntry()).filter(Boolean).length>0||[...n.dataTransfer?.files??[]].length>0}async function a(n){const r=[],i=[...n.dataTransfer?.items??[]].filter(l=>l.kind==="file").map(l=>l.webkitGetAsEntry()).filter(Boolean);if(i.length)for(const l of i){const c=await J(l,K(".",l));r.push(...c.map(o=>o.file))}else r.push(...n.dataTransfer?.files??[]);return r}return{handleDrop:a,hasFilesOrFolders:e}}function J(e){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return new Promise((n,r)=>{e.isFile?e.file(l=>n([{file:l,path:a}]),r):e.isDirectory&&e.createReader().readEntries(async l=>{const c=[];for(const o of l)c.push(...await J(o,K(a,o)));n(c)})})}function K(e,a){return a.isDirectory?`${e}/${a.name}`:e}const Ee=L({filterByType:String},"file-accept");function Oe(e){const a=v(()=>e.filterByType?je(e.filterByType):null);function n(r){if(a.value){const i=r.filter(a.value);return{accepted:i,rejected:r.filter(l=>!i.includes(l))}}return{accepted:r,rejected:[]}}return{filterAccepted:n}}function je(e){const a=e.split(",").map(l=>l.trim().toLowerCase()),n=a.filter(l=>l.startsWith(".")),r=a.filter(l=>l.endsWith("/*")),i=a.filter(l=>!n.includes(l)&&!r.includes(l));return l=>{const c=l.name.split(".").at(-1)?.toLowerCase()??"",o=l.type.split("/").at(0)?.toLowerCase()??"";return i.includes(l.type)||n.includes(`.${c}`)||r.includes(`${o}/*`)}}const Me=L({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},hideInput:Boolean,multiple:Boolean,showSize:{type:[Boolean,Number,String],default:!1,validator:e=>typeof e=="boolean"||[1e3,1024].includes(Number(e))},truncateLength:{type:[Number,String],default:22},...Ce(Se({prependIcon:"$file"}),["direction"]),modelValue:{type:[Array,Object],default:e=>e.multiple?[]:null,validator:e=>G(e).every(a=>a!=null&&typeof a=="object")},...Ee(),...Ie({clearable:!0})},"VFileInput"),Ge=ge()({name:"VFileInput",inheritAttrs:!1,props:Me(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0,rejected:e=>!0},setup(e,a){let{attrs:n,emit:r,slots:i}=a;const{t:l}=he(),{filterAccepted:c}=Oe(e),o=be(e,"modelValue",e.modelValue,t=>G(t),t=>!e.multiple&&Array.isArray(t)?t[0]:t),{isFocused:m,focus:U,blur:W}=Fe(e),A=v(()=>typeof e.showSize!="boolean"?e.showSize:void 0),V=v(()=>(o.value??[]).reduce((t,s)=>{let{size:f=0}=s;return t+f},0)),B=v(()=>M(V.value,A.value)),b=v(()=>(o.value??[]).map(t=>{const{name:s="",size:f=0}=t,d=te(s);return e.showSize?`${d} (${M(f,A.value)})`:d})),H=v(()=>{const t=o.value?.length??0;return e.showSize?l(e.counterSizeString,t,B.value):l(e.counterString,t)}),P=S(),T=S(),u=S(),Q=Te(()=>m.value||e.active),R=v(()=>["plain","underlined"].includes(e.variant)),g=$e(!1),{handleDrop:Y,hasFilesOrFolders:Z}=Ne();function F(){u.value!==document.activeElement&&u.value?.focus(),m.value||U()}function _(t){u.value?.click()}function q(t){r("mousedown:control",t)}function X(t){u.value?.click(),r("click:control",t)}function ee(t){t.stopPropagation(),F(),Re(()=>{o.value=[],ze(e["onClick:clear"],t)})}function te(t){if(t.length<Number(e.truncateLength))return t;const s=Math.floor((Number(e.truncateLength)-1)/2);return`${t.slice(0,s)}â€¦${t.slice(t.length-s)}`}function ne(t){t.preventDefault(),t.stopImmediatePropagation(),g.value=!0}function ae(t){t.preventDefault(),g.value=!1}async function le(t){if(t.preventDefault(),t.stopImmediatePropagation(),g.value=!1,!u.value||!Z(t))return;const s=await Y(t);z(s)}function ie(t){if(!(!t.target||t.repack))if(e.filterByType)z([...t.target.files]);else{const s=t.target;o.value=[...s.files??[]]}}function z(t){const s=new DataTransfer,{accepted:f,rejected:d}=c(t);d.length&&r("rejected",d);for(const D of f)s.items.add(D);u.value.files=s.files,o.value=[...s.files];const k=new Event("change",{bubbles:!0});k.repack=!0,u.value.dispatchEvent(k)}return ke(o,t=>{(!Array.isArray(t)||!t.length)&&u.value&&(u.value.value="")}),De(()=>{const t=!!(i.counter||e.counter),s=!!(t||i.details),[f,d]=Ae(n),{modelValue:k,...D}=O.filterProps(e),re={...j.filterProps(e),"onClick:clear":ee},oe=n.webkitdirectory!==void 0&&n.webkitdirectory!==!1,se=n.accept?String(n.accept):void 0,ue=oe?void 0:e.filterByType??se;return h(O,C({ref:P,modelValue:e.multiple?o.value:o.value[0],class:["v-file-input",{"v-file-input--chips":!!e.chips,"v-file-input--dragging":g.value,"v-file-input--hide":e.hideInput,"v-input--plain-underlined":R.value},e.class],style:e.style,"onClick:prepend":_},f,D,{centerAffix:!R.value,focused:m.value}),{...i,default:w=>{let{id:ce,isDisabled:$,isDirty:N,isReadonly:E,isValid:fe,hasDetails:de}=w;return h(j,C({ref:T,prependIcon:e.prependIcon,onMousedown:q,onClick:X,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},re,{id:ce.value,active:Q.value||N.value,dirty:N.value||e.dirty,disabled:$.value,focused:m.value,details:de.value,error:fe.value===!1,onDragover:ne,onDrop:le}),{...i,default:pe=>{let{props:{class:ve,...ye},controlRef:me}=pe;return y(I,null,[y("input",C({ref:p=>u.value=me.value=p,type:"file",accept:ue,readonly:E.value,disabled:$.value,multiple:e.multiple,name:e.name,onClick:p=>{p.stopPropagation(),E.value&&p.preventDefault(),F()},onChange:ie,onDragleave:ae,onFocus:F,onBlur:W},ye,d),null),y("div",{class:Be(ve)},[!!o.value?.length&&!e.hideInput&&(i.selection?i.selection({fileNames:b.value,totalBytes:V.value,totalBytesReadable:B.value}):e.chips?b.value.map(p=>h(Pe,{key:p,size:"small",text:p},null)):b.value.join(", "))])])}})},details:s?w=>y(I,null,[i.details?.(w),t&&y(I,null,[y("span",null,null),h(Ve,{active:!!o.value?.length,value:H.value,disabled:e.disabled},i.counter)])]):void 0})}),we({},P,T,u)}});function xe(e){if(e)return Array.isArray(e)?e[0]:e}function x(e,a,n){typeof n=="string"||n instanceof Blob?e.append(a,n):n instanceof Date?e.append(a,n.toISOString()):e.append(a,JSON.stringify(n))}function Je(e){const a=new FormData;for(const[n,r]of Object.entries(e))if(r!==void 0){if(r===null){a.append(n,"");continue}Array.isArray(r)?r.forEach(i=>x(a,n,i)):x(a,n,r)}return a}function Ke(e){if(e!==void 0)return e===null?null:xe(e)}export{Ge as V,xe as g,Ke as p,Je as t};
//# sourceMappingURL=formdata-Umo5Cp2Q.js.map
